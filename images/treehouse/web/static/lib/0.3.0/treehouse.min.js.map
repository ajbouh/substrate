{
  "version": 3,
  "sources": ["../../../lib/action/keybinds.ts", "../../../lib/action/commands.ts", "../../../lib/action/menus.ts", "../../../lib/workbench/workbench.ts", "../../../lib/workbench/util.js", "../../../lib/workbench/path.ts", "../../../lib/model/components.ts", "../../../lib/model/hooks.ts", "../../../lib/model/module/bus.ts", "../../../lib/model/module/node.ts", "../../../lib/workbench/workspace.ts", "../../../lib/ui/menu.tsx", "../../../lib/ui/palette.tsx", "../../../lib/ui/node/editor.tsx", "../../../lib/view/empty.tsx", "../../../lib/ui/node/new.tsx", "../../../lib/view/list.tsx", "../../../lib/view/table.tsx", "../../../lib/view/views.ts", "../../../lib/ui/outline.tsx", "../../../lib/com/page.tsx", "../../../lib/ui/panel.tsx", "../../../lib/ui/quickadd.tsx", "../../../lib/ui/search.tsx", "../../../lib/ui/notices.tsx", "../../../lib/ui/app.tsx", "../../../lib/com/search.tsx", "../../../lib/com/checkbox.tsx", "../../../lib/com/textfield.tsx", "../../../lib/com/clock.tsx", "../../../lib/backend/browser.ts", "../../../lib/backend/github.ts", "../../../lib/mod.ts"],
  "sourcesContent": ["\nconst isMac = (navigator.userAgent.toLowerCase().indexOf(\"mac\") !== -1);\n\nexport function bindingSymbols(key?: string): string[] {\n  if (!key) return [];\n  const symbols = {\n    \"backspace\": \"\u232B\",\n    \"shift\": \"\u21E7\",\n    \"meta\": \"\u2318\",\n    \"tab\": \"\u21B9\",\n    \"ctrl\": \"\u2303\",\n    \"arrowup\": \"\u2191\",\n    \"arrowdown\": \"\u2193\",\n    \"arrowleft\": \"\u2190\",\n    \"arrowright\": \"\u2192\",\n    \"enter\": \"\u23CE\"\n  };\n  const keys = key.toLowerCase().split(\"+\");\n  return keys.map(filterKeyForNonMacMeta).map(k => (Object.keys(symbols).includes(k)) ? symbols[k] : k);\n}\n\n// if key is meta and not on a mac, change it to ctrl,\n// otherwise return the key as is\nfunction filterKeyForNonMacMeta(key: string): string {\n  return (!isMac && key === \"meta\") ? \"ctrl\": key;\n}\n\nexport interface Binding {\n  command: string;\n  key: string;\n  //when\n  //args\n}\n\nexport class KeyBindings {\n  bindings: Binding[];\n\n  constructor() {\n    this.bindings = [];\n  }\n\n  registerBinding(binding: Binding) {\n    this.bindings.push(binding);\n  }\n\n  getBinding(commandId: string): Binding|null {\n    for (const b of this.bindings) {\n      if (b.command === commandId) {\n        return b;\n      }\n    }\n    return null;\n  }\n\n  evaluateEvent(event: KeyboardEvent): Binding|null {\n    bindings: for (const b of this.bindings) {\n      let modifiers = b.key.toLowerCase().split(\"+\");\n      let key = modifiers.pop();\n      if (key !== event.key.toLowerCase()) {\n        continue;\n      }\n      for (const checkMod of [\"shift\", \"ctrl\", \"alt\", \"meta\"]) {\n        let hasMod = modifiers.includes(checkMod);\n        if (!isMac) {\n          if (checkMod === \"meta\") continue;\n          if (checkMod === \"ctrl\") {\n            hasMod = modifiers.includes(\"meta\") || modifiers.includes(\"ctrl\");\n          }\n        }\n        // @ts-ignore\n        const modState = event[`${filterKeyForNonMacMeta(checkMod)}Key`];\n        if (!modState && hasMod) {\n          continue bindings;\n        }\n        if (modState && !hasMod) {\n          continue bindings;\n        }\n      }\n      return b;\n    }\n    return null;\n  }\n}", "\nexport interface Command {\n  id: string;\n  title?: string;\n  category?: string;\n  icon?: string;\n  action: Function;\n}\n\nexport class CommandRegistry {\n  commands: {[index: string]: Command}\n\n  constructor() {\n    this.commands = {};\n  }\n\n  registerCommand(cmd: Command) {\n    this.commands[cmd.id] = cmd;\n  }\n\n  executeCommand<T>(id: string, ...rest: any): Promise<T> {\n    return new Promise((resolve) => {\n      const ret = this.commands[id].action(...rest);\n      resolve(ret);\n    });\n  }\n}", "\nexport interface MenuItem {\n  command: string;\n  //alt?: string;\n  when?: Function;\n  title?: Function;\n  onclick?: Function;\n  disabled?: boolean;\n  //group\n  //submenu\n}\n\nexport class MenuRegistry {\n  menus: {[index: string]: MenuItem[]};\n\n  constructor() {\n    this.menus = {};\n  }\n\n  registerMenu(id: string, items: MenuItem[]) {\n    this.menus[id] = items;\n  }\n}", "import { Backend } from \"../backend/mod.ts\";\nimport { KeyBindings } from \"../action/keybinds.ts\";\nimport { CommandRegistry } from \"../action/commands.ts\";\nimport { MenuRegistry } from \"../action/menus.ts\";\nimport { Node } from \"../model/mod.ts\";\nimport { objectHas, objectCall } from \"../model/hooks.ts\";\n\nimport { Workspace, Context, Path } from \"./mod.ts\";\n\n/**\n * Workbench is the top-level controller for the Treehouse frontend.\n * \n * It manages the user action registries, open panels, open workspace,\n * user context, and provides an API used by UI components to \n * trigger various pop-overs, work with quick add, or anything else\n * not provided by the backend or workspace.\n */\nexport class Workbench {\n  commands: CommandRegistry;\n  keybindings: KeyBindings;\n  menus: MenuRegistry;\n\n  backend: Backend;\n  workspace: Workspace;\n  \n  context: Context;\n  panels: Path[];\n\n  menu: any;\n  notice: any;\n  palette: any;\n  quickadd: any;\n  curtain: any;\n\n  constructor(backend: Backend) {\n    this.commands = new CommandRegistry();\n    this.keybindings = new KeyBindings();\n    this.menus = new MenuRegistry();\n\n    this.backend = backend;\n    this.workspace = new Workspace(backend.files);\n\n    this.context = {node: null};\n    this.panels = [];\n    \n  }\n\n  get mainPanel(): Path {\n    return this.panels[0];\n  }\n\n  async initialize() {\n    await this.workspace.load();\n\n    this.workspace.rawNodes.forEach(n => this.backend.index.index(n));\n    this.workspace.observe((n => {\n      this.workspace.save();\n      if (n.isDestroyed) {\n        this.backend.index.remove(n.id);\n      } else {\n        this.backend.index.index(n.raw);\n        n.components.forEach(com => this.backend.index.index(com.raw));\n      }\n    }));\n\n    \n    if (this.workspace.lastOpenedID) {\n      this.openNewPanel(this.workspace.find(this.workspace.lastOpenedID) || this.workspace.mainNode());\n    } else {\n      this.openNewPanel(this.workspace.mainNode());\n    }\n\n    if (this.backend.loadExtensions) {\n      await this.backend.loadExtensions();\n    }\n    \n    m.redraw();\n\n    // todo: move this out to the demo\n    if (!localStorage.getItem(\"firsttime\")) {\n      this.showNotice('firsttime');\n    }\n    \n  }\n\n  authenticated(): boolean {\n    return this.backend.auth && this.backend.auth.currentUser();\n  }\n\n  closeQuickAdd() {\n    this.quickadd = null;\n    m.redraw();\n  }\n\n  openQuickAdd() {\n    let node = this.workspace.find(\"@quickadd\");\n    if (!node) {\n      node = this.workspace.new(\"@quickadd\");\n    }\n    this.quickadd = node;\n  }\n\n  commitQuickAdd() {\n    const node = this.workspace.find(\"@quickadd\");\n    if (!node) return;\n    const today = this.todayNode();\n    node.children.forEach(n => n.parent = today);\n  }\n\n  clearQuickAdd() {\n    const node = this.workspace.find(\"@quickadd\");\n    if (!node) return;\n    node.children.forEach(n => n.destroy());\n  }\n\n  // TODO: goto workspace\n  todayNode(): Node {\n    const today = new Date();\n    const dayNode = today.toUTCString().split(today.getFullYear())[0];\n    const weekNode = `Week ${String(getWeekOfYear(today)).padStart(2, \"0\")}`;\n    const yearNode = `${today.getFullYear()}`;\n    const todayPath = [\"@workspace\", \"Calendar\", yearNode, weekNode, dayNode].join(\"/\");\n    let todayNode = this.workspace.find(todayPath);\n    if (!todayNode) {\n      todayNode = this.workspace.new(todayPath);\n    }\n    return todayNode;\n  }\n\n  openToday() {\n    this.open(this.todayNode());\n  }\n\n  open(n: Node) {\n    // TODO: not sure this is still necessary\n    if (!this.workspace.expanded[n.id]) {\n      this.workspace.expanded[n.id] = {};\n    }\n\n    this.workspace.lastOpenedID = n.id;\n    this.workspace.save();\n    const p = new Path(n);\n    this.panels[0] = p\n    this.context.path = p;\n  }\n\n  openNewPanel(n: Node) {\n    // TODO: not sure this is still necessary\n    if (!this.workspace.expanded[n.id]) {\n      this.workspace.expanded[n.id] = {};\n    }\n\n    this.workspace.lastOpenedID = n.id;\n    this.workspace.save();\n    const p = new Path(n);\n    this.panels.push(p);\n    this.context.path = p;\n  }\n\n  closePanel(panel: Path) {\n    this.panels = this.panels.filter(p => p.name !== panel.name);\n  }\n\n  defocus() {\n    this.context.node = null;\n  }\n\n  focus(path: Path, pos?: number = 0) {\n    const input = this.getInput(path);\n    if (input) {\n      this.context.path = path;\n      input.focus();\n      if (pos !== undefined) {\n        input.setSelectionRange(pos,pos);\n      }\n    } else {\n      console.warn(\"unable to find input for\", path);\n    }\n  }\n\n  getInput(path: Path): HTMLElement {\n    let id = `input-${path.id}-${path.node.id}`;\n    // kludge:\n    if (path.node.raw.Rel === \"Fields\") {\n      id = id+\"-value\"; \n    }\n    return document.getElementById(id);\n  }\n\n  executeCommand<T>(id: string, ctx: any, ...rest: any): Promise<T> {\n    ctx = this.newContext(ctx);\n    console.log(id, ctx, ...rest);\n    return this.commands.executeCommand(id, this.newContext(ctx), ...rest);\n  }\n\n  newContext(ctx: any): Context {\n    return Object.assign({}, this.context, ctx);\n  }\n\n  showMenu(event: Event, ctx: any) {\n    event.stopPropagation();\n    event.preventDefault();\n    const trigger = event.target.closest(\"*[data-menu]\");\n    const rect = trigger.getBoundingClientRect();\n    const align = trigger.dataset[\"align\"] || \"left\";\n    let x = document.body.scrollLeft+rect.x;\n    if (align === \"right\") {\n      x = document.body.offsetWidth - rect.right;\n    }\n    const y = document.body.scrollTop+rect.y+rect.height;\n    const items = this.menus.menus[trigger.dataset[\"menu\"]];\n    const cmds = items.filter(i => i.command).map(i => this.commands.commands[i.command]);\n    if (!items) return;\n    this.menu = {x, y, \n      ctx: this.newContext(ctx), \n      items: items,\n      commands: cmds,\n      align: align\n    };\n    this.curtain = {\n      visible: false,\n      onclick: () => this.hideMenu()\n    }\n    m.redraw();\n  }\n\n  hideMenu() {\n    this.menu = null;\n    this.curtain = null;\n    m.redraw();\n  }\n\n  showPalette(x: number, y: number, ctx: Context) {\n    this.palette = {x, y, ctx: ctx};\n    this.curtain = {\n      visible: false,\n      onclick: () => this.hidePalette()\n    }\n    m.redraw();\n  }\n\n  hidePalette() {\n    this.palette = null;\n    this.curtain = null;\n    m.redraw();\n  }\n\n  showNotice(message, finished) {\n    this.notice = {message, finished};\n    m.redraw();\n  }\n\n  hideNotice() {\n    this.notice = null;\n    m.redraw();\n  }\n\n\n}\n\n\nfunction getWeekOfYear(date) {\n  var d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n  var dayNum = d.getUTCDay() || 7;\n  d.setUTCDate(d.getUTCDate() + 4 - dayNum);\n  var yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));\n  return Math.ceil((((d - yearStart) / 86400000) + 1)/7);\n}", "\n/**\n* Secure Hash Algorithm (SHA1)\n* http://www.webtoolkit.info/\n**/\nexport function SHA1(msg) {\n  function rotate_left(n,s) {\n  var t4 = ( n<<s ) | (n>>>(32-s));\n  return t4;\n  };\n  function lsb_hex(val) {\n  var str='';\n  var i;\n  var vh;\n  var vl;\n  for( i=0; i<=6; i+=2 ) {\n  vh = (val>>>(i*4+4))&0x0f;\n  vl = (val>>>(i*4))&0x0f;\n  str += vh.toString(16) + vl.toString(16);\n  }\n  return str;\n  };\n  function cvt_hex(val) {\n  var str='';\n  var i;\n  var v;\n  for( i=7; i>=0; i-- ) {\n  v = (val>>>(i*4))&0x0f;\n  str += v.toString(16);\n  }\n  return str;\n  };\n  function Utf8Encode(string) {\n  string = string.replace(/\\r\\n/g,'\\n');\n  var utftext = '';\n  for (var n = 0; n < string.length; n++) {\n  var c = string.charCodeAt(n);\n  if (c < 128) {\n  utftext += String.fromCharCode(c);\n  }\n  else if((c > 127) && (c < 2048)) {\n  utftext += String.fromCharCode((c >> 6) | 192);\n  utftext += String.fromCharCode((c & 63) | 128);\n  }\n  else {\n  utftext += String.fromCharCode((c >> 12) | 224);\n  utftext += String.fromCharCode(((c >> 6) & 63) | 128);\n  utftext += String.fromCharCode((c & 63) | 128);\n  }\n  }\n  return utftext;\n  };\n  var blockstart;\n  var i, j;\n  var W = new Array(80);\n  var H0 = 0x67452301;\n  var H1 = 0xEFCDAB89;\n  var H2 = 0x98BADCFE;\n  var H3 = 0x10325476;\n  var H4 = 0xC3D2E1F0;\n  var A, B, C, D, E;\n  var temp;\n  msg = Utf8Encode(msg);\n  var msg_len = msg.length;\n  var word_array = new Array();\n  for( i=0; i<msg_len-3; i+=4 ) {\n  j = msg.charCodeAt(i)<<24 | msg.charCodeAt(i+1)<<16 |\n  msg.charCodeAt(i+2)<<8 | msg.charCodeAt(i+3);\n  word_array.push( j );\n  }\n  switch( msg_len % 4 ) {\n  case 0:\n  i = 0x080000000;\n  break;\n  case 1:\n  i = msg.charCodeAt(msg_len-1)<<24 | 0x0800000;\n  break;\n  case 2:\n  i = msg.charCodeAt(msg_len-2)<<24 | msg.charCodeAt(msg_len-1)<<16 | 0x08000;\n  break;\n  case 3:\n  i = msg.charCodeAt(msg_len-3)<<24 | msg.charCodeAt(msg_len-2)<<16 | msg.charCodeAt(msg_len-1)<<8 | 0x80;\n  break;\n  }\n  word_array.push( i );\n  while( (word_array.length % 16) != 14 ) word_array.push( 0 );\n  word_array.push( msg_len>>>29 );\n  word_array.push( (msg_len<<3)&0x0ffffffff );\n  for ( blockstart=0; blockstart<word_array.length; blockstart+=16 ) {\n  for( i=0; i<16; i++ ) W[i] = word_array[blockstart+i];\n  for( i=16; i<=79; i++ ) W[i] = rotate_left(W[i-3] ^ W[i-8] ^ W[i-14] ^ W[i-16], 1);\n  A = H0;\n  B = H1;\n  C = H2;\n  D = H3;\n  E = H4;\n  for( i= 0; i<=19; i++ ) {\n  temp = (rotate_left(A,5) + ((B&C) | (~B&D)) + E + W[i] + 0x5A827999) & 0x0ffffffff;\n  E = D;\n  D = C;\n  C = rotate_left(B,30);\n  B = A;\n  A = temp;\n  }\n  for( i=20; i<=39; i++ ) {\n  temp = (rotate_left(A,5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & 0x0ffffffff;\n  E = D;\n  D = C;\n  C = rotate_left(B,30);\n  B = A;\n  A = temp;\n  }\n  for( i=40; i<=59; i++ ) {\n  temp = (rotate_left(A,5) + ((B&C) | (B&D) | (C&D)) + E + W[i] + 0x8F1BBCDC) & 0x0ffffffff;\n  E = D;\n  D = C;\n  C = rotate_left(B,30);\n  B = A;\n  A = temp;\n  }\n  for( i=60; i<=79; i++ ) {\n  temp = (rotate_left(A,5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & 0x0ffffffff;\n  E = D;\n  D = C;\n  C = rotate_left(B,30);\n  B = A;\n  A = temp;\n  }\n  H0 = (H0 + A) & 0x0ffffffff;\n  H1 = (H1 + B) & 0x0ffffffff;\n  H2 = (H2 + C) & 0x0ffffffff;\n  H3 = (H3 + D) & 0x0ffffffff;\n  H4 = (H4 + E) & 0x0ffffffff;\n  }\n  var temp = cvt_hex(H0) + cvt_hex(H1) + cvt_hex(H2) + cvt_hex(H3) + cvt_hex(H4);\n \n  return temp.toLowerCase();\n }", "import { Node } from \"../model/mod.ts\";\nimport { SHA1 } from \"./util.js\";\n\n/**\n * Path is a stack of nodes. It can be used as a history stack\n * so you can \"zoom\" into subnodes and return back to previous nodes.\n * It is also used to identify nodes in the UI more specifically than\n * the node ID since a node can be shown more than once (references, panels, etc).\n */\nexport class Path {\n  name: string;\n  nodes: Node[];\n\n  constructor(head?: Node, name?: string) {\n    if (name) {\n      this.name = name;\n    } else {\n      this.name = Math.random().toString(36).substring(2);\n    }\n    if (head) {\n      this.nodes = [head];\n    } else {\n      this.nodes = [];\n    }\n  }\n\n  push(node: Node) {\n    this.nodes.push(node);\n  }\n\n  pop(): Node|null {\n    return this.nodes.pop() || null;\n  }\n\n  sub(): Path {\n    return new Path(this.node, this.name);\n  }\n\n  clone(): Path {\n    const p = new Path();\n    p.name = this.name;\n    p.nodes = [...this.nodes];\n    return p;\n  }\n\n  append(node: Node): Path {\n    const p = this.clone();\n    p.push(node);\n    return p;\n  }\n\n  get length(): number {\n    return this.nodes.length;\n  }\n\n  get id(): string {\n    return SHA1([this.name, ...this.nodes.map(n => n.id)].join(\":\"));\n  }\n\n  get node(): Node {\n    return this.nodes[this.nodes.length-1];\n  }\n\n  get previous(): Node|null {\n    if (this.nodes.length < 2) return null;\n    return this.nodes[this.nodes.length-2];\n  }\n\n  get head(): Node {\n    return this.nodes[0];\n  }\n}\n\n", "/**\n * Components are classes that can be used for component values in component nodes.\n * These classes need to be registered so they can be properly \"hydrated\" from \n * marshaled form (usually JSON) back into class instances.\n * \n * @module\n */\n\nconst registry: Record<string, any> = {};\n\nexport function component(target: any) {\n  registry[componentName(target)] = target;\n}\n\nexport function componentName(target: any): string {\n  if (target.prototype === undefined) {\n    target = target.constructor;\n  }\n  return `treehouse.${target.name}`;\n}\n\nexport function getComponent(com: any): any {\n  if (typeof com === \"string\") {\n    return registry[com];\n  }\n  return registry[componentName(com)];\n}\n\nexport function inflateToComponent(com: any, obj: any): any {\n  const o = new (getComponent(com));\n  if (o[\"fromJSON\"] instanceof Function) {\n    o.fromJSON(obj);\n  } else {\n    Object.defineProperties(o, Object.getOwnPropertyDescriptors(obj));\n  }\n  return o;\n}", "/**\n * Hooks are single method interfaces implemented by component values. There are\n * some system hook interfaces defined here as well as utilities for working with\n * system and app hooks.\n * \n * @module\n */\nimport { Node } from \"./mod.ts\";\n\n// triggered on parent set or import (if has parent), or addcomponent\nexport interface AttachListener {\n  onAttach(node: Node): void;\n}\n\n// called on accessing children\nexport interface ChildProvider {\n  objectChildren(node: Node, children: Node[]): Node[];\n}\n\nexport function hasHook(node: Node, hook: string): boolean {\n  return node.value && node.value[hook] instanceof Function;\n}\n\nexport function triggerHook(node: Node, hook: string, ...args: any[]): any {\n  if (hasHook(node, hook)) {\n    return node.value[hook].apply(node.value, args);\n  }\n}\n\nexport function objectHas(obj: Node, hook: string): boolean {\n  for (const com of obj.components) {\n    if (hasHook(com, hook)) return true;\n  }\n  return false;\n}\n\nexport function objectCall(obj: Node, hook: string, ...args: any[]): any {\n  for (const com of obj.components) {\n    if (hasHook(com, hook)) {\n      return com.value[hook].apply(com.value, args);\n    }\n  }\n}", "import { RawNode, Node as INode, Bus as IBus, WalkFunc, ObserverFunc, WalkOptions } from \"../mod.ts\";\nimport { componentName, getComponent, inflateToComponent } from \"../components.ts\";\nimport { triggerHook, hasHook } from \"../hooks.ts\";\nimport { Node } from \"./mod.ts\";\n\nexport class Bus {\n  nodes: Record<string, RawNode>;\n  observers: ObserverFunc[];\n\n  constructor() {\n    this.nodes = {\"@root\": {\n      ID: \"@root\",\n      Name: \"@root\",\n      Linked: {Children: [], Components: []},\n      Attrs: {}\n    }};\n    this.observers = [];\n  }\n\n  changed(n: INode) {\n    this.observers.forEach(cb => cb(n));\n  }\n\n  /* Bus interface */\n\n  import(nodes: RawNode[]) {\n    for (const n of nodes) {\n      if (n.Value && getComponent(n.Name)) {\n        n.Value = inflateToComponent(n.Name, n.Value);\n        n.Rel = \"Components\"; // kludge\n      }\n      this.nodes[n.ID] = n;\n    }\n    for (const n of nodes) {\n      // clear stored tmp nodes\n      if (n.Parent === \"@tmp\") {\n        delete this.nodes[n.ID];\n        continue;\n      }\n      // clear nodes with no parent that aren't system\n      if (!n.ID.startsWith(\"@\") && n.Parent === undefined) {\n        delete this.nodes[n.ID];\n        continue;\n      }\n      // clear nodes with non-existant parent\n      if (n.Parent && !this.nodes[n.Parent]) {\n        delete this.nodes[n.ID];\n        continue;\n      }\n      const node = this.find(n.ID);\n      if (node) {\n        // check orphan\n        if (node.parent && !node.parent.raw) {\n          delete this.nodes[n.ID];\n          continue;\n        }\n        // trigger attach\n        triggerHook(node, \"onAttach\", node);\n      }\n    }\n  }\n\n  export(): RawNode[] {\n    const nodes: RawNode[] = [];\n    for (const n of Object.values(this.nodes)) {\n      nodes.push(n);\n    }\n    return nodes;\n  }\n\n  make(name: string, value?: any): INode {\n    let parent: INode|null = null;\n    if (name.includes(\"/\")) {\n      const parts = name.split(\"/\");\n      parent = this.find(parts[0]);\n      for (let i = 1; i < parts.length-1; i++) {\n        if (parent === null) {\n          throw \"unable to get root\";\n        }\n        \n        let child = parent.find(parts[i]);\n        if (!child) {\n          child = this.make(parts.slice(0, i+1).join(\"/\"));\n        }\n        parent = child;\n      }\n      name = parts[parts.length-1];\n    }\n    const id = (name.startsWith(\"@\"))?name:uniqueId();\n    this.nodes[id] = {\n      ID: id,\n      Name: name,\n      Value: value,\n      Linked: {Children: [], Components: []},\n      Attrs: {}\n    };\n    const node = new Node(this, id);\n    if (parent) {\n      node.parent = parent;\n    }\n    return node;\n  }\n\n  // destroys node but not linked nodes\n  destroy(n: INode) {\n    const p = n.parent;\n    if (p !== null && !p.isDestroyed) {\n      let rel = n.raw.Rel || \"Children\";\n      if (p.raw.Linked[rel].includes(n.id)) {\n        p.raw.Linked[rel].splice(n.siblingIndex, 1);\n      }\n    }\n    delete this.nodes[n.id];\n    if (p) {\n      this.changed(p);\n    }\n  }\n\n  roots(): INode[] {\n    return Object.values(this.nodes).filter(n => n.Parent === undefined).map(n => new Node(this, n.ID));\n  }\n\n  root(name?: string): INode|null {\n    name = name || \"@root\"\n    const node = this.roots().find(root => root.name === name);\n    if (node === undefined) return null;\n    return node;\n  }\n\n  find(path:string): INode|null {\n    const byId = this.nodes[path];\n    if (byId) return new Node(this, byId.ID);\n    const parts = path.split(\"/\");\n    if (parts.length === 1 && parts[0].startsWith(\"@\")) {\n      // did not find @id by ID so return null\n      return null;\n    }\n    let cur = this.root(parts[0]);\n    if (!cur && this.nodes[parts[0]]) {\n      cur = new Node(this, this.nodes[parts[0]].ID);\n    }\n    if (cur) {\n      parts.shift();\n    } else {\n      cur = this.root(\"@root\"); \n    }\n    if (!cur) {\n      return null;\n    }\n    const findChild = (n: INode, name: string): INode|undefined => {\n      if (n.refTo) {\n        n = n.refTo;\n      }\n      return n.children.find(child => child.name === name);\n    }\n    for (const name of parts) {\n      const child = findChild(cur, name);\n      if (!child) return null;\n      cur = child;\n    }\n    return cur;\n  }\n\n  walk(fn: WalkFunc, opts?: WalkOptions) {\n    for (const root of this.roots()) {\n      if (root.walk(fn, opts)) return;\n    }\n  }\n\n  observe(fn: ObserverFunc) {\n    this.observers.push(fn);\n  }\n}\n\nconst uniqueId = () => {\n  const dateString = Date.now().toString(36);\n  const randomness = Math.random().toString(36).substring(2);\n  return dateString + randomness;\n};\n", "import { RawNode, Node as INode, Bus as IBus, WalkFunc, WalkOptions } from \"../mod.ts\";\nimport { componentName } from \"../components.ts\";\nimport { triggerHook, hasHook } from \"../hooks.ts\";\nimport { Bus } from \"./mod.ts\";\n\nexport class Node {\n  _id: string;\n  _bus: Bus;\n\n  constructor(bus: Bus, id: string) {\n    this._bus = bus;\n    this._id = id;\n  }\n\n  [Symbol.for(\"Deno.customInspect\")]() {\n    return `Node[${this.id}:${this.name}]`;\n  }\n\n  /* Node interface */\n\n  get id(): string {\n    return this._id;\n  }\n\n  get bus(): IBus {\n    return this._bus;\n  }\n\n  get raw(): RawNode {\n    const raw = this._bus.nodes[this.id];\n    if (!raw) throw `use of non-existent node ${this.id}`;\n    return raw;\n  }\n\n\n  get name(): string {\n    if (this.refTo) {\n      return this.refTo.name;\n    }\n    return this.raw.Name;\n  }\n\n  set name(val: string) {\n    if (this.refTo) {\n      this.refTo.name = val;\n    } else {\n      this.raw.Name = val;\n    }\n    this.changed();\n  }\n\n  get value(): any {\n    if (this.refTo) {\n      return this.refTo.value;\n    }\n    return this.raw.Value;\n  }\n\n  set value(val: string) {\n    if (this.refTo) {\n      this.refTo.value = val;\n    } else {\n      this.raw.Value = val;\n    }\n    this.changed();\n  }\n\n  get parent(): INode|null {\n    if (!this.raw.Parent) return null;\n    if (!this._bus.nodes[this.raw.Parent]) return null;\n    return new Node(this._bus, this.raw.Parent);\n  }\n\n  set parent(n: INode|null) {\n    const p = this.parent;\n    if (p !== null) {\n      p.raw.Linked.Children.splice(this.siblingIndex, 1);\n    }\n    if (n !== null) {\n      this.raw.Parent = n.id;\n      n.raw.Linked.Children.push(this.id);\n      triggerHook(n, \"onAttach\", n);\n    } else {\n      this.raw.Parent = undefined;\n    }\n    this.changed();\n  }\n\n  get refTo(): INode|null {\n    const id = this.raw.Attrs[\"refTo\"];\n    if (!id) return null;\n    const refTo = this._bus.nodes[id];\n    if (!refTo) return null;\n    return new Node(this._bus, id);\n  }\n\n  set refTo(n: INode|null) {\n    if (!n) {\n      delete this.raw.Attrs[\"refTo\"];\n      this.changed();\n      return;\n    }\n    this.raw.Attrs[\"refTo\"] = n.id;\n    this.changed();\n  }\n\n  get siblingIndex(): number {\n    const p = this.parent;\n    if (p === null) return 0;\n    let rel = this.raw.Rel || \"Children\";\n    return p.raw.Linked[rel].findIndex(id => id === this.id);\n  }\n\n  set siblingIndex(i: number) {\n    const p = this.parent;\n    if (p === null) return;\n    let rel = this.raw.Rel || \"Children\";\n    p.raw.Linked[rel].splice(this.siblingIndex, 1);\n    p.raw.Linked[rel].splice(i, 0, this.id);\n    p.changed();\n  }\n\n  get prevSibling(): INode|null {\n    const p = this.parent;\n    if (p === null) return null;\n    if (this.siblingIndex === 0) return null;\n    let rel = this.raw.Rel || \"Children\";\n    return p.getLinked(rel)[this.siblingIndex-1];\n  }\n\n  get nextSibling(): INode|null {\n    const p = this.parent;\n    if (p === null) return null;\n    if (this.siblingIndex === p.children.length-1) return null;\n    let rel = this.raw.Rel || \"Children\";\n    return p.getLinked(rel)[this.siblingIndex+1];\n  }\n\n  get ancestors(): INode[] {\n    const anc = [];\n    let p = this.parent;\n    while (p !== null) {\n      anc.push(p);\n      p = p.parent;\n    }\n    return anc;\n  }\n\n  get isDestroyed(): boolean {\n    return !this._bus.nodes.hasOwnProperty(this.id);\n  }\n\n  get path(): string {\n    let cur: INode|null = this;\n    const path = [];\n    while (cur) {\n      path.unshift(cur.name);\n      cur = cur.parent;\n    }\n    return path.join(\"/\");\n  }\n\n  get children(): INode[] {\n    if (this.refTo) return this.refTo.children;\n    let children: INode[] = [];\n    if (this.raw.Linked.Children) {\n      children = this.raw.Linked.Children.map(id => new Node(this._bus, id));\n    };\n    for (const com of this.components) {\n      if (hasHook(com, \"objectChildren\")) {\n        return triggerHook(com, \"objectChildren\", this, children);\n      }\n    }\n    return children;\n  }\n\n  get childCount(): number {\n    if (this.refTo) return this.refTo.childCount;\n    for (const com of this.components) {\n      if (hasHook(com, \"objectChildren\")) {\n        return triggerHook(com, \"objectChildren\", this, null).length;\n      }\n    }\n    if (!this.raw.Linked.Children) return 0;\n    return this.raw.Linked.Children.length;\n  }\n\n  addChild(node: INode) {\n    if (this.refTo) {\n      this.refTo.addChild(node);\n      return;\n    }\n    this.raw.Linked.Children.push(node.id);\n    this.changed();\n  } \n\n  removeChild(node: INode) {\n    if (this.refTo) {\n      this.refTo.removeChild(node);\n      return;\n    }\n    const children = this.raw.Linked.Children.filter(id => id === node.id);\n    this.raw.Linked.Children = children;\n    this.changed();\n  }\n\n\n  get components(): INode[] {\n    if (!this.raw.Linked.Components) return [];\n    return this.raw.Linked.Components.map(id => new Node(this._bus, id));\n  }\n\n  get componentCount(): number {\n    if (!this.raw.Linked.Components) return 0;\n    return this.raw.Linked.Components.length;\n  }\n\n  addComponent(obj: any) {\n    const node = this.bus.make(componentName(obj), obj);\n    node.raw.Parent = this.id;\n    node.raw.Rel = \"Components\" // kludge\n    this.raw.Linked.Components.push(node.id);\n    triggerHook(node, \"onAttach\", node);\n    this.changed();\n  } \n\n  removeComponent(type: any) {\n    const coms = this.components.filter(n => n.name === componentName(type));\n    if (coms.length > 0) {\n      coms[0].destroy();\n    }\n    this.changed();\n  }\n  \n  hasComponent(type: any): boolean {\n    const coms = this.components.filter(n => n.name === componentName(type));\n    if (coms.length > 0) {\n      return true;\n    }\n    return false;\n  }\n\n  getComponent(type: any): any|null {\n    const coms = this.components.filter(n => n.name === componentName(type));\n    if (coms.length > 0) {\n      return coms[0].value;\n    }\n    return null;\n  }\n  // getComponentsInChildren\n  // getComponentsInParents\n\n  getLinked(rel: string): INode[] {\n    if (!this.raw.Linked[rel]) return [];\n    return this.raw.Linked[rel].map(id => new Node(this._bus, id));\n  }\n\n  addLinked(rel: string, node: INode) {\n    if (!this.raw.Linked[rel]) {\n      this.raw.Linked[rel] = [];\n    }\n    node.raw.Rel = rel; // kludge\n    this.raw.Linked[rel].push(node.id);\n    this.changed();\n  } \n\n  removeLinked(rel: string, node: INode) {\n    if (!this.raw.Linked[rel]) {\n      this.raw.Linked[rel] = [];\n    }\n    const linked = this.raw.Linked[rel].filter(id => id === node.id);\n    this.raw.Linked[rel] = linked;\n    this.changed();\n  }\n\n  moveLinked(rel: string, node: INode, idx: number) {\n    if (!this.raw.Linked[rel]) {\n      this.raw.Linked[rel] = [];\n    }\n    const oldIdx = this.raw.Linked[rel].findIndex(id => id === node.id);\n    if (oldIdx === -1) return;\n    const linked = this.raw.Linked[rel];\n    linked.splice(idx, 0, linked.splice(oldIdx, 1)[0]);\n    this.raw.Linked[rel] = linked;\n    this.changed();\n  }\n\n  getAttr(name: string): string {\n    return this.raw.Attrs[name] || \"\";\n  }\n\n  setAttr(name: string, value: string) {\n    this.raw.Attrs[name] = value;\n    this.changed();\n  }\n\n  find(path: string): INode|null {\n    return this.bus.find([this.path, path].join(\"/\"));\n  }\n\n  walk(fn: WalkFunc, opts?: WalkOptions): boolean {\n    opts = opts || {\n      followRefs: false,\n      includeComponents: false\n    };\n    if (fn(this)) {\n      return true;\n    }\n    let children = this.children;\n    if (this.refTo && opts.followRefs) {\n      if (fn(this.refTo)) {\n        return true;\n      }\n      children = this.refTo.children;\n    }\n    for (const child of children) {\n      if (child.walk(fn, opts)) return true;\n    }\n    if (opts.includeComponents) {\n      for (const com of this.components) {\n        if (com.walk(fn, opts)) return true;\n      }\n    }\n    return false;\n  }\n\n  destroy() {\n    if (this.isDestroyed) return;\n    if (this.refTo) {\n      this._bus.destroy(this);\n      return;\n    }\n    const nodes: INode[] = [];\n    this.walk((n: INode): boolean => {\n      nodes.push(n);\n      return false;\n    }, {\n      followRefs: false,\n      includeComponents: true\n    });\n    nodes.reverse().forEach(n => this._bus.destroy(n));\n  }\n\n  changed() {\n    this._bus.changed(this);\n  }\n  \n  // duplicate?\n}\n", "import { FileStore } from \"../backend/mod.ts\";\nimport { Bus, Node, RawNode } from \"../model/mod.ts\";\nimport { Path } from \"./mod.ts\";\nimport * as module from \"../model/module/mod.ts\";\n\n\n/**\n * Workspace is a container for nodes and manages marshaling them using\n * the FileStore backend API. It also keeps track of what nodes have been\n * expanded and what node was last opened. It serializes as JSON with a\n * version indicator and will handle migrations of old versions to the \n * latest when loading. Saving is currently debounced here so this applies\n * to all backends. \n */\nexport class Workspace {\n  fs: FileStore;\n  bus: Bus;\n\n  lastOpenedID: string;\n  expanded: { [key: string]: { [key: string]: boolean } }; // [rootid][id]\n\n  constructor(fs: FileStore) {\n    this.fs = fs;\n    this.bus = new module.Bus();\n    this.expanded = {};\n\n    this.writeDebounce = debounce(async (path, contents) => {\n      try {\n        await this.fs.writeFile(path, contents);\n        console.log(\"Saved workspace.\");\n      } catch (e: Error) {\n        console.error(e);\n        document.dispatchEvent(new CustomEvent(\"BackendError\"));\n      }\n    });\n  }\n\n  get rawNodes(): RawNode[] {\n    return this.bus.export();\n  }\n\n  observe(fn: (n: Node) => void) {\n    this.bus.observe(fn);\n  }\n\n  save() {\n    this.writeDebounce(\"workspace.json\", JSON.stringify({\n      version: 1,\n      lastopen: this.lastOpenedID,\n      expanded: this.expanded,\n      nodes: this.rawNodes\n    }, null, 2));\n  }\n\n  async load() {\n    let doc = JSON.parse(await this.fs.readFile(\"workspace.json\") || \"{}\");\n    if (Array.isArray(doc)) {\n      doc = {\n        version: 0,\n        nodes: doc\n      }\n    }\n    if (doc.nodes) {\n      this.bus.import(doc.nodes);\n      console.log(`Loaded ${doc.nodes.length} nodes.`);\n    }\n    if (doc.expanded) {\n      // Only import the node keys that still exist\n      // in the workspace.\n      for (const n in doc.expanded) {\n        for (const i in doc.expanded[n]) {\n          if (this.bus.find(i)) {\n            if (!this.expanded[n]) this.expanded[n] = {};\n            this.expanded[n][i] = doc.expanded[n][i];\n          }\n        }\n      }\n    }\n    if (doc.lastopen) {\n      this.lastOpenedID = doc.lastopen;\n    }\n\n  }\n\n  mainNode(): Node {\n    let main = this.bus.find(\"@workspace\");\n    if (!main) {\n      console.info(\"Building missing workspace node.\")\n      const root = this.bus.find(\"@root\");\n      const ws = this.bus.make(\"@workspace\");\n      ws.name = \"Workspace\";\n      ws.parent = root;\n      const cal = this.bus.make(\"@calendar\");\n      cal.name = \"Calendar\";\n      cal.parent = ws;\n      const home = this.bus.make(\"Home\");\n      home.parent = ws;\n      main = ws;\n    }\n    return main;\n  }\n\n  find(path: string): Node | null {\n    return this.bus.find(path)\n  }\n\n  new(name: string, value?: any): Node {\n    return this.bus.make(name, value);\n  }\n\n  // TODO: take single Path\n  getExpanded(head: Node, n: Node): boolean {\n    if (!this.expanded[head.id]) {\n      this.expanded[head.id] = {};\n    }\n    let expanded = this.expanded[head.id][n.id];\n    if (expanded === undefined) {\n      expanded = false;\n    }\n    return expanded;\n  }\n\n  // TODO: take single Path\n  setExpanded(head: Node, n: Node, b: boolean) {\n    this.expanded[head.id][n.id] = b;\n    this.save();\n  }\n\n  findAbove(path: Path): Path | null {\n    if (path.node.id === path.head.id) {\n      return null;\n    }\n    const p = path.clone();\n    p.pop(); // pop to parent\n    let prev = path.node.prevSibling;\n    if (!prev) {\n      // if not a field and parent has fields, return last field\n      const fieldCount = path.previous.getLinked(\"Fields\").length;\n      if (path.node.raw.Rel !== \"Fields\" && fieldCount > 0) {\n        return p.append(path.previous.getLinked(\"Fields\")[fieldCount - 1]);\n      }\n      // if no prev sibling, and no fields, return parent\n      return p;\n    }\n    const lastSubIfExpanded = (p: Path): Path => {\n      const expanded = this.getExpanded(path.head, p.node);\n      if (!expanded) {\n        // if not expanded, return input path\n        return p;\n      }\n      const fieldCount = p.node.getLinked(\"Fields\").length;\n      if (p.node.childCount === 0 && fieldCount > 0) {\n        const lastField = p.node.getLinked(\"Fields\")[fieldCount - 1];\n        // if expanded, no children, has fields, return last field or its last sub if expanded\n        return lastSubIfExpanded(p.append(lastField));\n      }\n      const lastChild = p.node.children[p.node.childCount - 1];\n      // return last child or its last sub if expanded\n      return lastSubIfExpanded(p.append(lastChild));\n    }\n    // return prev sibling or its last child if expanded\n    return lastSubIfExpanded(p.append(prev));\n  }\n\n  findBelow(path: Path): Path | null {\n    // TODO: find a way to indicate pseudo \"new\" node for expanded leaf nodes\n    const p = path.clone();\n    if (this.getExpanded(path.head, path.node) && path.node.getLinked(\"Fields\").length > 0) {\n      // if expanded and fields, return first field\n      return p.append(path.node.getLinked(\"Fields\")[0]);\n    }\n    if (this.getExpanded(path.head, path.node) && path.node.childCount > 0) {\n      // if expanded and children, return first child\n      return p.append(path.node.children[0]);\n    }\n    const nextSiblingOrParentNextSibling = (p: Path): Path | null => {\n      const next = p.node.nextSibling;\n      if (next) {\n        p.pop(); // pop to parent\n        // if next sibling, return that\n        return p.append(next);\n      }\n      const parent = p.previous;\n      if (!parent) {\n        // if no parent, return null\n        return null;\n      }\n      if (p.node.raw.Rel === \"Fields\" && parent.childCount > 0) {\n        p.pop(); // pop to parent\n        // if field and parent has children, return first child\n        return p.append(parent.children[0]);\n      }\n      p.pop(); // pop to parent\n      // return parents next sibling or parents parents next sibling\n      return nextSiblingOrParentNextSibling(p);\n    }\n    // return next sibling or parents next sibling\n    return nextSiblingOrParentNextSibling(p);\n  }\n\n}\n\n\nfunction debounce(func, timeout = 3000) {\n  let timer;\n  return (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => { func.apply(this, args); }, timeout);\n  };\n}\n", "import { bindingSymbols } from \"../action/keybinds.ts\";\n\nexport const Menu: m.Component = {\n  view({attrs: {workbench, x, y, items, align, commands, ctx}}) {\n    const onclick = (item, cmd) => (e) => {\n      e.stopPropagation();\n      if (item.disabled) {\n        return;\n      }\n      if (item.onclick) {\n        item.onclick();\n      }\n      if (cmd) {\n        workbench.executeCommand(cmd.id, ctx);\n      }\n      workbench.hideMenu();\n    };\n    let posStyle = {left: `${x}px`};\n    if (align === \"right\") {\n      posStyle = {right: `${x}px`};\n    }\n    return (\n<ul class=\"menu\" style={Object.assign(posStyle, {\n  margin: \"0\",\n  position: \"absolute\",\n  top: `${y}px`,\n  display: \"inline-block\",\n})}>\n  {items.filter(i => !i.when || i.when()).map(i => {\n    let title = \"\";\n    let binding = undefined;\n    let cmd = undefined;\n    if (i.command) {\n      cmd = commands.find(c => c.id === i.command);\n      binding = workbench.keybindings.getBinding(cmd.id);\n      title = cmd.title;\n    }\n    if (i.title) {\n      title = i.title();\n    }\n    return (\n      <li onclick={onclick(i, cmd)} class={(i.disabled)?\"disabled\":\"\"} style={{\n        display: \"flex\"\n      }}>\n        <div>{title}</div>\n        {binding && <div class=\"keybindings grow text-right\">{bindingSymbols(binding.key).join(\" \").toUpperCase()}</div>}\n      </li>\n    )\n  })}\n</ul>\n    )  \n  }\n};\n\n/* <li style={liStyle}><div>Indent</div><div style={shortcutStyle}>shift+A</div></li>\n<li style={liStyle}><div>Open in new panel</div><div style={shortcutStyle}>shift+meta+Backspace</div></li>\n<hr style={{marginLeft: \"0.5rem\", marginRight: \"0.5rem\" }} />\n<li style={liStyle}>Show list view</li>\n<li style={liStyle}>Move</li>\n<li style={liStyle}>Delete node</li>\n<hr style={{marginLeft: \"0.5rem\", marginRight: \"0.5rem\" }} /> */\n", "\nexport const CommandPalette: m.Component = {\n  onupdate({ state, dom }) {\n    const children = dom.querySelector(\".commands\").children;\n    if (state.selected !== undefined && children.length > 0) {\n      children[state.selected].scrollIntoView({ block: \"nearest\" });\n    }\n  },\n\n  oncreate({ state, dom }) {\n    dom.querySelector(\"input\").focus();\n    if (state.selected === undefined) {\n      state.selected = 0;\n    }\n  },\n\n  view({ attrs, state }) {\n    const workbench = attrs.workbench;\n    state.filter = (state.filter === undefined) ? \"\" : state.filter;\n    const cmds = Object.values(workbench.commands.commands);\n    const filtered = cmds.filter(cmd => {\n      const value = cmd.title || cmd.id;\n      return value.toLowerCase().startsWith(state.filter.toLowerCase());\n    })\n    const onkeydown = (e) => {\n      const mod = (a, b) => ((a % b) + b) % b;\n      if (e.key === \"ArrowDown\") {\n        if (state.selected === undefined) {\n          state.selected = 0;\n          return;\n        }\n        state.selected = mod(state.selected + 1, filtered.length);\n        return false;\n      }\n      if (e.key === \"ArrowUp\") {\n        if (state.selected === undefined) {\n          state.selected = 0;\n        }\n        state.selected = mod(state.selected - 1, filtered.length);\n        return false;\n      }\n      if (e.key === \"Enter\") {\n        if (state.selected !== undefined) {\n          workbench.commands.executeCommand(filtered[state.selected].id, attrs.ctx);\n          workbench.hidePalette();\n        }\n        return false;\n      }\n    }\n    const onclick = (cmd) => {\n      workbench.commands.executeCommand(cmd.id, attrs.ctx);\n      workbench.hidePalette();\n    }\n    const autocomplete = (e) => {\n      state.filter = e.target.value;\n      state.selected = 0;\n    }\n    return (\n      <div class=\"palette\" style={{\n        position: \"absolute\",\n        left: `${attrs.x}px`,\n        top: `${attrs.y}px`\n      }}>\n        <div><input style={{ width: \"98%\", outline: \"0\", border: \"0\" }} type=\"text\" onkeydown={onkeydown} oninput={autocomplete} placeholder=\"Enter command...\" /></div>\n        <div class=\"commands\" style={{\n          overflowY: \"scroll\",\n          position: \"relative\"\n        }}>\n          {filtered.map((cmd, idx) => <div class={(state.selected === idx) ? \"selected\" : \"\"} onclick={() => onclick(cmd)}>{cmd.title || cmd.id}</div>)}\n        </div>\n      </div>\n    )\n  }\n}\n", "import { objectCall, objectHas } from \"../../model/hooks.ts\";\n\nexport const NodeEditor: m.Component = {\n  view ({attrs: {workbench, path, onkeydown, disallowEmpty, editValue}, state}) {\n    const node = path.node;\n    let prop = (editValue) ? \"value\" : \"name\";\n    \n    const display = () => {\n      if (prop === \"name\") {\n        return objectHas(node, \"displayName\") ? objectCall(node, \"displayName\", node) : node.name;\n      }\n      return node[prop] || \"\";\n    }\n    const onfocus = () => {\n      state.initialValue = node[prop];\n      workbench.context.node = node;\n      workbench.context.path = path;\n    }\n    const getter = () => {\n      return node[prop];\n    }\n    const setter = (v, finished) => {\n      if (!node.isDestroyed) {\n        if (disallowEmpty && v.length === 0) {\n          node[prop] = state.initialValue;\n        } else {\n          node[prop] = v;\n        }\n      }\n      if (finished) {\n        workbench.context.node = null;\n      }\n    }\n\n    let placeholder;\n    if (node.raw.Rel === \"Fields\") {\n      placeholder = (editValue) ? \"Value\" : \"Field\";\n    }\n    \n    let id = `input-${path.id}-${node.id}`;\n    if (prop === \"value\") {\n      id = id+\"-value\";\n    }\n    return m(TextEditor, {id, getter, setter, display, onkeydown, onfocus, placeholder});\n  }\n}\n\n\ninterface Attrs {\n  id?: string;\n  onkeydown?: Function;\n  onfocus?: Function;\n  onblur?: Function;\n  onmount?: Function;\n  getter: Function;\n  setter: Function;\n  display?: Function;\n}\n\ninterface State {\n  editing: boolean;\n  buffer: string;\n}\n\nexport const TextEditor: m.Component<Attrs, State> = {\n  oncreate({dom,attrs}) {\n    const textarea = dom.querySelector(\"textarea\");\n    const initialHeight = textarea.offsetHeight;\n    const span = dom.querySelector(\"span\");\n    this.updateHeight = () => {\n      span.style.width = `${Math.max(textarea.offsetWidth, 100)}px`;\n      span.innerHTML = textarea.value.replace(\"\\n\", \"<br/>\");\n      textarea.style.height = (span.offsetHeight > 0) ? `${span.offsetHeight}px` : `${initialHeight}px`;\n    }\n    textarea.addEventListener(\"input\", () => this.updateHeight());\n    textarea.addEventListener(\"blur\", () => span.innerHTML = \"\");\n    setTimeout(() => this.updateHeight(), 50);\n    if (attrs.onmount) attrs.onmount(textarea);\n  },\n  onupdate() {\n    this.updateHeight();\n  },\n  view ({attrs: {id, onkeydown, onfocus, onblur, getter, setter, display, placeholder}, state}) {\n    const value = (state.editing) \n      ? state.buffer \n      : (display) ? display() : getter();\n    \n    const defaultKeydown = (e) => {\n      if (e.key === \"Enter\") {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    }\n    const startEdit = (e) => {\n      if (onfocus) onfocus(e);\n      state.editing = true;\n      state.buffer = getter();\n    }\n    const finishEdit = (e) => {\n      // safari can trigger blur more than once\n      // for a given element, namely when clicking\n      // into devtools. this prevents the second \n      // blur setting node name to undefined/empty.\n      if (state.editing) {\n        state.editing = false;\n        setter(state.buffer, true);\n        state.buffer = undefined;\n      }\n      if (onblur) onblur(e);\n    }\n    const edit = (e) => {\n      state.buffer = e.target.value;\n      setter(state.buffer, false);\n    }\n    \n    // TODO: node-container => text-editor\n    return (\n      <div class=\"node-container\">\n        <textarea\n          id={id}\n          rows=\"1\"\n          onfocus={startEdit}\n          onblur={finishEdit}\n          oninput={edit}\n          placeholder={placeholder}\n          onkeydown={onkeydown||defaultKeydown}\n          value={value}>{value}</textarea>\n        <span style={{visibility: \"hidden\", position: \"fixed\"}}></span>\n      </div>\n    )\n  }\n}", "import { NewNode } from \"../ui/node/new.tsx\";\nimport { OutlineNode } from \"../ui/outline.tsx\";\n\nexport default {\n  view({attrs: {node, workbench, panel}}) {\n    return (\n      <div class=\"empty-view\">\n      </div>\n    )\n  }\n}", "\nexport const NewNode = {\n  view({attrs: {workbench, path}}) {\n    const startNew = (e) => {\n      workbench.executeCommand(\"insert-child\", {node: path.node, path}, e.target.value);\n    }\n    const tabNew = (e) => {\n      if (e.key === \"Tab\") {\n        e.stopPropagation();\n        e.preventDefault();\n        if (node.childCount > 0) {\n          const lastchild = path.node.children[path.node.childCount-1];\n          workbench.executeCommand(\"insert-child\", {node: lastchild, path});\n        }\n      }\n    }\n    return (\n      <div class=\"new-node flex flex-row items-center\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"gray\" viewBox=\"0 0 16 16\">\n          <circle cx=\"8\" cy=\"7\" r=\"7\" />\n          <path style={{transform: \"translate(0px, -1px)\"}} d=\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\"/>\n        </svg>\n        <div class=\"flex grow\">\n          <input class=\"grow\"\n            type=\"text\"\n            oninput={startNew}\n            onkeydown={tabNew}\n            value={\"\"}\n          />\n        </div>\n      </div>\n    )\n  }\n}", "import { NewNode } from \"../ui/node/new.tsx\";\nimport { OutlineNode } from \"../ui/outline.tsx\";\n\nexport default {\n  view({attrs: {workbench, path}}) {\n    let node = path.node;\n    if (path.node.refTo) {\n      node = path.node.refTo;\n    }\n    return (\n      <div class=\"list-view\">\n        <div class=\"fields\">\n          {(node.getLinked(\"Fields\").length > 0) &&\n            node.getLinked(\"Fields\").map(n => <OutlineNode key={n.id} workbench={workbench} path={path.append(n)} />)\n          }\n        </div>\n        <div class=\"children\">\n          {(node.childCount > 0)\n            ?node.children.map(n => <OutlineNode key={n.id} workbench={workbench} path={path.append(n)} />)\n            :<NewNode workbench={workbench} path={path} />\n          }\n        </div>\n      </div>\n    )\n  }\n}", "import { NodeEditor, TextEditor } from \"../ui/node/editor.tsx\";\nimport { OutlineNode } from \"../ui/outline.tsx\";\n\nexport default {\n  view({attrs: {workbench, path}, state}) {\n    const node = path.node;\n    state.fields = (state.fields === undefined) ? new Set() : state.fields;\n    node.children.forEach(n => {\n      n.getLinked(\"Fields\").forEach(f => state.fields.add(f.name));\n    });\n    const getFieldEditor = (node, field) => {\n      const fields = node.getLinked(\"Fields\").filter(f => f.name === field);\n      if (fields.length === 0) return \"\";\n      return <NodeEditor editValue={true} workbench={workbench} path={path.append(fields[0])} />\n    }\n    return (\n      <table class=\"table-view\" style={{gridTemplateColumns: `repeat(${state.fields.size+1}, 1fr)`}}>\n        <thead>\n          <tr>\n            <th></th>\n            {[...state.fields].map(f => <th>{f}</th>)}\n          </tr>\n        </thead>\n        <tbody>\n          {node.children.map(n => (\n            <tr>\n              <td><OutlineNode key={n.id} workbench={workbench} path={path.append(n)} /></td>\n              {[...state.fields].map(f => <td>{getFieldEditor(n, f)}</td>)}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    )\n  }\n}", "import empty from \"./empty.tsx\";\nimport list from \"./list.tsx\";\nimport table from \"./table.tsx\";\n\nexport const views = {\n  list,\n  table\n}\n\nexport function getView(name) {\n  return views[name] || empty;\n}\n\nwindow.registerView = (name, view) => {\n  views[name] = view;\n  workbench.commands.registerCommand({\n    id: `view-${name}`,\n    title: `View as ${toTitleCase(name)}`,\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      ctx.node.setAttr(\"view\", name);\n    }\n  });\n}\n\nfunction toTitleCase(str) {\n  return str.replace(\n    /\\w\\S*/g,\n    function(txt) {\n      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n    }\n  );\n}", "\nimport { Workbench, Path } from \"../workbench/mod.ts\";\nimport { objectCall, objectHas } from \"../model/hooks.ts\";\nimport { NewNode } from \"./node/new.tsx\";\nimport { NodeEditor } from \"./node/editor.tsx\";\n\nimport { Checkbox } from \"../com/checkbox.tsx\";\nimport { Clock } from \"../com/clock.tsx\";\nimport { getView } from \"../view/views.ts\";\n\ninterface Attrs {\n  path: Path;\n  workbench: Workbench;\n}\n\ninterface State {\n  hover: boolean;\n  editing: boolean;\n  buffer?: string;\n}\n\nexport const OutlineEditor: m.Component<Attrs> = {\n  view ({attrs: {workbench, path}}) {\n    return m(getView(path.node.getAttr(\"view\")||\"list\"), {workbench, path});\n  }\n}\n\n// handles: expanded state, node menu+handle, children\nexport const OutlineNode: m.Component<Attrs, State> = {\n  view ({attrs, state, children}) {\n    let {path, workbench} = attrs;\n    let node = path.node;\n\n    let isRef = false;\n    let handleNode = node;\n    if (node.refTo) {\n      isRef = true;\n      node = handleNode.refTo;\n    }\n\n    const expanded = workbench.workspace.getExpanded(path.head, handleNode); \n\n    const hover = (e) => {\n      state.hover = true;\n      e.stopPropagation();\n    }\n    \n    const unhover = (e) => {\n      state.hover = false;\n      e.stopPropagation();\n    }\n    \n    const toggle = (e) => {\n      if (expanded) {\n        workbench.executeCommand(\"collapse\", {node: handleNode, path});\n      } else {\n        workbench.executeCommand(\"expand\", {node: handleNode, path});\n      }\n      e.stopPropagation();\n    }\n    \n    const checkCommands = (e) => {\n      const anyModifiers = e.shiftKey || e.metaKey || e.altKey || e.ctrlKey;\n      switch (e.key) {\n      case \"ArrowUp\":\n        if (e.target.selectionStart !== 0 && !anyModifiers) {\n          e.stopPropagation()\n        }\n        break;\n      case \"ArrowDown\":\n        if (e.target.selectionStart !== e.target.value.length && e.target.selectionStart !== 0 && !anyModifiers) {\n          e.stopPropagation()\n        }\n        break;\n      case \"Backspace\":\n        // cursor at beginning of empty text\n        if (e.target.value === \"\") {\n          e.preventDefault();\n          e.stopPropagation();\n          if (node.childCount > 0) {\n            return;\n          }\n          workbench.executeCommand(\"delete\", {node, path, event: e});\n          return;\n        }\n        // cursor at beginning of non-empty text\n        if (e.target.value !== \"\" && e.target.selectionStart === 0 && e.target.selectionEnd === 0) {\n          e.preventDefault();\n          e.stopPropagation();\n          \n          // TODO: make this work as a command?\n          const above = workbench.workspace.findAbove(path);\n          if (!above) {\n            return;\n          }\n          const oldName = above.node.name;\n          above.node.name = oldName+e.target.value;\n          node.destroy();\n          m.redraw.sync();\n          workbench.focus(above, oldName.length);\n          \n          return;\n        }\n        break;\n      case \"Enter\":\n        e.preventDefault();\n        if (e.ctrlKey || e.shiftKey || e.metaKey || e.altKey) return;\n        // cursor at end of text\n        if (e.target.selectionStart === e.target.value.length) {\n          if (node.childCount > 0 && workbench.workspace.getExpanded(path.head, node)) {\n            workbench.executeCommand(\"insert-child\", {node, path}, \"\", 0);\n          } else {\n            workbench.executeCommand(\"insert\", {node, path});\n          }\n          e.stopPropagation();\n          return;\n        }\n        // cursor at beginning of text\n        if (e.target.selectionStart === 0) {\n          workbench.executeCommand(\"insert-before\", {node, path});\n          e.stopPropagation();\n          return;\n        }\n        // cursor in middle of text\n        if (e.target.selectionStart > 0 && e.target.selectionStart < e.target.value.length) {\n          workbench.executeCommand(\"insert\", {node, path}, e.target.value.slice(e.target.selectionStart)).then(() => {\n            node.name = e.target.value.slice(0, e.target.selectionStart);\n          });\n          e.stopPropagation();\n          return;\n        }\n        break;\n      }\n    }\n\n    const open = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      workbench.executeCommand(\"open\", {node, path});\n      \n      // clear text selection that happens after from double click\n      if (document.selection && document.selection.empty) {\n        document.selection.empty();\n      } else if (window.getSelection) {\n        window.getSelection().removeAllRanges();\n      }\n    }\n\n    const subCount = (n) => {\n      return n.childCount + n.getLinked(\"Fields\").length;\n    }\n\n    const showHandle = () => {\n      if (node.id === workbench.context?.node?.id || state.hover) {\n        return true;\n      }\n      return node.name.length > 0;\n    }\n\n    return (\n      <div onmouseover={hover} onmouseout={unhover}>\n        <div class=\"node-row-outer-wrapper flex flex-row items-start\">\n          <svg class=\"node-menu shrink-0\" xmlns=\"http://www.w3.org/2000/svg\"\n              onclick={(e) => workbench.showMenu(e, {node: handleNode, path})}\n              oncontextmenu={(e) => workbench.showMenu(e, {node: handleNode, path})} \n              data-menu=\"node\"\n              viewBox=\"0 0 16 16\">\n            {state.hover && <path style={{transform: \"translateY(-1px)\"}} fill-rule=\"evenodd\" d=\"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z\" />}\n          </svg>\n          <div class=\"node-handle shrink-0\" onclick={toggle} ondblclick={open} oncontextmenu={(e) => workbench.showMenu(e, {node: handleNode, path})} data-menu=\"node\" style={{ display: showHandle() ? 'block' : 'none' }}>\n            {(objectHas(node, \"handleIcon\"))\n              ? objectCall(node, \"handleIcon\")\n              : <svg class=\"node-bullet\" viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\">\n                {(subCount(node) > 0 && !expanded)?<circle id=\"node-collapsed-handle\" cx=\"8\" cy=\"7\" r=\"7\" />:null}\n                <circle cx=\"8\" cy=\"7\" r=\"3\" fill=\"currentColor\" />,\n                {(isRef)?<circle id=\"node-reference-handle\" cx=\"8\" cy=\"7\" r=\"7\" fill=\"none\" stroke-width=\"1\" stroke=\"currentColor\" stroke-dasharray=\"3,3\" />:null}\n              </svg>\n            }\n          </div>\n          {(node.raw.Rel === \"Fields\") \n            ? <div class=\"flex grow items-start flex-row\">\n                <div>\n                  <NodeEditor workbench={workbench} path={path} onkeydown={checkCommands} />\n                </div>\n                <NodeEditor editValue={true} workbench={workbench} path={path} onkeydown={checkCommands} />\n              </div>\n            : <div class=\"flex grow items-start flex-row\">\n                {objectHas(node, \"beforeEditor\") && m(objectCall(node, \"beforeEditor\"), {node})}\n                <NodeEditor workbench={workbench} path={path} onkeydown={checkCommands} />\n                {objectHas(node, \"afterEditor\") && m(objectCall(node, \"afterEditor\"), {node})}\n              </div>\n          }\n        </div>\n        {objectHas(node, \"belowEditor\") && m(objectCall(node, \"belowEditor\"), {node})}\n        {(expanded === true) &&\n          <div class=\"expanded-node flex flex-row\">\n            <div class=\"indent flex\" onclick={toggle}></div>\n            <div class=\"view grow\">\n              {m(getView(node.getAttr(\"view\")||\"list\"), {workbench, path})}\n            </div>\n          </div>\n        }\n      </div>\n    )\n  }\n};\n\n\n\n\n\n\n\n", "import { component } from \"../model/components.ts\";\nimport { Node } from \"../model/mod.ts\";\n\n@component\nexport class Page {\n  markdown: string;\n\n  constructor() {\n    this.markdown = \"\";\n  }\n}\n", "import { OutlineEditor } from \"./outline.tsx\";\nimport { NodeEditor } from \"./node/editor.tsx\";\nimport { Page } from \"../com/page.tsx\";\n\nexport const Panel = {\n  view({ attrs }) {\n    const path = attrs.path;\n    const workbench = attrs.workbench;\n    const node = path.node;\n\n    const close = (e) => {\n      workbench.executeCommand(\"close-panel\", {}, path);\n    }\n    const goBack = (e) => {\n      path.pop();\n    }\n    const maximize = (e) => {\n      // todo: should be a command\n      workbench.panels = [path];\n      workbench.context.path = path;\n    }\n    const editMarkdown = (e) => {\n      node.getComponent(Page).markdown = e.target.value;\n      node.changed();\n    }\n    function calcHeight(value = \"\") {\n      let numberOfLineBreaks = (value.match(/\\n/g) || []).length;\n      // min-height + lines x line-height + padding + border\n      let newHeight = 20 + numberOfLineBreaks * 20;\n      return newHeight;\n    }\n    return <div class=\"panel flex flex-col grow\">\n      <div class=\"bar flex\">\n        {(path.length > 1) ?\n          <div class=\"panel-back\" style={{ rightPadding: \"var(--padding)\" }}>\n            <svg onclick={goBack} xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\n              <path fill-rule=\"evenodd\" d=\"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z\" />\n            </svg>\n          </div>\n          : null}\n\n        <div class=\"panel-back-parent grow\">\n          {(node.parent && node.parent.id !== \"@root\") ? <span style={{ cursor: \"pointer\" }} onclick={() => workbench.open(node.parent)}>{node.parent.name}</span> : <span>&nbsp;</span>}\n        </div>\n\n        {(workbench.panels.length > 1) ?\n          <div class=\"panel-icons flex items-center\">\n            <svg onclick={maximize} style={{ cursor: \"pointer\" }} xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-maximize-2\"><polyline points=\"15 3 21 3 21 9\"></polyline><polyline points=\"9 21 3 21 3 15\"></polyline><line x1=\"21\" y1=\"3\" x2=\"14\" y2=\"10\"></line><line x1=\"3\" y1=\"21\" x2=\"10\" y2=\"14\"></line></svg>\n            <svg onclick={close} style={{ cursor: \"pointer\" }} xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-x\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>\n          </div>\n          : null}\n      </div>\n\n      <div class=\"body flex flex-col\">\n        <div class=\"title-node\" oncontextmenu={(e) => workbench.showMenu(e, { node, path })} data-menu=\"node\">\n          <NodeEditor workbench={workbench} path={path} disallowEmpty={true} />\n        </div>\n        {(node.hasComponent(Page)) ?\n          <textarea oninput={editMarkdown}\n            value={node.getComponent(Page).markdown}\n            placeholder=\"Enter Markdown text here\"\n            style={{\n              marginLeft: \"var(--padding)\",\n              padding: \"var(--padding)\",\n              outline: \"0\",\n              height: `${calcHeight(node.getComponent(Page).markdown)}px`,\n              border: \"0\",\n            }}>\n            {node.getComponent(Page).markdown}\n          </textarea>\n          : null}\n        <OutlineEditor workbench={workbench} path={path.sub()} />\n      </div>\n    </div>\n  }\n};\n", "import { OutlineEditor } from \"./outline.tsx\";\nimport { Path } from \"../workbench/mod.ts\";\n\nexport const QuickAdd = {\n  view({attrs: {workbench}}) {\n    const path = new Path(workbench.quickadd, \"quickadd\");\n    return (\n      <div style={{\n        position: \"absolute\", \n        left: \"0\", \n        right: \"0\", \n        top: \"0\", \n        bottom: \"0\",\n      }}>\n        \n        <div onclick={() => workbench.closeQuickAdd()} style={{\n          position: \"absolute\",\n          background: \"black\",\n          opacity: \"50%\",\n          width: \"100%\",\n          height: \"100%\"\n        }}></div>\n        \n        <div class=\"notice\" style={{\n          position: \"relative\",\n          marginLeft: \"auto\", \n          marginRight: \"auto\", \n          marginTop: \"20vh\", \n        }}>\n          <h3>Quick Add</h3>\n          <OutlineEditor workbench={workbench} path={path} />\n          <div class=\"button-bar\">\n            <button class=\"primary\" onclick={() => {\n              workbench.commitQuickAdd();\n              workbench.closeQuickAdd();\n            }}>Add to Today</button>\n            \n          </div>\n        </div>\n      </div>\n    )\n  }\n}", "\nexport const Search: m.Component = {\n  onupdate({state,dom}) {\n    const results = dom.querySelector(\".results\");\n    if (results && state.selected !== undefined && results.children.length > 0) {\n      results.children[state.selected].scrollIntoView({block: \"nearest\"});\n    }\n  },\n\n  view({attrs: {workbench}, state}) {\n    \n    state.query = (state.query === undefined) ? \"\" : state.query;\n    state.results = (state.results === undefined) ? [] : state.results;\n\n    const clear = () => {\n      state.query = \"\";\n      state.results = [];\n      workbench.curtain = null;\n    }\n\n    const open = (node) => {\n      workbench.open(node);\n      clear();\n    }\n    \n    const onkeydown = (e) => {\n      const mod = (a,b) => ((a % b) + b) % b;\n      if (e.key === \"ArrowDown\") {\n        if (state.selected === undefined) {\n          state.selected = 0;\n          return;\n        }\n        state.selected = mod(state.selected+1, state.results.length);\n        return false;\n      }\n      if (e.key === \"ArrowUp\") {\n        if (state.selected === undefined) {\n          state.selected = 0;\n        }\n        state.selected = mod(state.selected-1, state.results.length);\n        return false;\n      }\n      if (e.key === \"Enter\") {\n        if (state.selected !== undefined) {\n          open(state.results[state.selected]);\n        }\n        return false;\n      }\n      if (e.key === \"Escape\") {\n        clear();\n      }\n    }\n\n    const autocomplete = (e) => {\n      state.query = e.target.value;\n      state.selected = 0;\n\n      if (state.query) {\n        let splitQuery = state.query.split(/[ ]+/);\n        let textQuery = splitQuery.filter(term => !term.includes(\":\")).join(\" \");\n        let fieldQuery = Object.fromEntries(splitQuery.filter(term => term.includes(\":\")).map(term => term.toLowerCase().split(\":\")));\n        if (!textQuery && Object.keys(fieldQuery).length > 0) {\n          // when text query is empty, no results will show up,\n          // but we index field names, so this works for now.\n          textQuery = Object.keys(fieldQuery)[0];\n        }\n        state.results = workbench.backend.index.search(textQuery).map(id => {\n          let node = workbench.workspace.find(id);\n          if (!node) {\n            return undefined;\n          }\n          // if component value, get the parent\n          if (node.value) {\n            node = node.parent;\n            // parent might not actually exist\n            if (!node.raw) return undefined;\n          }\n          // kludgy filter on fields\n          if (Object.keys(fieldQuery).length > 0) {\n            const fields = {};\n            for (const f of node.getLinked(\"Fields\")) {\n              fields[f.name.toLowerCase()] = f.value.toLowerCase();\n            }\n            for (const f in fieldQuery) {\n              if (!fields[f] || fields[f] !== fieldQuery[f]) {\n                return undefined;\n              }\n            }\n          }\n          return node;\n        }).filter(n => n !== undefined);\n      } else {\n        state.results = [];\n      }\n\n      if (state.query && state.results.length > 0) {\n        workbench.curtain = {\n          visible: false,\n          onclick: () => clear()\n        };\n      } else {\n        workbench.curtain = null;\n      }\n      \n    }\n\n\n\n    return (\n      <div class={(state.results.length > 0)?\"search active flex grow\":\"search flex grow\"}>\n        <div>\n          <div class=\"flex\" style={{margin: (state.results.length > 0)?\"0\":\"1px\"}}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-search shrink-0\"><circle cx=\"11\" cy=\"11\" r=\"8\"></circle><line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"></line></svg>\n            <input type=\"text\" placeholder=\"Search\" value={state.query} onkeydown={onkeydown} oninput={autocomplete} style={{\n              border: \"0\", \n              outline: \"0\", \n              background: \"transparent\", \n              paddingTop: \"3px\"}} />\n          </div>\n          {(state.results.length > 0)?\n            <div class=\"results\" style={{\n              overflowX: \"hidden\",\n              overflowY: \"auto\",\n              maxHeight: \"400px\"\n            }}>\n              {state.results.map((result, idx) => <div onclick={() => open(result)} class={(state.selected===idx)?\"selected\":\"\"}>{result.name}</div>)}\n            </div>\n          :null}\n        </div>\n      </div>\n    )\n  }\n}\n", "\nexport const LockStolenMessage = {\n  view({attrs: {workbench, finished}}) {\n    return (\n      <div>\n        <h3>Refresh to view latest updates</h3>\n        <p>\n          Your notes were updated in another browser session. Refresh the page to view the latest version.\n        </p>\n        <div class=\"button-bar\">\n          <button class=\"primary\" onclick={() => {\n            finished();\n          }}>Refresh Now</button>\n          \n        </div>\n      </div>\n    )\n  }\n}\n\nexport const FirstTimeMessage = {\n  view({attrs: {workbench}}) {\n    return (\n      <div>\n        <h3>Treehouse is under active development</h3>\n        <p>This is a preview based on our main branch, which is actively being developed.</p>\n        <p>If you find a bug, please report it via \n          [ <svg xmlns=\"http://www.w3.org/2000/svg\" style={{display: \"inline\", marginLeft: \"0.25rem\", marginRight: \"0.25rem\"}} width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\n            <path d=\"M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z\"/>\n          </svg> &gt; Submit Issue ].\n        </p>\n        <p>\n          Data is stored using localstorage, which you can reset via \n          [ <svg xmlns=\"http://www.w3.org/2000/svg\" style={{display: \"inline\", marginLeft: \"0.25rem\", marginRight: \"0.25rem\"}} width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\n            <path d=\"M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z\"/>\n          </svg> &gt; Reset Demo ].\n        </p>\n        <div class=\"button-bar\">\n          <button class=\"primary\" onclick={() => {\n            localStorage.setItem(\"firsttime\", \"1\");\n            workbench.hideNotice()\n          }}>Got it</button>\n          \n        </div>\n      </div>\n    )\n  }\n}\n\nexport const GitHubMessage = {\n  view({attrs: {workbench, finished}}) {\n    return (\n      <div>\n        <h3>Login with GitHub</h3>\n        <p>The GitHub backend is experimental so use at your own risk!</p>\n        <p>To store your workbench we will create a public repository called <pre style={{display: \"inline\"}}>&lt;username&gt;.treehouse.sh</pre> if it doesn't already exist. You can manually make this repository private via GitHub if you want.</p>\n        <p>You can Logout via the \n          <svg xmlns=\"http://www.w3.org/2000/svg\" style={{display: \"inline\", marginLeft: \"0.5rem\", marginRight: \"0.5rem\"}} width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\n            <path d=\"M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z\"/>\n          </svg>\n          menu in the top right to return to the localstorage backend.\n        </p>\n        <div class=\"button-bar\">\n          <button onclick={() => {\n            workbench.hideNotice();\n          }}>Cancel</button>\n          <button class=\"primary\" onclick={() => {\n              workbench.hideNotice();\n              localStorage.setItem(\"github\", \"1\");\n              finished();\n            }}>Log in with GitHub</button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport const Notice = {\n  view({attrs: {workbench, message, finished}}) {\n    return (\n      <div style={{\n        position: \"absolute\", \n        left: \"0\", \n        right: \"0\", \n        top: \"0\", \n        bottom: \"0\",\n      }}>\n        \n        <div style={{\n          position: \"absolute\",\n          background: \"black\",\n          opacity: \"50%\",\n          width: \"100%\",\n          height: \"100%\"\n        }}></div>\n        \n        <div class=\"notice\" style={{\n          position: \"relative\",\n          marginLeft: \"auto\", \n          marginRight: \"auto\",\n          filter: \"drop-shadow(2px 2px 4px #5555)\",\n          marginTop: \"20vh\", \n        }}>\n          {m({\n            \"firsttime\": FirstTimeMessage,\n            \"github\": GitHubMessage,\n            \"lockstolen\": LockStolenMessage,\n          }[message], {workbench, finished})}\n        </div>\n      </div>\n    )\n  }\n}", "import { Menu } from \"./menu.tsx\";\nimport { CommandPalette } from \"./palette.tsx\";\nimport { Panel as PanelComponent } from \"./panel.tsx\";\nimport { QuickAdd } from \"./quickadd.tsx\";\nimport { Search } from \"./search.tsx\";\nimport { Notice } from \"./notices.tsx\";\n\nexport const App: m.Component = {\n  view ({attrs: {workbench}, state}) {\n    state.open = (state.open === undefined) ? true : state.open;\n    const toggle = (e) => {\n      if (state.open) {\n        state.open = false;\n      } else {\n        state.open = true;\n      }\n    }\n    return (\n      <main class=\"workbench m-0 flex flex-row absolute inset-0\" style={{overflow: \"none\"}}>\n        <div class=\"sidebar flex flex-col\" style={{width: (state.open)?\"256px\":\"52px\"}}>\n          <div class=\"sidebar-topsection\" style={{height: \"56px\"}}>\n            <img class=\"logo\" src=\"/icon_transparent.png\" style={{width: \"20px\", height: \"20px\"}} />\n          </div>\n          <div class=\"grow sidebar-maincontent\">\n            {state.open && workbench.workspace.bus.root().children.map(node => <NavNode node={node} expanded={true} level={0} workbench={workbench} />)}\n          </div>\n          <div class=\"sidebar-bottomsection\">\n            <svg onclick={toggle} xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-sidebar\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><line x1=\"9\" y1=\"3\" x2=\"9\" y2=\"21\"></line></svg>\n          </div>\n        </div>\n        <div class=\"main flex flex-col grow\">\n          <div class=\"topbar flex\">\n            <div class=\"topbar-item\" onclick={() => workbench.openToday()} style={{cursor: \"pointer\", marginLeft: \"var(--padding)\", marginRight: \"var(--padding)\", display: \"flex\", alignItems: \"center\"}}>\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-calendar\">\n                <rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><line x1=\"16\" y1=\"2\" x2=\"16\" y2=\"6\"></line><line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"6\"></line><line x1=\"3\" y1=\"10\" x2=\"21\" y2=\"10\"></line>\n                {/* <text text-anchor=\"middle\" x=\"8\" y=\"13\" style={{fontSize: \"0.55rem\"}}>{(new Date()).getDate()}</text> */}\n              </svg>\n              <div>Today</div>\n            </div>\n            <div class=\"topbar-item\" onclick={() => workbench.openQuickAdd()} style={{cursor: \"pointer\", marginLeft: \"var(--padding)\", marginRight: \"var(--padding)\", display: \"flex\", alignItems: \"center\"}}>\n              <svg style={{marginRight: \"var(--1)\"}} xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-plus-circle\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"></line><line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line></svg>\n              <div>Quick Add</div>\n            </div>\n\n            <Search workbench={workbench} />\n            \n            <div onclick={(e) => workbench.showMenu(e)} data-menu=\"settings\" data-align=\"right\" style={{cursor: \"pointer\", marginLeft: \"var(--padding)\", marginRight: \"var(--padding)\"}}>\n              <svg  xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-menu\"><line x1=\"3\" y1=\"12\" x2=\"21\" y2=\"12\"></line><line x1=\"3\" y1=\"6\" x2=\"21\" y2=\"6\"></line><line x1=\"3\" y1=\"18\" x2=\"21\" y2=\"18\"></line></svg>\n            </div>\n          </div>\n          <div class=\"panels flex flex-row\" style={{position: \"relative\", overflow: \"hidden\"}}>\n            {workbench.panels.map(path => <div style={{ \n                flex: \"1 1 auto\",\n                overflowY: \"auto\"\n              }}><PanelComponent workbench={workbench} path={path} /></div>)}\n          </div>\n        </div>\n        \n        {workbench.curtain && \n          <div onclick={workbench.curtain.onclick} style={{\n            zIndex: \"10\",\n            position: \"absolute\",\n            background: \"black\",\n            opacity: (workbench.curtain.visible)?\"50%\":\"0%\",\n            width: \"100%\",\n            height: \"100%\"\n          }}></div>}\n        {workbench.menu && <Menu workbench={workbench} {...workbench.menu} />}\n        {workbench.palette && <CommandPalette workbench={workbench} {...workbench.palette} />}\n        {workbench.quickadd && <QuickAdd workbench={workbench} />}\n        {workbench.notice && <Notice workbench={workbench} {...workbench.notice} />}\n      </main>\n    )\n  }\n};\n\nconst NavNode: m.Component = {\n  view ({attrs: {node, workbench, expanded, level}, state}) {\n    state.expanded = (state.expanded === undefined) ? expanded : state.expanded;\n    const expandable = (node.childCount > 0 && level < 3);\n    const toggle = (e) => {\n      if (!expandable) return;\n      if (state.expanded) {\n        state.expanded = false;\n      } else {\n        state.expanded = true;\n      }\n      e.stopPropagation();\n    }\n    const open = (e) => {\n      workbench.open(node);\n    }\n    return (\n      <div>\n        <div style={{display: \"flex\", paddingBottom: \"var(--2)\" }}>\n          <svg onclick={toggle} style={{cursor: \"pointer\", flexShrink: \"0\", paddingTop: \"0px\", marginRight: \"0.125rem\"}} class=\"feather feather-chevron-right\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\" xmlns=\"http://www.w3.org/2000/svg\">          \n            {(expandable)\n                ?(state.expanded)\n                  ? <polyline points=\"6 9 12 15 18 9\"></polyline>\n                  : <polyline points=\"9 18 15 12 9 6\"></polyline>\n              :null}\n          </svg>\n          \n          <div onclick={open} style={{cursor: \"pointer\", lineHeight: \"1.25\", fontSize: \"0.875rem\", flexGrow: \"1\", maxWidth: \"100%\", overflow: \"hidden\", textOverflow: \"ellipsis\", whiteSpace: \"nowrap\"}}>\n            {node.name}\n          </div>\n        </div>\n        {state.expanded && \n          <div style={{marginLeft: \"0.5rem\"}}>\n            {node.children.filter(n => n.name !== \"\").map(n => <NavNode workbench={workbench} node={n} level={level+1} />)}\n          </div>\n        }\n      </div>\n    )\n  }\n};\n", "import { SearchIndex } from \"../backend/mod.ts\";\nimport { component } from \"../model/components.ts\";\nimport { Node } from \"../model/mod.ts\";\n\nfunction debounce(func, timeout = 1000){\n  let timer;\n  return (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => { func.apply(this, args); }, timeout);\n  };\n}\n\n@component\nexport class SearchNode {\n  index: SearchIndex;\n  component?: Node;\n  object?: Node;\n  results?: Node[];\n\n  lastQuery?: string;\n  lastResultCount?: number;\n\n  constructor() {\n    this.index = window.workbench.backend.index;\n    this.searchDebounce = debounce(this.search.bind(this));\n  }\n\n  handleIcon(): any {\n    return <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"11\" cy=\"11\" r=\"8\"></circle><line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"></line></svg>\n  }\n\n  displayName(node: Node): any {\n    return `Search for \"${node.name}\"`;\n  }\n\n  onAttach(node: Node) {\n    this.component = node;\n    this.object = node.parent;\n    node.bus.observe((n: Node) => {\n      if (!node.isDestroyed) {\n        this.searchDebounce();\n      }\n    })\n  }\n\n  search() {\n    console.log(\"searched\");\n    if (!this.object) return;\n\n    let query = this.object.name;\n    let splitQuery = query.split(/[ ]+/);\n    let textQuery = splitQuery.filter(term => !term.includes(\":\")).join(\" \");\n    let fieldQuery = Object.fromEntries(splitQuery.filter(term => term.includes(\":\")).map(term => term.toLowerCase().split(\":\")));\n    if (!textQuery && Object.keys(fieldQuery).length > 0) {\n      // when text query is empty, no results will show up,\n      // but we index field names, so this works for now.\n      textQuery = Object.keys(fieldQuery)[0];\n    }\n    const results = this.index.search(textQuery)\n      .map(id => {\n        let node = window.workbench.workspace.find(id);\n        if (!node) {\n          return undefined;\n        }\n        // if component/field value, get the parent\n        if (node.value) {\n          node = node.parent;\n          // parent might not actually exist\n          if (!node.raw) return undefined;\n        }\n        // kludgy filter on fields\n        if (Object.keys(fieldQuery).length > 0) {\n          const fields = {};\n          for (const f of node.getLinked(\"Fields\")) {\n            fields[f.name.toLowerCase()] = f.value.toLowerCase();\n          }\n          for (const f in fieldQuery) {\n            if (!fields[f] || fields[f] !== fieldQuery[f]) {\n              return undefined;\n            }\n          }\n        }\n        return node;\n      })\n      .filter(n => n !== undefined)\n      .filter(n => n.id !== this.object.id && n.id !== this.component.id);\n    if (results.length !== this.lastResultCount || query !== this.lastQuery) {\n      if (this.results) {\n        // clean up old results\n        this.results.forEach((n) => n.destroy());\n      }\n      this.results = results.map(n => {\n        const ref = this.object.bus.make(\"\");\n        ref.raw.Parent = \"@tmp\"; // cleaned up next import\n        ref.refTo = n;\n        return ref;\n      });\n      this.lastQuery = query;\n      this.lastResultCount = results.length;\n    }\n  }\n\n  objectChildren(node: Node, children: Node[]): Node[] {\n    if (!this.results) this.search();\n    return this.results;\n  }\n\n  toJSON(key: string): any {\n    return {};\n  }\n\n  fromJSON(obj: any) {\n    //console.log(\"fromJson\");\n  }\n}", "import { component } from \"../model/components.ts\";\nimport { Node } from \"../model/mod.ts\";\n\n@component\nexport class Checkbox {\n  checked: boolean;\n\n  constructor() {\n    this.checked = false;\n  }\n\n  beforeEditor() {\n    return CheckboxEditor;\n  }\n}\n\nconst CheckboxEditor = {\n  view({attrs: {node}}) {\n    const toggleCheckbox = (e) => {\n      const checkbox = node.getComponent(Checkbox);\n      checkbox.checked = !checkbox.checked;\n      node.changed();\n    }\n    return <input type=\"checkbox\" style={{marginTop: \"0.3rem\", marginRight: \"0.5rem\"}} onclick={toggleCheckbox} checked={node.getComponent(Checkbox).checked} />\n  }\n}", "import { component } from \"../model/components.ts\";\nimport { Node } from \"../model/mod.ts\";\n\n@component\nexport class TextField {\n  constructor() {\n    \n  }\n\n  handleIcon(): any {\n    return <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"4 7 4 4 20 4 20 7\"></polyline><line x1=\"9\" y1=\"20\" x2=\"15\" y2=\"20\"></line><line x1=\"12\" y1=\"4\" x2=\"12\" y2=\"20\"></line></svg>\n  }\n}", "import { component } from \"../model/components.ts\";\nimport { Node } from \"../model/mod.ts\";\nimport { Workbench, Context } from \"../workbench/mod.ts\";\n\n@component\nexport class Clock {\n  startedAt?: Date;\n  log: Date[][];\n  showLog: boolean;\n\n  component?: Node;\n  object?: Node;\n\n  constructor() {\n    this.log = [];\n    this.showLog = false;\n  }\n\n  onAttach(node: Node) {\n    this.component = node;\n    this.object = node.parent;\n  }\n\n\n  fromJSON(obj: any) {\n    if (obj.startedAt) {\n      this.startedAt = new Date(obj.startedAt);\n    }\n    this.log = (obj.log||[]).map(entry => [new Date(entry[0]), new Date(entry[1])]);\n    this.showLog = obj.showLog;\n  }\n\n  toJSON(key: string): any {\n    return {\n      startedAt: this.startedAt, \n      log: this.log,\n      showLog: this.showLog\n    };\n  }\n\n  localTotal(): number {\n    return this.log.map(this.entryDuration).reduce((acc, val) => acc+val, 0);\n  }\n\n  grandTotal(): number {\n    let total = this.localTotal();\n    if (this.object) {\n      this.object.children.forEach(child => {\n        if (child.hasComponent(Clock)) {\n          total += child.getComponent(Clock).grandTotal();\n        }\n      });\n    }\n    return total;\n  }\n\n  start() {\n    if (this.startedAt) return;\n    this.startedAt = new Date();\n  }\n\n  stop() {\n    if (!this.startedAt) return;\n    let now = new Date();\n    let diff = now.getTime() - this.startedAt.getTime();\n    if (diff/1000 >= 60) {\n      // only log if more than a minute\n      this.log.push([this.startedAt, now]);\n    }\n    this.startedAt = undefined;\n  }\n\n  formatEntry(entry: Date[]): string {\n    if (entry.length !== 2) return \"\";\n    return `${this.formatDate(entry[0])} - ${new Intl.DateTimeFormat(\"en\", {\n      timeStyle: \"short\",\n    }).format(entry[1])}`;\n  }\n\n  // duration in seconds\n  entryDuration(entry: Date[]): number {\n    const a = entry[0];\n    const b = entry[1] || new Date();\n    return (b.getTime() - a.getTime()) / 1000;\n  }\n\n  formatDate(d?: Date): string {\n    if (!d) {\n      return \"\";\n    }\n    return new Intl.DateTimeFormat(\"en\", {\n      dateStyle: \"short\",\n      timeStyle: \"short\",\n    }).format(d);\n  }\n\n  formatDuration(seconds: number): string {\n    let dur = seconds / 60;\n    let min = Math.floor(dur % 60);\n    dur = dur / 60;\n    let hrs = Math.floor(dur % 60);\n    return `${hrs}:${min.toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping: false})}`;\n  }\n\n  afterEditor() {\n    return ClockBadge;\n  }\n\n  belowEditor() {\n    return ClockLog;\n  }\n\n  static initialize(workbench: Workbench) {\n\n    workbench.commands.registerCommand({\n      id: \"stop-clock\",\n      title: \"Stop clock\",\n      action: (ctx: Context) => {\n        if (!ctx.node) return;\n        if (!ctx.node.hasComponent(Clock)) {\n          const clock = new Clock();\n          ctx.node.addComponent(clock);\n        }\n        ctx.node.getComponent(Clock).stop();\n        ctx.node.changed();\n      }\n    });\n    workbench.keybindings.registerBinding({command: \"stop-clock\", key: \"meta+o\" });\n    workbench.commands.registerCommand({\n      id: \"start-clock\",\n      title: \"Start clock\",\n      action: (ctx: Context) => {\n        if (!ctx.node) return;\n        if (!ctx.node.hasComponent(Clock)) {\n          const clock = new Clock();\n          ctx.node.addComponent(clock);\n        }\n        ctx.node.getComponent(Clock).start();\n        ctx.node.changed();\n      }\n    });\n    workbench.keybindings.registerBinding({command: \"start-clock\", key: \"meta+i\" });\n    workbench.commands.registerCommand({\n      id: \"remove-clock\",\n      title: \"Remove clock\",\n      action: (ctx: Context) => {\n        if (!ctx.node) return;\n        ctx.node.removeComponent(Clock);\n      }\n    });\n  }\n}\n\nconst ClockBadge = {\n  view({attrs: {node}}) {\n    const clock = node.getComponent(Clock);\n    const toggleLog = () => {\n      clock.showLog = !clock.showLog;\n      node.changed();\n    }\n    if (!clock.showLog && clock.startedAt) {\n      return (\n        <div onclick={toggleLog} class=\"flex flex-row items-center\" style={{background: \"green\", lineHeight: \"var(--body-line-height)\", paddingLeft: \"0.25rem\", paddingRight: \"0.25rem\", borderRadius: \"4px\", color: \"white\"}}>\n          <svg class=\"blink\" style={{width: \"1rem\", height: \"1rem\", marginRight: \"0.25rem\"}} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 6 12 12 16 14\"></polyline></svg>\n          <div>{clock.formatDuration(clock.entryDuration([clock.startedAt]))}</div>\n        </div>\n      )\n    }\n    return (\n      <div onclick={toggleLog} class=\"flex flex-row items-center\" style={{background: \"gray\", lineHeight: \"var(--body-line-height)\", paddingLeft: \"0.25rem\", paddingRight: \"0.25rem\", borderRadius: \"4px\", color: \"white\"}}>\n        <svg style={{width: \"1rem\", height: \"1rem\", marginRight: \"0.25rem\"}} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 6 12 12 16 14\"></polyline></svg>\n        <div>{clock.formatDuration(clock.grandTotal())}</div>\n      </div>\n    )\n  }\n}\n\nconst ClockLog = {\n  view({attrs: {node}}) {\n    const clock = node.getComponent(Clock);\n    if (!clock.showLog) return;\n    return (\n      <div class=\"expanded-node flex flex-row\">\n        <div class=\"indent flex\"></div>\n        <div class=\"grow\">\n          {clock.startedAt &&\n            <div class=\"flex flex-row\" style={{marginBottom: \"2px\"}}>\n              <div class=\"grow\">{clock.formatDate(clock.startedAt)} - ...</div>\n              <div class=\"flex flex-row items-center\" style={{background: \"green\", lineHeight: \"var(--body-line-height)\", paddingLeft: \"0.25rem\", paddingRight: \"0.25rem\", borderRadius: \"4px\", color: \"white\"}}>\n                <svg class=\"blink\" style={{width: \"1rem\", height: \"1rem\", marginRight: \"0.25rem\"}} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 6 12 12 16 14\"></polyline></svg>\n                <div>{clock.formatDuration(clock.entryDuration([clock.startedAt]))}</div>\n              </div>\n            </div>\n          }\n          {clock.log.toReversed().map(entry => (\n            <div class=\"flex flex-row\" style={{marginBottom: \"2px\"}}>\n              <div class=\"grow\">{clock.formatEntry(entry)}</div>\n              <div class=\"flex flex-row items-center\" style={{background: \"#aaa\", lineHeight: \"var(--body-line-height)\", paddingLeft: \"0.25rem\", paddingRight: \"0.25rem\", borderRadius: \"4px\", color: \"white\"}}>\n                <svg style={{width: \"1rem\", height: \"1rem\", marginRight: \"0.25rem\"}} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 6 12 12 16 14\"></polyline></svg>\n                <div>{clock.formatDuration(clock.entryDuration(entry))}</div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n}", "import {RawNode} from \"../model/mod.ts\";\n\n\nexport class BrowserBackend {\n  auth: null;\n  index: SearchIndex;\n  files: FileStore;\n\n  constructor() {\n    this.auth = null;\n    this.files = new FileStore();\n    if (window.MiniSearch) {\n      this.index = new SearchIndex_MiniSearch();\n    } else {\n      this.index = new SearchIndex_Dumb();\n    }\n  }\n}\n\nexport class SearchIndex_MiniSearch {\n  indexer: any; // MiniSearch\n\n  constructor() {\n    this.indexer = new MiniSearch({\n      idField: \"ID\",\n      fields: ['ID', 'Name', 'Value', 'Value.markdown'], // fields to index for full-text search\n      storeFields: ['ID'], // fields to return with search results\n      extractField: (document, fieldName) => {\n        return fieldName.split('.').reduce((doc, key) => doc && doc[key], document);\n      }\n    });\n  }\n\n  index(node: RawNode) {\n    if (this.indexer.has(node.ID)) {\n      this.indexer.replace(node);  \n    } else {\n      this.indexer.add(node);\n    }\n  }\n\n  remove(id: string) {\n    try {\n      this.indexer.discard(id);\n    } catch {}\n  }\n\n  search(query: string): string[] {\n    const suggested = this.indexer.autoSuggest(query);\n    if (suggested.length === 0) return [];\n    return this.indexer.search(suggested[0].suggestion, {prefix: true}).map(doc => doc.ID);\n  }\n}\n\n\nexport class SearchIndex_Dumb {\n  nodes: Record<string, string>;\n\n  constructor() {\n    this.nodes = {};\n  }\n\n  index(node: RawNode) {\n    this.nodes[node.ID] = node.Name;\n  }\n\n  remove(id: string) {\n    delete this.nodes[id];\n  }\n\n  search(query: string): string[] {\n    const results: string[] = [];\n    for (const id in this.nodes) {\n      if (this.nodes[id].includes(query)) {\n        results.push(id);\n      }\n    }\n    return results;\n  }\n}\n\n\n\nexport class FileStore {\n  async readFile(path: string): string|null {\n    return localStorage.getItem(`treehouse:${path}`);\n  }\n\n  async writeFile(path: string, contents: string) {\n    localStorage.setItem(`treehouse:${path}`, contents);\n  }\n}", "\nimport { Authenticator, SearchIndex, FileStore } from \"./mod.ts\";\nimport { BrowserBackend } from \"./browser.ts\";\nimport { encode, decode } from 'https://cdn.jsdelivr.net/npm/js-base64@3.7.5/base64.mjs';\n\nexport interface Options {\n  domain: string;           // domain used with username subdomain to produce repo name\n  checkDomain: boolean;     // redirect to user domain if it is not current location\n  authFallbackURL?: string; // URL to redirect to if auth fails\n}\n\nexport class GitHubBackend {\n  auth: Authenticator;\n\n  index: SearchIndex;\n  files: FileStore;\n\n  loginURL: string;\n  clientFactory: any; // Octokit class\n  client: any; // Octokit instance\n  user: User|null;\n  shas: Record<string, string>; // path => sha\n  \n  opts: Options;\n\n  constructor(loginURL: string, octokit: any, opts?: Options) {\n    this.loginURL = loginURL;\n    this.clientFactory = octokit;\n    this.auth = this;\n    this.shas = {};\n\n    this.opts = Object.assign({\n      domain: \"treehouse.sh\",\n      checkDomain: false,\n    }, opts || {});\n\n    const localbackend = new BrowserBackend();\n    this.index = localbackend.index;\n    this.files = localbackend.files;\n\n    \n  }\n\n  get repo(): string {\n    return `${this.user?.userID()}.${this.opts.domain}`;\n  }\n\n  async initialize() {\n    // delegate authorize callback to loginURL\n    const code = new URL(location.href).searchParams.get(\"code\");\n    if (code) {\n      try {\n        // remove ?code=... from URL\n        const querystring = location.search.replace(/\\bcode=\\w+/, \"\").replace(/\\?$/, \"\");\n        history.pushState({}, \"\", `${location.pathname}${querystring}`);\n  \n        const response = await fetch(this.loginURL, {\n          method: \"POST\",\n          mode: \"cors\",\n          headers: {\"content-type\": \"application/json\"},\n          body: JSON.stringify({ code })\n        });\n        \n        const result = await response.json();\n        if (result.error) {\n          throw result.error;\n        }\n        \n        localStorage.setItem(\"treehouse:gh-token\", result.token);\n  \n      } catch (e: Error) {\n        this.reset();\n        console.error(e);\n        return;\n      }\n    }\n\n    // capture access token if provided directly\n    const token = new URL(location.href).searchParams.get(\"access_token\");\n    if (token) {\n      try {\n        // remove ?access_token=... from URL\n        const querystring = location.search.replace(/\\baccess_token=\\w+/, \"\").replace(/\\?$/, \"\");\n        history.pushState({}, \"\", `${location.pathname}${querystring}`);\n        \n        localStorage.setItem(\"treehouse:gh-token\", token);\n      } catch (e: Error) {\n        this.reset();\n        console.error(e);\n        return;\n      }\n    }\n\n    try {\n      await this.authenticate();\n      if (!this.user) {\n        throw \"authentication failed\";\n      }\n    } catch (e: Error) {\n      console.error(e);\n      if (this.opts.authFallbackURL) {\n        location.href = this.opts.authFallbackURL;\n      }\n      return;\n    }\n    \n    // check domain if set to\n    if (this.opts.checkDomain && this.repo !== location.hostname) {\n      location.hostname = this.repo;\n      return;\n    }\n\n    // check if repo exists\n    try {\n      await this.client.rest.repos.get({\n        owner: this.user.userID(), \n        repo: this.repo\n      });\n    } catch (e: Error) {\n      if (e.message !== \"Not Found\") {\n        throw e;\n      }\n      // create if not\n      console.log(\"Creating repository...\");\n      const resp = await this.client.rest.repos.createForAuthenticatedUser({name: this.repo});\n      if (resp.status !== 201) {\n        console.error(resp);\n        return;\n      }\n    }\n\n    // check for workspace.json now\n    try {\n      await this.client.rest.repos.getContent({\n        owner: this.user.userID(), \n        repo: this.repo,\n        path: \"workspace.json\"\n      });\n    } catch (e: Error) {\n      if (e.name !== \"HttpError\") {\n        throw e;\n      }\n      // create empty if not\n      console.log(\"Creating workspace.json...\");\n      const resp = await this.client.rest.repos.createOrUpdateFileContents({\n        owner: this.user.userID(), \n        repo: this.repo,\n        path: \"workspace.json\", \n        message: \"initial commit\", \n        content: btoa(JSON.stringify([]))\n      });\n      if (resp.status !== 201) {\n        console.error(resp);\n        return;\n      }\n    }\n    \n    this.files = this;\n\n    \n    \n    const sessID = uniqueID();\n    await this.readFile(\"treehouse.lock\");\n    await this.writeFile(\"treehouse.lock\", sessID);\n    const lockCheck = setInterval(async () => {\n      const lockFile = await this.readFile(\"treehouse.lock\");\n      if (lockFile !== sessID) {\n        clearInterval(lockCheck);\n        document.dispatchEvent(new CustomEvent(\"BackendError\"));\n        console.warn(\"lock stolen!\");\n      }\n    }, 5000);\n  }\n\n  async loadExtensions() {\n    try {\n      const dirCheck = await this.client.rest.repos.getContent({\n        owner: this.user?.userID(), \n        repo: this.repo, \n        path: \"\",\n        random: Math.random().toString(36).substring(2)\n      });\n      if (dirCheck.data.find(o => o.type === \"dir\" && o.name === \"ext\")) {\n        const dirList = await this.client.rest.repos.getContent({\n          owner: this.user?.userID(), \n          repo: this.repo, \n          path: \"ext\",\n          random: Math.random().toString(36).substring(2)\n        });\n        for (const file of dirList.data) {\n          if (file.name.endsWith(\".css\")) {\n            // Load CSS \n            const resp = await this.client.rest.repos.getContent({\n              owner: this.user?.userID(), \n              repo: this.repo, \n              path: file.path,\n              random: Math.random().toString(36).substring(2)\n            });\n            const css = document.createElement(\"link\");\n            css.setAttribute(\"href\", `data:text/css;charset=utf-8;base64,${resp.data.content}`);\n            css.setAttribute(\"rel\", \"stylesheet\");\n            css.setAttribute(\"type\", \"text/css\");\n            document.head.appendChild(css);\n          } else if (file.name.endsWith(\".js\")) {\n            // Load JavaScript\n            const resp = await this.client.rest.repos.getContent({\n              owner: this.user?.userID(), \n              repo: this.repo, \n              path: file.path,\n              random: Math.random().toString(36).substring(2)\n            });\n            const js = document.createElement(\"script\");\n            js.setAttribute(\"type\", \"module\");\n            js.setAttribute(\"src\", `data:text/javascript;charset=utf-8;base64,${resp.data.content}`);\n            document.head.appendChild(js);\n          }\n        }\n      }\n      \n    } catch (e: Error) {}\n    \n  }\n  \n  async authenticate() {\n    const token = localStorage.getItem(\"treehouse:gh-token\");\n    if (!token) {\n      return;\n    }\n\n    this.client = new this.clientFactory({auth: token});\n    const resp = await this.client.rest.users.getAuthenticated();\n    if (!resp || resp.error) {\n      return;\n    }\n    this.user = new User(resp.data);\n\n    if(m)m.redraw();\n  }\n\n  currentUser(): User|null {\n    return this.user;\n  }\n\n  login() {\n    location.assign(this.loginURL);\n  }\n\n  reset() {\n    localStorage.removeItem(\"treehouse:gh-token\");\n    this.user = null;\n\n    if(m)m.redraw();\n  }\n  \n  logout() {\n    this.reset();\n    location.reload();\n  }\n\n\n  async readFile(path: string): string|null {\n    try {\n      const resp = await this.client.rest.repos.getContent({\n        owner: this.user?.userID(), \n        repo: this.repo, \n        path: path,\n        random: Math.random().toString(36).substring(2)\n      });\n      this.shas[path] = resp.data.sha;\n      return decode(resp.data.content);\n    } catch (e: Error) {\n      if (e.name !== \"HttpError\") {\n        console.error(e);\n      }\n      return null;\n    }\n  }\n\n  async writeFile(path: string, contents: string) {\n    const resp = await this.client.rest.repos.createOrUpdateFileContents({\n      owner: this.user?.userID(), \n      repo: this.repo, \n      path: path, \n      message: \"autosave\", \n      content: encode(contents), \n      sha: this.shas[path]\n    });\n    this.shas[path] = resp.data.content.sha;\n  }\n}\n\nexport class User {\n  user: any; // github user object\n\n  constructor(user: any) {\n    this.user = user;\n  }\n\n  userID(): string {\n    return this.user.login;\n  }\n\n  displayName(): string {\n    return this.user.name;\n  }\n\n  avatarURL(): string {\n    return this.user.avatar_url;\n  }\n}\n\nfunction uniqueID() {\n  const dateString = Date.now().toString(36);\n  const randomness = Math.random().toString(36).substring(2);\n  return dateString + randomness;\n};", "/**\n * A configurable, embeddable frontend for a graph/outline based note-taking tool.\n * \n * Treehouse can be embedded on a page and given a backend for a fully functional\n * SPA. The backend adapter provides hooks to integrate with various backends.\n * \n * Typical usage involves including resource dependencies on the page then running:\n * \n * ```ts\n * import {setup, BrowserBackend} from \"https://treehouse.sh/lib/treehouse.min.js\";\n * setup(document, document.body, new BrowserBackend());\n * ```\n * \n * In this case using the built-in BrowserBackend to store state in localStorage.\n * For more information see the [Quickstart Guide](https://treehouse.sh/docs/quickstart/).\n * \n * @module\n */\nimport { Path, Workbench } from \"./workbench/mod.ts\";\nimport { App } from \"./ui/app.tsx\";\nimport { Backend } from \"./backend/mod.ts\";\nimport { SearchNode } from \"./com/search.tsx\";\nimport { Checkbox } from \"./com/checkbox.tsx\";\nimport { Page } from \"./com/page.tsx\";\nimport { TextField } from \"./com/textfield.tsx\";\nimport { Clock } from \"./com/clock.tsx\";\n\nexport { BrowserBackend, SearchIndex_MiniSearch } from \"./backend/browser.ts\";\nexport { GitHubBackend } from \"./backend/github.ts\";\n\n\n/**\n * setup initializes and mounts a workbench UI with a given backend adapter to a document.\n * More specifically, first it initializes the given backend, then creates and initializes\n * a Workbench instance with that backend, then it mounts the App component to the given\n * target element. It will also add some event listeners to the document and currently\n * this is where it registers all the built-in commands and their keybindings, as well\n * as menus. \n */\nexport async function setup(document: Document, target: HTMLElement, backend: Backend) {\n  if (backend.initialize) {\n    await backend.initialize();\n  }\n\n  const workbench = new Workbench(backend);\n  window.workbench = workbench;\n\n  await workbench.initialize();\n\n  // TODO: better way to initialize components? \n  [\n    Clock,\n    TextField,\n    Page,\n    Checkbox,\n  ].forEach(com => {\n    if (com.initialize) {\n      com.initialize(workbench);\n    }\n  });\n\n\n  // pretty specific to github backend right now\n  document.addEventListener(\"BackendError\", () => {\n    workbench.showNotice(\"lockstolen\", () => {\n      location.reload();\n    });\n  });\n\n  workbench.commands.registerCommand({\n    id: \"create-search\",\n    title: \"Create Search Node\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      const search = new SearchNode();\n      ctx.node.addComponent(search);\n      workbench.workspace.setExpanded(ctx.path.head, ctx.node, true);\n    }\n  });\n\n\n  workbench.commands.registerCommand({\n    id: \"view-list\",\n    title: \"View as List\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      ctx.node.setAttr(\"view\", \"list\");\n    }\n  });\n\n  workbench.commands.registerCommand({\n    id: \"view-table\",\n    title: \"View as Table\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      ctx.node.setAttr(\"view\", \"table\");\n    }\n  });\n\n\n  workbench.commands.registerCommand({\n    id: \"add-page\",\n    title: \"Add page\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      const page = new Page();\n      ctx.node.addComponent(page);\n    }\n  });\n\n  workbench.commands.registerCommand({\n    id: \"remove-page\",\n    title: \"Remove page\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      ctx.node.removeComponent(Page);\n    }\n  });\n\n  workbench.commands.registerCommand({\n    id: \"add-checkbox\",\n    title: \"Add checkbox\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      const checkbox = new Checkbox();\n      ctx.node.addComponent(checkbox);\n    }\n  });\n\n  workbench.commands.registerCommand({\n    id: \"remove-checkbox\",\n    title: \"Remove checkbox\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      ctx.node.removeComponent(Checkbox);\n    }\n  });\n\n  workbench.commands.registerCommand({\n    id: \"create-field\",\n    title: \"Create Field\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      if (ctx.node.childCount > 0) return;\n      if (ctx.node.componentCount > 0) return;\n      const path = ctx.path.clone();\n      path.pop(); // drop node\n      const field = workbench.workspace.new(ctx.node.name, \"\");\n      field.raw.Parent = ctx.node.parent.id;\n      const text = new TextField();\n      field.addComponent(text);\n      ctx.node.parent.addLinked(\"Fields\", field);\n      path.push(field);\n      ctx.node.destroy();\n      m.redraw.sync();\n      workbench.focus(path);\n    }\n  });\n\n  workbench.commands.registerCommand({\n    id: \"mark-done\",\n    title: \"Mark done\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      if (ctx.node.hasComponent(Checkbox)) {\n        const checkbox = ctx.node.getComponent(Checkbox);\n        if (!checkbox.checked) {\n          checkbox.checked = true;\n          ctx.node.changed();\n        } else {\n          ctx.node.removeComponent(Checkbox);\n        }\n      } else {\n        const checkbox = new Checkbox();\n        ctx.node.addComponent(checkbox);\n      }\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"mark-done\", key: \"meta+enter\" });\n\n\n\n  workbench.commands.registerCommand({\n    id: \"expand\",\n    title: \"Expand\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      workbench.workspace.setExpanded(ctx.path.head, ctx.node, true);\n      m.redraw();\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"expand\", key: \"meta+arrowdown\" });\n  workbench.commands.registerCommand({\n    id: \"collapse\",\n    title: \"Collapse\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      workbench.workspace.setExpanded(ctx.path.head, ctx.node, false);\n      m.redraw();\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"collapse\", key: \"meta+arrowup\" });\n  workbench.commands.registerCommand({\n    id: \"indent\",\n    title: \"Indent\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      if (ctx.node.raw.Rel === \"Fields\") return;\n      const node = ctx.node; // redraw seems to unset ctx.node\n      const path = ctx.path.clone();\n      const prev = node.prevSibling;\n      if (prev !== null) {\n        path.pop(); // drop node\n        path.push(prev);\n        node.parent = prev;\n        path.push(node);\n        workbench.workspace.setExpanded(ctx.path.head, prev, true);\n        m.redraw.sync();\n        workbench.focus(path);\n      }\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"indent\", key: \"tab\" });\n  workbench.commands.registerCommand({\n    id: \"outdent\",\n    title: \"Outdent\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      if (ctx.node.raw.Rel === \"Fields\") return;\n      const node = ctx.node; // redraw seems to unset ctx.node\n      const parent = ctx.path.previous;\n      const path = ctx.path.clone();\n      if (parent !== null && parent.id !== \"@root\") {\n        path.pop(); // drop node\n        path.pop(); // drop parent\n        node.parent = parent.parent;\n        path.push(node);\n        node.siblingIndex = parent.siblingIndex + 1;\n        if (parent.childCount === 0) {\n          workbench.workspace.setExpanded(ctx.path.head, parent, false);\n        }\n        m.redraw.sync();\n        workbench.focus(path);\n      }\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"outdent\", key: \"shift+tab\" });\n  workbench.commands.registerCommand({\n    id: \"move-up\",\n    title: \"Move Up\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      const node = ctx.node; // redraw seems to unset ctx.node\n      const parent = node.parent;\n      if (parent !== null && parent.id !== \"@root\") {\n        const children = parent.childCount;\n        if (node.siblingIndex === 0) {\n          if (!parent.prevSibling) {\n            return;\n          }\n          const p = ctx.path.clone();\n          p.pop(); // drop node\n          p.pop(); // drop parent\n          const parentSib = parent.prevSibling;\n          p.push(parentSib);\n          p.push(node);\n          node.parent = parentSib;\n          node.siblingIndex = parentSib.childCount - 1;\n          workbench.workspace.setExpanded(ctx.path.head, parentSib, true);\n          m.redraw.sync();\n          workbench.focus(p);\n        } else {\n          if (children === 1) {\n            return;\n          }\n          node.siblingIndex = node.siblingIndex - 1;\n          m.redraw.sync();\n        }\n      }\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"move-up\", key: \"shift+meta+arrowup\" });\n  workbench.commands.registerCommand({\n    id: \"move-down\",\n    title: \"Move Down\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      const node = ctx.node; // redraw seems to unset ctx.node\n      const parent = node.parent;\n      if (parent !== null && parent.id !== \"@root\") {\n        const children = parent.childCount;\n        // if last child\n        if (node.siblingIndex === children - 1) {\n          if (!parent.nextSibling) {\n            return;\n          }\n          const p = ctx.path.clone();\n          p.pop(); // drop node\n          p.pop(); // drop parent\n          const parentSib = parent.nextSibling;\n          p.push(parentSib);\n          p.push(node);\n          node.parent = parentSib;\n          node.siblingIndex = 0;\n          workbench.workspace.setExpanded(ctx.path.head, parentSib, true);\n          m.redraw.sync();\n          workbench.focus(p);\n        } else {\n          if (children === 1) {\n            return;\n          }\n          node.siblingIndex = node.siblingIndex + 1;\n          m.redraw.sync();\n        }\n      }\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"move-down\", key: \"shift+meta+arrowdown\" });\n  workbench.commands.registerCommand({\n    id: \"insert-child\",\n    title: \"Insert Child\",\n    action: (ctx: Context, name: string = \"\", siblingIndex?: number) => {\n      if (!ctx.node) return;\n      const node = workbench.workspace.new(name);\n      node.parent = ctx.node;\n      if (siblingIndex !== undefined) {\n        node.siblingIndex = siblingIndex;\n      }\n      workbench.workspace.setExpanded(ctx.path.head, ctx.node, true);\n      m.redraw.sync();\n      workbench.focus(ctx.path.append(node), name.length);\n    }\n  });\n  workbench.commands.registerCommand({\n    id: \"insert-before\",\n    title: \"Insert Before\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      const node = workbench.workspace.new(\"\");\n      node.parent = ctx.node.parent;\n      node.siblingIndex = ctx.node.siblingIndex;\n      m.redraw.sync();\n      const p = ctx.path.clone();\n      p.pop();\n      workbench.focus(p.append(node));\n    }\n  });\n  workbench.commands.registerCommand({\n    id: \"insert\",\n    title: \"Insert Node\",\n    action: (ctx: Context, name: string = \"\") => {\n      if (!ctx.node) return;\n      const node = workbench.workspace.new(name);\n      node.parent = ctx.node.parent;\n      node.siblingIndex = ctx.node.siblingIndex + 1;\n      m.redraw.sync();\n      const p = ctx.path.clone();\n      p.pop();\n      workbench.focus(p.append(node));\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"insert\", key: \"shift+enter\" });\n  workbench.commands.registerCommand({\n    id: \"create-reference\",\n    title: \"Create Reference\",\n    action: (ctx: Context) => {\n      // TODO: prevent creating reference to reference\n      if (!ctx.node) return;\n      const node = workbench.workspace.new(\"\");\n      node.parent = ctx.node.parent;\n      node.siblingIndex = ctx.node.siblingIndex + 1;\n      node.refTo = ctx.node;\n      m.redraw.sync();\n      const p = ctx.path.clone();\n      p.pop();\n      workbench.focus(p.append(node));\n    }\n  });\n  workbench.commands.registerCommand({\n    id: \"delete\",\n    title: \"Delete node\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      if (ctx.node.id.startsWith(\"@\")) return;\n      const above = workbench.workspace.findAbove(ctx.path);\n      ctx.node.destroy();\n      m.redraw.sync();\n      if (above) {\n        let pos = 0;\n        if (ctx.event && ctx.event.key === \"Backspace\") {\n          pos = above.node.name.length;\n        }\n        if (above.node.childCount === 0) {\n          // TODO: use subCount\n          workbench.workspace.setExpanded(ctx.path.head, above.node, false);\n        }\n        workbench.focus(above, pos);\n      }\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"delete\", key: \"shift+meta+backspace\" });\n  workbench.commands.registerCommand({\n    id: \"prev\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      const above = workbench.workspace.findAbove(ctx.path);\n      if (above) {\n        workbench.focus(above);\n      }\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"prev\", key: \"arrowup\" });\n  workbench.commands.registerCommand({\n    id: \"next\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      const below = workbench.workspace.findBelow(ctx.path);\n      if (below) {\n        workbench.focus(below);\n      }\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"next\", key: \"arrowdown\" });\n  workbench.commands.registerCommand({\n    id: \"pick-command\",\n    action: (ctx: Context) => {\n      let node = ctx.node;\n      let path = ctx.path;\n      let posBelow = false;\n      if (!node) {\n        node = ctx.path.head;\n        path = new Path(ctx.path.head, ctx.path.name);\n        posBelow = true;\n      }\n      const trigger = workbench.getInput(path);\n      const rect = trigger.getBoundingClientRect();\n      let x = document.body.scrollLeft + rect.x + (trigger.selectionStart * 10) + 20;\n      let y = document.body.scrollTop + rect.y - 8;\n      if (posBelow) {\n        x = document.body.scrollLeft + rect.x;\n        y = document.body.scrollTop + rect.y + rect.height;\n      }\n      workbench.showPalette(x, y, workbench.newContext({ node }));\n    }\n  });\n  workbench.keybindings.registerBinding({ command: \"pick-command\", key: \"meta+k\" });\n  workbench.commands.registerCommand({\n    id: \"new-panel\",\n    title: \"Open in New Panel\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      workbench.openNewPanel(ctx.node);\n      m.redraw();\n    }\n  });\n  workbench.commands.registerCommand({\n    id: \"close-panel\",\n    title: \"Close Panel\",\n    action: (ctx: Context, panel?: Path) => {\n      workbench.closePanel(panel || ctx.path);\n      workbench.context.path = workbench.mainPanel;\n      m.redraw();\n    }\n  });\n  workbench.commands.registerCommand({\n    id: \"zoom\",\n    title: \"Open\",\n    action: (ctx: Context) => {\n      workbench.workspace.lastOpenedID = ctx.node.id;\n      workbench.workspace.save();\n      workbench.context.path = ctx.path.append(ctx.node);\n      workbench.panels[0] = workbench.context.path;\n      m.redraw();\n    }\n  });\n  workbench.commands.registerCommand({\n    id: \"generate-random\",\n    title: \"Generate Random Children\",\n    action: (ctx: Context) => {\n      if (!ctx.node) return;\n      [...Array(100)].forEach(() => {\n        const node = workbench.workspace.new(generateName(8));\n        node.parent = ctx.node;\n      });\n    }\n  });\n\n\n  workbench.menus.registerMenu(\"node\", [\n    { command: \"zoom\" },\n    { command: \"new-panel\" },\n    { command: \"indent\" },\n    { command: \"outdent\" },\n    { command: \"move-up\" },\n    { command: \"move-down\" },\n    { command: \"delete\" },\n    // {command: \"add-checkbox\"}, \n    // {command: \"remove-checkbox\"},\n    // {command: \"mark-done\"},\n    // {command: \"add-page\"},\n    // {command: \"remove-page\"},\n    // {command: \"generate-random\"},\n    // {command: \"create-reference\"},\n  ]);\n\n  workbench.menus.registerMenu(\"settings\", [\n    { title: () => `${workbench.backend.auth?.currentUser()?.userID()} @ GitHub`, disabled: true, when: () => workbench.authenticated() },\n    {\n      title: () => \"Login with GitHub\", when: () => !workbench.authenticated(), onclick: () => {\n        if (!localStorage.getItem(\"github\")) {\n          workbench.showNotice(\"github\", () => {\n            workbench.backend.auth.login()\n          })\n        } else {\n          workbench.backend.auth.login()\n        }\n      }\n    },\n    {\n      title: () => \"Reset Demo\", when: () => !workbench.authenticated(), onclick: () => {\n        localStorage.clear();\n        location.reload();\n      }\n    },\n    { title: () => \"Submit Issue\", onclick: () => window.open(\"https://github.com/treehousedev/treehouse/issues\", \"_blank\") },\n    { title: () => \"Logout\", when: () => workbench.authenticated(), onclick: () => workbench.backend.auth.logout() },\n  ]);\n\n  document.addEventListener(\"keydown\", (e) => {\n    const binding = workbench.keybindings.evaluateEvent(e);\n    if (binding) {\n      workbench.executeCommand(binding.command, workbench.context);\n      e.stopPropagation();\n      e.preventDefault();\n      return;\n    }\n\n    // TODO: find a better way to do this?\n    if (e.key === \"Escape\") {\n      if (workbench.curtain && workbench.curtain.onclick) {\n        workbench.curtain.onclick(e);\n      }\n    }\n  });\n\n\n  m.mount(target, { view: () => m(App, { workbench }) });\n}\n\n\n\nfunction generateName(length = 10) {\n  const random = (min: any, max: any) => {\n    return Math.round(Math.random() * (max - min) + min)\n  };\n  const word = () => {\n    const words = [\n      'got',\n      'ability',\n      'shop',\n      'recall',\n      'fruit',\n      'easy',\n      'dirty',\n      'giant',\n      'shaking',\n      'ground',\n      'weather',\n      'lesson',\n      'almost',\n      'square',\n      'forward',\n      'bend',\n      'cold',\n      'broken',\n      'distant',\n      'adjective'\n    ];\n    return words[random(0, words.length - 1)];\n  };\n  const words = (length) => (\n    [...Array(length)]\n      .map((_, i) => word())\n      .join(' ')\n      .trim()\n  );\n  return words(random(2, length))\n}\n"],
  "mappings": "gQACA,IAAMA,GAAS,UAAU,UAAU,YAAY,EAAE,QAAQ,KAAK,IAAM,GAE7D,SAASC,GAAeC,EAAwB,CACrD,GAAI,CAACA,EAAK,MAAO,CAAC,EAClB,IAAMC,EAAU,CACd,UAAa,SACb,MAAS,SACT,KAAQ,SACR,IAAO,SACP,KAAQ,SACR,QAAW,SACX,UAAa,SACb,UAAa,SACb,WAAc,SACd,MAAS,QACX,EAEA,OADaD,EAAI,YAAY,EAAE,MAAM,GAAG,EAC5B,IAAIE,EAAsB,EAAE,IAAIC,GAAM,OAAO,KAAKF,CAAO,EAAE,SAASE,CAAC,EAAKF,EAAQE,CAAC,EAAIA,CAAC,CACtG,CAhBgBC,EAAAL,GAAA,kBAoBhB,SAASG,GAAuBF,EAAqB,CACnD,MAAQ,CAACF,IAASE,IAAQ,OAAU,OAAQA,CAC9C,CAFSI,EAAAF,GAAA,0BAWF,IAAMG,EAAN,KAAkB,CAGvB,aAAc,CACZ,KAAK,SAAW,CAAC,CACnB,CAEA,gBAAgBC,EAAkB,CAChC,KAAK,SAAS,KAAKA,CAAO,CAC5B,CAEA,WAAWC,EAAiC,CAC1C,QAAWC,KAAK,KAAK,SACnB,GAAIA,EAAE,UAAYD,EAChB,OAAOC,EAGX,OAAO,IACT,CAEA,cAAcC,EAAoC,CAChDC,EAAU,QAAWF,KAAK,KAAK,SAAU,CACvC,IAAIG,EAAYH,EAAE,IAAI,YAAY,EAAE,MAAM,GAAG,EAE7C,GADUG,EAAU,IAAI,IACZF,EAAM,IAAI,YAAY,EAGlC,SAAWG,IAAY,CAAC,QAAS,OAAQ,MAAO,MAAM,EAAG,CACvD,IAAIC,EAASF,EAAU,SAASC,CAAQ,EACxC,GAAI,CAACd,GAAO,CACV,GAAIc,IAAa,OAAQ,SACrBA,IAAa,SACfC,EAASF,EAAU,SAAS,MAAM,GAAKA,EAAU,SAAS,MAAM,EAEpE,CAEA,IAAMG,EAAWL,EAAM,GAAGP,GAAuBU,CAAQ,MAAM,EAI/D,GAHI,CAACE,GAAYD,GAGbC,GAAY,CAACD,EACf,SAASH,CAEb,CACA,OAAOF,EACT,CACA,OAAO,IACT,CACF,EAhDaJ,EAAAC,EAAA,eCzBN,IAAMU,EAAN,KAAsB,CAG3B,aAAc,CACZ,KAAK,SAAW,CAAC,CACnB,CAEA,gBAAgBC,EAAc,CAC5B,KAAK,SAASA,EAAI,EAAE,EAAIA,CAC1B,CAEA,eAAkBC,KAAeC,EAAuB,CACtD,OAAO,IAAI,QAASC,GAAY,CAC9B,IAAMC,EAAM,KAAK,SAASH,CAAE,EAAE,OAAO,GAAGC,CAAI,EAC5CC,EAAQC,CAAG,CACb,CAAC,CACH,CACF,EAjBaC,EAAAN,EAAA,mBCGN,IAAMO,EAAN,KAAmB,CAGxB,aAAc,CACZ,KAAK,MAAQ,CAAC,CAChB,CAEA,aAAaC,EAAYC,EAAmB,CAC1C,KAAK,MAAMD,CAAE,EAAIC,CACnB,CACF,EAVaC,EAAAH,EAAA,gBCKN,IAAMI,EAAN,KAAgB,CAiBrB,YAAYC,EAAkB,CAC5B,KAAK,SAAW,IAAIC,EACpB,KAAK,YAAc,IAAIC,EACvB,KAAK,MAAQ,IAAIC,EAEjB,KAAK,QAAUH,EACf,KAAK,UAAY,IAAII,EAAUJ,EAAQ,KAAK,EAE5C,KAAK,QAAU,CAAC,KAAM,IAAI,EAC1B,KAAK,OAAS,CAAC,CAEjB,CAEA,IAAI,WAAkB,CACpB,OAAO,KAAK,OAAO,CAAC,CACtB,CAEA,MAAM,YAAa,CACjB,MAAM,KAAK,UAAU,KAAK,EAE1B,KAAK,UAAU,SAAS,QAAQK,GAAK,KAAK,QAAQ,MAAM,MAAMA,CAAC,CAAC,EAChE,KAAK,UAAU,QAASA,GAAK,CAC3B,KAAK,UAAU,KAAK,EAChBA,EAAE,YACJ,KAAK,QAAQ,MAAM,OAAOA,EAAE,EAAE,GAE9B,KAAK,QAAQ,MAAM,MAAMA,EAAE,GAAG,EAC9BA,EAAE,WAAW,QAAQC,GAAO,KAAK,QAAQ,MAAM,MAAMA,EAAI,GAAG,CAAC,EAEjE,CAAE,EAGE,KAAK,UAAU,aACjB,KAAK,aAAa,KAAK,UAAU,KAAK,KAAK,UAAU,YAAY,GAAK,KAAK,UAAU,SAAS,CAAC,EAE/F,KAAK,aAAa,KAAK,UAAU,SAAS,CAAC,EAGzC,KAAK,QAAQ,gBACf,MAAM,KAAK,QAAQ,eAAe,EAGpC,EAAE,OAAO,EAGJ,aAAa,QAAQ,WAAW,GACnC,KAAK,WAAW,WAAW,CAG/B,CAEA,eAAyB,CACvB,OAAO,KAAK,QAAQ,MAAQ,KAAK,QAAQ,KAAK,YAAY,CAC5D,CAEA,eAAgB,CACd,KAAK,SAAW,KAChB,EAAE,OAAO,CACX,CAEA,cAAe,CACb,IAAIC,EAAO,KAAK,UAAU,KAAK,WAAW,EACrCA,IACHA,EAAO,KAAK,UAAU,IAAI,WAAW,GAEvC,KAAK,SAAWA,CAClB,CAEA,gBAAiB,CACf,IAAMA,EAAO,KAAK,UAAU,KAAK,WAAW,EAC5C,GAAI,CAACA,EAAM,OACX,IAAMC,EAAQ,KAAK,UAAU,EAC7BD,EAAK,SAAS,QAAQ,GAAK,EAAE,OAASC,CAAK,CAC7C,CAEA,eAAgB,CACd,IAAMD,EAAO,KAAK,UAAU,KAAK,WAAW,EACvCA,GACLA,EAAK,SAAS,QAAQF,GAAKA,EAAE,QAAQ,CAAC,CACxC,CAGA,WAAkB,CAChB,IAAMG,EAAQ,IAAI,KACZC,EAAUD,EAAM,YAAY,EAAE,MAAMA,EAAM,YAAY,CAAC,EAAE,CAAC,EAC1DE,EAAW,QAAQ,OAAOC,GAAcH,CAAK,CAAC,EAAE,SAAS,EAAG,GAAG,IAE/DI,EAAY,CAAC,aAAc,WADhB,GAAGJ,EAAM,YAAY,IACiBE,EAAUD,CAAO,EAAE,KAAK,GAAG,EAC9EI,EAAY,KAAK,UAAU,KAAKD,CAAS,EAC7C,OAAKC,IACHA,EAAY,KAAK,UAAU,IAAID,CAAS,GAEnCC,CACT,CAEA,WAAY,CACV,KAAK,KAAK,KAAK,UAAU,CAAC,CAC5B,CAEA,KAAKR,EAAS,CAEP,KAAK,UAAU,SAASA,EAAE,EAAE,IAC/B,KAAK,UAAU,SAASA,EAAE,EAAE,EAAI,CAAC,GAGnC,KAAK,UAAU,aAAeA,EAAE,GAChC,KAAK,UAAU,KAAK,EACpB,IAAMS,EAAI,IAAIC,EAAKV,CAAC,EACpB,KAAK,OAAO,CAAC,EAAIS,EACjB,KAAK,QAAQ,KAAOA,CACtB,CAEA,aAAaT,EAAS,CAEf,KAAK,UAAU,SAASA,EAAE,EAAE,IAC/B,KAAK,UAAU,SAASA,EAAE,EAAE,EAAI,CAAC,GAGnC,KAAK,UAAU,aAAeA,EAAE,GAChC,KAAK,UAAU,KAAK,EACpB,IAAMS,EAAI,IAAIC,EAAKV,CAAC,EACpB,KAAK,OAAO,KAAKS,CAAC,EAClB,KAAK,QAAQ,KAAOA,CACtB,CAEA,WAAWE,EAAa,CACtB,KAAK,OAAS,KAAK,OAAO,OAAOF,GAAKA,EAAE,OAASE,EAAM,IAAI,CAC7D,CAEA,SAAU,CACR,KAAK,QAAQ,KAAO,IACtB,CAEA,MAAMC,EAAYC,EAAe,EAAG,CAClC,IAAMC,EAAQ,KAAK,SAASF,CAAI,EAC5BE,GACF,KAAK,QAAQ,KAAOF,EACpBE,EAAM,MAAM,EACRD,IAAQ,QACVC,EAAM,kBAAkBD,EAAIA,CAAG,GAGjC,QAAQ,KAAK,2BAA4BD,CAAI,CAEjD,CAEA,SAASA,EAAyB,CAChC,IAAIG,EAAK,SAASH,EAAK,MAAMA,EAAK,KAAK,KAEvC,OAAIA,EAAK,KAAK,IAAI,MAAQ,WACxBG,EAAKA,EAAG,UAEH,SAAS,eAAeA,CAAE,CACnC,CAEA,eAAkBA,EAAYC,KAAaC,EAAuB,CAChE,OAAAD,EAAM,KAAK,WAAWA,CAAG,EACzB,QAAQ,IAAID,EAAIC,EAAK,GAAGC,CAAI,EACrB,KAAK,SAAS,eAAeF,EAAI,KAAK,WAAWC,CAAG,EAAG,GAAGC,CAAI,CACvE,CAEA,WAAWD,EAAmB,CAC5B,OAAO,OAAO,OAAO,CAAC,EAAG,KAAK,QAASA,CAAG,CAC5C,CAEA,SAASE,EAAcF,EAAU,CAC/BE,EAAM,gBAAgB,EACtBA,EAAM,eAAe,EACrB,IAAMC,EAAUD,EAAM,OAAO,QAAQ,cAAc,EAC7CE,EAAOD,EAAQ,sBAAsB,EACrCE,EAAQF,EAAQ,QAAQ,OAAY,OACtCG,EAAI,SAAS,KAAK,WAAWF,EAAK,EAClCC,IAAU,UACZC,EAAI,SAAS,KAAK,YAAcF,EAAK,OAEvC,IAAMG,EAAI,SAAS,KAAK,UAAUH,EAAK,EAAEA,EAAK,OACxCI,EAAQ,KAAK,MAAM,MAAML,EAAQ,QAAQ,IAAO,EAChDM,EAAOD,EAAM,OAAOE,GAAKA,EAAE,OAAO,EAAE,IAAIA,GAAK,KAAK,SAAS,SAASA,EAAE,OAAO,CAAC,EAC/EF,IACL,KAAK,KAAO,CAAC,EAAAF,EAAG,EAAAC,EACd,IAAK,KAAK,WAAWP,CAAG,EACxB,MAAOQ,EACP,SAAUC,EACV,MAAOJ,CACT,EACA,KAAK,QAAU,CACb,QAAS,GACT,QAAS,IAAM,KAAK,SAAS,CAC/B,EACA,EAAE,OAAO,EACX,CAEA,UAAW,CACT,KAAK,KAAO,KACZ,KAAK,QAAU,KACf,EAAE,OAAO,CACX,CAEA,YAAYC,EAAWC,EAAWP,EAAc,CAC9C,KAAK,QAAU,CAAC,EAAAM,EAAG,EAAAC,EAAG,IAAKP,CAAG,EAC9B,KAAK,QAAU,CACb,QAAS,GACT,QAAS,IAAM,KAAK,YAAY,CAClC,EACA,EAAE,OAAO,CACX,CAEA,aAAc,CACZ,KAAK,QAAU,KACf,KAAK,QAAU,KACf,EAAE,OAAO,CACX,CAEA,WAAWW,EAASC,EAAU,CAC5B,KAAK,OAAS,CAAC,QAAAD,EAAS,SAAAC,CAAQ,EAChC,EAAE,OAAO,CACX,CAEA,YAAa,CACX,KAAK,OAAS,KACd,EAAE,OAAO,CACX,CAGF,EAjPaC,EAAAnC,EAAA,aAoPb,SAASY,GAAcwB,EAAM,CAC3B,IAAIC,EAAI,IAAI,KAAK,KAAK,IAAID,EAAK,YAAY,EAAGA,EAAK,SAAS,EAAGA,EAAK,QAAQ,CAAC,CAAC,EAC1EE,EAASD,EAAE,UAAU,GAAK,EAC9BA,EAAE,WAAWA,EAAE,WAAW,EAAI,EAAIC,CAAM,EACxC,IAAIC,EAAY,IAAI,KAAK,KAAK,IAAIF,EAAE,eAAe,EAAE,EAAE,CAAC,CAAC,EACzD,OAAO,KAAK,OAAQA,EAAIE,GAAa,MAAY,GAAG,CAAC,CACvD,CANSJ,EAAAvB,GAAA,iBChQF,SAAS4B,GAAKC,EAAK,CACxB,SAASC,EAAYC,EAAEC,EAAG,CAC1B,IAAIC,EAAOF,GAAGC,EAAOD,IAAK,GAAGC,EAC7B,OAAOC,CACP,CAHSC,EAAAJ,EAAA,eAIT,SAASK,EAAQC,EAAK,CACtB,IAAIC,EAAI,GACJC,EACAC,EACAC,GACJ,IAAKF,EAAE,EAAGA,GAAG,EAAGA,GAAG,EACnBC,EAAMH,IAAOE,EAAE,EAAE,EAAI,GACrBE,GAAMJ,IAAOE,EAAE,EAAI,GACnBD,GAAOE,EAAG,SAAS,EAAE,EAAIC,GAAG,SAAS,EAAE,EAEvC,OAAOH,CACP,CAXSH,EAAAC,EAAA,WAYT,SAASM,EAAQL,EAAK,CACtB,IAAIC,EAAI,GACJC,EACAI,EACJ,IAAKJ,EAAE,EAAGA,GAAG,EAAGA,IAChBI,EAAKN,IAAOE,EAAE,EAAI,GAClBD,GAAOK,EAAE,SAAS,EAAE,EAEpB,OAAOL,CACP,CATSH,EAAAO,EAAA,WAUT,SAASE,EAAWC,EAAQ,CAC5BA,EAASA,EAAO,QAAQ,QAAQ;AAAA,CAAI,EAEpC,QADIC,EAAU,GACLd,EAAI,EAAGA,EAAIa,EAAO,OAAQb,IAAK,CACxC,IAAIe,EAAIF,EAAO,WAAWb,CAAC,EACvBe,EAAI,IACRD,GAAW,OAAO,aAAaC,CAAC,EAEvBA,EAAI,KAASA,EAAI,MAC1BD,GAAW,OAAO,aAAcC,GAAK,EAAK,GAAG,EAC7CD,GAAW,OAAO,aAAcC,EAAI,GAAM,GAAG,IAG7CD,GAAW,OAAO,aAAcC,GAAK,GAAM,GAAG,EAC9CD,GAAW,OAAO,aAAeC,GAAK,EAAK,GAAM,GAAG,EACpDD,GAAW,OAAO,aAAcC,EAAI,GAAM,GAAG,EAE7C,CACA,OAAOD,CACP,CAnBSX,EAAAS,EAAA,cAoBT,IAAII,EACAT,EAAGU,EACHC,EAAI,IAAI,MAAM,EAAE,EAChBC,EAAK,WACLC,EAAK,WACLC,EAAK,WACLC,EAAK,UACLC,EAAK,WACLC,EAAGC,EAAGC,EAAGC,EAAGC,EACZC,EACJ/B,EAAMc,EAAWd,CAAG,EACpB,IAAIgC,EAAUhC,EAAI,OACdiC,EAAa,IAAI,MACrB,IAAKxB,EAAE,EAAGA,EAAEuB,EAAQ,EAAGvB,GAAG,EAC1BU,EAAInB,EAAI,WAAWS,CAAC,GAAG,GAAKT,EAAI,WAAWS,EAAE,CAAC,GAAG,GACjDT,EAAI,WAAWS,EAAE,CAAC,GAAG,EAAIT,EAAI,WAAWS,EAAE,CAAC,EAC3CwB,EAAW,KAAMd,CAAE,EAEnB,OAAQa,EAAU,EAAI,CACtB,IAAK,GACLvB,EAAI,WACJ,MACA,IAAK,GACLA,EAAIT,EAAI,WAAWgC,EAAQ,CAAC,GAAG,GAAK,QACpC,MACA,IAAK,GACLvB,EAAIT,EAAI,WAAWgC,EAAQ,CAAC,GAAG,GAAKhC,EAAI,WAAWgC,EAAQ,CAAC,GAAG,GAAK,MACpE,MACA,IAAK,GACLvB,EAAIT,EAAI,WAAWgC,EAAQ,CAAC,GAAG,GAAKhC,EAAI,WAAWgC,EAAQ,CAAC,GAAG,GAAKhC,EAAI,WAAWgC,EAAQ,CAAC,GAAG,EAAI,IACnG,KACA,CAEA,IADAC,EAAW,KAAMxB,CAAE,EACXwB,EAAW,OAAS,IAAO,IAAKA,EAAW,KAAM,CAAE,EAG3D,IAFAA,EAAW,KAAMD,IAAU,EAAG,EAC9BC,EAAW,KAAOD,GAAS,EAAG,UAAY,EACpCd,EAAW,EAAGA,EAAWe,EAAW,OAAQf,GAAY,GAAK,CACnE,IAAKT,EAAE,EAAGA,EAAE,GAAIA,IAAMW,EAAEX,CAAC,EAAIwB,EAAWf,EAAWT,CAAC,EACpD,IAAKA,EAAE,GAAIA,GAAG,GAAIA,IAAMW,EAAEX,CAAC,EAAIR,EAAYmB,EAAEX,EAAE,CAAC,EAAIW,EAAEX,EAAE,CAAC,EAAIW,EAAEX,EAAE,EAAE,EAAIW,EAAEX,EAAE,EAAE,EAAG,CAAC,EAMjF,IALAiB,EAAIL,EACJM,EAAIL,EACJM,EAAIL,EACJM,EAAIL,EACJM,EAAIL,EACChB,EAAG,EAAGA,GAAG,GAAIA,IAClBsB,EAAQ9B,EAAYyB,EAAE,CAAC,GAAMC,EAAEC,EAAM,CAACD,EAAEE,GAAMC,EAAIV,EAAEX,CAAC,EAAI,WAAc,WACvEqB,EAAID,EACJA,EAAID,EACJA,EAAI3B,EAAY0B,EAAE,EAAE,EACpBA,EAAID,EACJA,EAAIK,EAEJ,IAAKtB,EAAE,GAAIA,GAAG,GAAIA,IAClBsB,EAAQ9B,EAAYyB,EAAE,CAAC,GAAKC,EAAIC,EAAIC,GAAKC,EAAIV,EAAEX,CAAC,EAAI,WAAc,WAClEqB,EAAID,EACJA,EAAID,EACJA,EAAI3B,EAAY0B,EAAE,EAAE,EACpBA,EAAID,EACJA,EAAIK,EAEJ,IAAKtB,EAAE,GAAIA,GAAG,GAAIA,IAClBsB,EAAQ9B,EAAYyB,EAAE,CAAC,GAAMC,EAAEC,EAAMD,EAAEE,EAAMD,EAAEC,GAAMC,EAAIV,EAAEX,CAAC,EAAI,WAAc,WAC9EqB,EAAID,EACJA,EAAID,EACJA,EAAI3B,EAAY0B,EAAE,EAAE,EACpBA,EAAID,EACJA,EAAIK,EAEJ,IAAKtB,EAAE,GAAIA,GAAG,GAAIA,IAClBsB,EAAQ9B,EAAYyB,EAAE,CAAC,GAAKC,EAAIC,EAAIC,GAAKC,EAAIV,EAAEX,CAAC,EAAI,WAAc,WAClEqB,EAAID,EACJA,EAAID,EACJA,EAAI3B,EAAY0B,EAAE,EAAE,EACpBA,EAAID,EACJA,EAAIK,EAEJV,EAAMA,EAAKK,EAAK,WAChBJ,EAAMA,EAAKK,EAAK,WAChBJ,EAAMA,EAAKK,EAAK,WAChBJ,EAAMA,EAAKK,EAAK,WAChBJ,EAAMA,EAAKK,EAAK,UAChB,CACA,IAAIC,EAAOnB,EAAQS,CAAE,EAAIT,EAAQU,CAAE,EAAIV,EAAQW,CAAE,EAAIX,EAAQY,CAAE,EAAIZ,EAAQa,CAAE,EAE7E,OAAOM,EAAK,YAAY,CACzB,CApIe1B,EAAAN,GAAA,QCIT,IAAMmC,EAAN,KAAW,CAIhB,YAAYC,EAAaC,EAAe,CAClCA,EACF,KAAK,KAAOA,EAEZ,KAAK,KAAO,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,EAEhDD,EACF,KAAK,MAAQ,CAACA,CAAI,EAElB,KAAK,MAAQ,CAAC,CAElB,CAEA,KAAKE,EAAY,CACf,KAAK,MAAM,KAAKA,CAAI,CACtB,CAEA,KAAiB,CACf,OAAO,KAAK,MAAM,IAAI,GAAK,IAC7B,CAEA,KAAY,CACV,OAAO,IAAIH,EAAK,KAAK,KAAM,KAAK,IAAI,CACtC,CAEA,OAAc,CACZ,IAAMI,EAAI,IAAIJ,EACd,OAAAI,EAAE,KAAO,KAAK,KACdA,EAAE,MAAQ,CAAC,GAAG,KAAK,KAAK,EACjBA,CACT,CAEA,OAAOD,EAAkB,CACvB,IAAMC,EAAI,KAAK,MAAM,EACrB,OAAAA,EAAE,KAAKD,CAAI,EACJC,CACT,CAEA,IAAI,QAAiB,CACnB,OAAO,KAAK,MAAM,MACpB,CAEA,IAAI,IAAa,CACf,OAAOC,GAAK,CAAC,KAAK,KAAM,GAAG,KAAK,MAAM,IAAIC,GAAKA,EAAE,EAAE,CAAC,EAAE,KAAK,GAAG,CAAC,CACjE,CAEA,IAAI,MAAa,CACf,OAAO,KAAK,MAAM,KAAK,MAAM,OAAO,CAAC,CACvC,CAEA,IAAI,UAAsB,CACxB,OAAI,KAAK,MAAM,OAAS,EAAU,KAC3B,KAAK,MAAM,KAAK,MAAM,OAAO,CAAC,CACvC,CAEA,IAAI,MAAa,CACf,OAAO,KAAK,MAAM,CAAC,CACrB,CACF,EA9DaC,EAAAP,EAAA,QCDb,IAAMQ,GAAgC,CAAC,EAEhC,SAASC,EAAUC,EAAa,CACrCF,GAASG,EAAcD,CAAM,CAAC,EAAIA,CACpC,CAFgBE,EAAAH,EAAA,aAIT,SAASE,EAAcD,EAAqB,CACjD,OAAIA,EAAO,YAAc,SACvBA,EAASA,EAAO,aAEX,aAAaA,EAAO,MAC7B,CALgBE,EAAAD,EAAA,iBAOT,SAASE,GAAaC,EAAe,CAC1C,OAAI,OAAOA,GAAQ,SACVN,GAASM,CAAG,EAEdN,GAASG,EAAcG,CAAG,CAAC,CACpC,CALgBF,EAAAC,GAAA,gBAOT,SAASE,GAAmBD,EAAUE,EAAe,CAC1D,IAAMC,EAAI,IAAKJ,GAAaC,CAAG,GAC/B,OAAIG,EAAE,oBAAuB,SAC3BA,EAAE,SAASD,CAAG,EAEd,OAAO,iBAAiBC,EAAG,OAAO,0BAA0BD,CAAG,CAAC,EAE3DC,CACT,CARgBL,EAAAG,GAAA,sBCTT,SAASG,EAAQC,EAAYC,EAAuB,CACzD,OAAOD,EAAK,OAASA,EAAK,MAAMC,CAAI,YAAa,QACnD,CAFgBC,EAAAH,EAAA,WAIT,SAASI,EAAYH,EAAYC,KAAiBG,EAAkB,CACzE,GAAIL,EAAQC,EAAMC,CAAI,EACpB,OAAOD,EAAK,MAAMC,CAAI,EAAE,MAAMD,EAAK,MAAOI,CAAI,CAElD,CAJgBF,EAAAC,EAAA,eAMT,SAASE,EAAUC,EAAWL,EAAuB,CAC1D,QAAWM,KAAOD,EAAI,WACpB,GAAIP,EAAQQ,EAAKN,CAAI,EAAG,MAAO,GAEjC,MAAO,EACT,CALgBC,EAAAG,EAAA,aAOT,SAASG,EAAWF,EAAWL,KAAiBG,EAAkB,CACvE,QAAWG,KAAOD,EAAI,WACpB,GAAIP,EAAQQ,EAAKN,CAAI,EACnB,OAAOM,EAAI,MAAMN,CAAI,EAAE,MAAMM,EAAI,MAAOH,CAAI,CAGlD,CANgBF,EAAAM,EAAA,cC/BT,IAAMC,EAAN,KAAU,CAIf,aAAc,CACZ,KAAK,MAAQ,CAAC,QAAS,CACrB,GAAI,QACJ,KAAM,QACN,OAAQ,CAAC,SAAU,CAAC,EAAG,WAAY,CAAC,CAAC,EACrC,MAAO,CAAC,CACV,CAAC,EACD,KAAK,UAAY,CAAC,CACpB,CAEA,QAAQC,EAAU,CAChB,KAAK,UAAU,QAAQC,GAAMA,EAAGD,CAAC,CAAC,CACpC,CAIA,OAAOE,EAAkB,CACvB,QAAWF,KAAKE,EACVF,EAAE,OAASG,GAAaH,EAAE,IAAI,IAChCA,EAAE,MAAQI,GAAmBJ,EAAE,KAAMA,EAAE,KAAK,EAC5CA,EAAE,IAAM,cAEV,KAAK,MAAMA,EAAE,EAAE,EAAIA,EAErB,QAAWA,KAAKE,EAAO,CAErB,GAAIF,EAAE,SAAW,OAAQ,CACvB,OAAO,KAAK,MAAMA,EAAE,EAAE,EACtB,QACF,CAEA,GAAI,CAACA,EAAE,GAAG,WAAW,GAAG,GAAKA,EAAE,SAAW,OAAW,CACnD,OAAO,KAAK,MAAMA,EAAE,EAAE,EACtB,QACF,CAEA,GAAIA,EAAE,QAAU,CAAC,KAAK,MAAMA,EAAE,MAAM,EAAG,CACrC,OAAO,KAAK,MAAMA,EAAE,EAAE,EACtB,QACF,CACA,IAAMK,EAAO,KAAK,KAAKL,EAAE,EAAE,EAC3B,GAAIK,EAAM,CAER,GAAIA,EAAK,QAAU,CAACA,EAAK,OAAO,IAAK,CACnC,OAAO,KAAK,MAAML,EAAE,EAAE,EACtB,QACF,CAEAM,EAAYD,EAAM,WAAYA,CAAI,CACpC,CACF,CACF,CAEA,QAAoB,CAClB,IAAMH,EAAmB,CAAC,EAC1B,QAAWF,KAAK,OAAO,OAAO,KAAK,KAAK,EACtCE,EAAM,KAAKF,CAAC,EAEd,OAAOE,CACT,CAEA,KAAKK,EAAcC,EAAoB,CACrC,IAAIC,EAAqB,KACzB,GAAIF,EAAK,SAAS,GAAG,EAAG,CACtB,IAAMG,EAAQH,EAAK,MAAM,GAAG,EAC5BE,EAAS,KAAK,KAAKC,EAAM,CAAC,CAAC,EAC3B,QAASC,EAAI,EAAGA,EAAID,EAAM,OAAO,EAAGC,IAAK,CACvC,GAAIF,IAAW,KACb,KAAM,qBAGR,IAAIG,EAAQH,EAAO,KAAKC,EAAMC,CAAC,CAAC,EAC3BC,IACHA,EAAQ,KAAK,KAAKF,EAAM,MAAM,EAAGC,EAAE,CAAC,EAAE,KAAK,GAAG,CAAC,GAEjDF,EAASG,CACX,CACAL,EAAOG,EAAMA,EAAM,OAAO,CAAC,CAC7B,CACA,IAAMG,EAAMN,EAAK,WAAW,GAAG,EAAGA,EAAKO,GAAS,EAChD,KAAK,MAAMD,CAAE,EAAI,CACf,GAAIA,EACJ,KAAMN,EACN,MAAOC,EACP,OAAQ,CAAC,SAAU,CAAC,EAAG,WAAY,CAAC,CAAC,EACrC,MAAO,CAAC,CACV,EACA,IAAMH,EAAO,IAAIU,EAAK,KAAMF,CAAE,EAC9B,OAAIJ,IACFJ,EAAK,OAASI,GAETJ,CACT,CAGA,QAAQL,EAAU,CAChB,IAAMgB,EAAIhB,EAAE,OACZ,GAAIgB,IAAM,MAAQ,CAACA,EAAE,YAAa,CAChC,IAAIC,EAAMjB,EAAE,IAAI,KAAO,WACnBgB,EAAE,IAAI,OAAOC,CAAG,EAAE,SAASjB,EAAE,EAAE,GACjCgB,EAAE,IAAI,OAAOC,CAAG,EAAE,OAAOjB,EAAE,aAAc,CAAC,CAE9C,CACA,OAAO,KAAK,MAAMA,EAAE,EAAE,EAClBgB,GACF,KAAK,QAAQA,CAAC,CAElB,CAEA,OAAiB,CACf,OAAO,OAAO,OAAO,KAAK,KAAK,EAAE,OAAOhB,GAAKA,EAAE,SAAW,MAAS,EAAE,IAAIA,GAAK,IAAIe,EAAK,KAAMf,EAAE,EAAE,CAAC,CACpG,CAEA,KAAKO,EAA2B,CAC9BA,EAAOA,GAAQ,QACf,IAAMF,EAAO,KAAK,MAAM,EAAE,KAAKa,GAAQA,EAAK,OAASX,CAAI,EACzD,OAAIF,IAAS,OAAkB,KACxBA,CACT,CAEA,KAAKc,EAAyB,CAC5B,IAAMC,EAAO,KAAK,MAAMD,CAAI,EAC5B,GAAIC,EAAM,OAAO,IAAIL,EAAK,KAAMK,EAAK,EAAE,EACvC,IAAMV,EAAQS,EAAK,MAAM,GAAG,EAC5B,GAAIT,EAAM,SAAW,GAAKA,EAAM,CAAC,EAAE,WAAW,GAAG,EAE/C,OAAO,KAET,IAAIW,EAAM,KAAK,KAAKX,EAAM,CAAC,CAAC,EAS5B,GARI,CAACW,GAAO,KAAK,MAAMX,EAAM,CAAC,CAAC,IAC7BW,EAAM,IAAIN,EAAK,KAAM,KAAK,MAAML,EAAM,CAAC,CAAC,EAAE,EAAE,GAE1CW,EACFX,EAAM,MAAM,EAEZW,EAAM,KAAK,KAAK,OAAO,EAErB,CAACA,EACH,OAAO,KAET,IAAMC,EAAYC,EAAA,CAACvB,EAAUO,KACvBP,EAAE,QACJA,EAAIA,EAAE,OAEDA,EAAE,SAAS,KAAKY,GAASA,EAAM,OAASL,CAAI,GAJnC,aAMlB,QAAWA,KAAQG,EAAO,CACxB,IAAME,EAAQU,EAAUD,EAAKd,CAAI,EACjC,GAAI,CAACK,EAAO,OAAO,KACnBS,EAAMT,CACR,CACA,OAAOS,CACT,CAEA,KAAKG,EAAcC,EAAoB,CACrC,QAAWP,KAAQ,KAAK,MAAM,EAC5B,GAAIA,EAAK,KAAKM,EAAIC,CAAI,EAAG,MAE7B,CAEA,QAAQD,EAAkB,CACxB,KAAK,UAAU,KAAKA,CAAE,CACxB,CACF,EAvKaD,EAAAxB,EAAA,OAyKb,IAAMe,GAAWS,EAAA,IAAM,CACrB,IAAMG,EAAa,KAAK,IAAI,EAAE,SAAS,EAAE,EACnCC,EAAa,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,EACzD,OAAOD,EAAaC,CACtB,EAJiB,YCzKV,IAAMC,EAAN,KAAW,CAIhB,YAAYC,EAAUC,EAAY,CAChC,KAAK,KAAOD,EACZ,KAAK,IAAMC,CACb,CAEA,CAAC,OAAO,IAAI,oBAAoB,CAAC,GAAI,CACnC,MAAO,QAAQ,KAAK,MAAM,KAAK,OACjC,CAIA,IAAI,IAAa,CACf,OAAO,KAAK,GACd,CAEA,IAAI,KAAY,CACd,OAAO,KAAK,IACd,CAEA,IAAI,KAAe,CACjB,IAAMC,EAAM,KAAK,KAAK,MAAM,KAAK,EAAE,EACnC,GAAI,CAACA,EAAK,KAAM,4BAA4B,KAAK,KACjD,OAAOA,CACT,CAGA,IAAI,MAAe,CACjB,OAAI,KAAK,MACA,KAAK,MAAM,KAEb,KAAK,IAAI,IAClB,CAEA,IAAI,KAAKC,EAAa,CAChB,KAAK,MACP,KAAK,MAAM,KAAOA,EAElB,KAAK,IAAI,KAAOA,EAElB,KAAK,QAAQ,CACf,CAEA,IAAI,OAAa,CACf,OAAI,KAAK,MACA,KAAK,MAAM,MAEb,KAAK,IAAI,KAClB,CAEA,IAAI,MAAMA,EAAa,CACjB,KAAK,MACP,KAAK,MAAM,MAAQA,EAEnB,KAAK,IAAI,MAAQA,EAEnB,KAAK,QAAQ,CACf,CAEA,IAAI,QAAqB,CAEvB,MADI,CAAC,KAAK,IAAI,QACV,CAAC,KAAK,KAAK,MAAM,KAAK,IAAI,MAAM,EAAU,KACvC,IAAIJ,EAAK,KAAK,KAAM,KAAK,IAAI,MAAM,CAC5C,CAEA,IAAI,OAAOK,EAAe,CACxB,IAAMC,EAAI,KAAK,OACXA,IAAM,MACRA,EAAE,IAAI,OAAO,SAAS,OAAO,KAAK,aAAc,CAAC,EAE/CD,IAAM,MACR,KAAK,IAAI,OAASA,EAAE,GACpBA,EAAE,IAAI,OAAO,SAAS,KAAK,KAAK,EAAE,EAClCE,EAAYF,EAAG,WAAYA,CAAC,GAE5B,KAAK,IAAI,OAAS,OAEpB,KAAK,QAAQ,CACf,CAEA,IAAI,OAAoB,CACtB,IAAMH,EAAK,KAAK,IAAI,MAAM,MAG1B,MAFI,CAACA,GAED,CADU,KAAK,KAAK,MAAMA,CAAE,EACb,KACZ,IAAIF,EAAK,KAAK,KAAME,CAAE,CAC/B,CAEA,IAAI,MAAMG,EAAe,CACvB,GAAI,CAACA,EAAG,CACN,OAAO,KAAK,IAAI,MAAM,MACtB,KAAK,QAAQ,EACb,MACF,CACA,KAAK,IAAI,MAAM,MAAWA,EAAE,GAC5B,KAAK,QAAQ,CACf,CAEA,IAAI,cAAuB,CACzB,IAAMC,EAAI,KAAK,OACf,GAAIA,IAAM,KAAM,MAAO,GACvB,IAAIE,EAAM,KAAK,IAAI,KAAO,WAC1B,OAAOF,EAAE,IAAI,OAAOE,CAAG,EAAE,UAAUN,GAAMA,IAAO,KAAK,EAAE,CACzD,CAEA,IAAI,aAAaO,EAAW,CAC1B,IAAMH,EAAI,KAAK,OACf,GAAIA,IAAM,KAAM,OAChB,IAAIE,EAAM,KAAK,IAAI,KAAO,WAC1BF,EAAE,IAAI,OAAOE,CAAG,EAAE,OAAO,KAAK,aAAc,CAAC,EAC7CF,EAAE,IAAI,OAAOE,CAAG,EAAE,OAAOC,EAAG,EAAG,KAAK,EAAE,EACtCH,EAAE,QAAQ,CACZ,CAEA,IAAI,aAA0B,CAC5B,IAAMA,EAAI,KAAK,OAEf,GADIA,IAAM,MACN,KAAK,eAAiB,EAAG,OAAO,KACpC,IAAIE,EAAM,KAAK,IAAI,KAAO,WAC1B,OAAOF,EAAE,UAAUE,CAAG,EAAE,KAAK,aAAa,CAAC,CAC7C,CAEA,IAAI,aAA0B,CAC5B,IAAMF,EAAI,KAAK,OAEf,GADIA,IAAM,MACN,KAAK,eAAiBA,EAAE,SAAS,OAAO,EAAG,OAAO,KACtD,IAAIE,EAAM,KAAK,IAAI,KAAO,WAC1B,OAAOF,EAAE,UAAUE,CAAG,EAAE,KAAK,aAAa,CAAC,CAC7C,CAEA,IAAI,WAAqB,CACvB,IAAME,EAAM,CAAC,EACTJ,EAAI,KAAK,OACb,KAAOA,IAAM,MACXI,EAAI,KAAKJ,CAAC,EACVA,EAAIA,EAAE,OAER,OAAOI,CACT,CAEA,IAAI,aAAuB,CACzB,MAAO,CAAC,KAAK,KAAK,MAAM,eAAe,KAAK,EAAE,CAChD,CAEA,IAAI,MAAe,CACjB,IAAIC,EAAkB,KAChBC,EAAO,CAAC,EACd,KAAOD,GACLC,EAAK,QAAQD,EAAI,IAAI,EACrBA,EAAMA,EAAI,OAEZ,OAAOC,EAAK,KAAK,GAAG,CACtB,CAEA,IAAI,UAAoB,CACtB,GAAI,KAAK,MAAO,OAAO,KAAK,MAAM,SAClC,IAAIC,EAAoB,CAAC,EACrB,KAAK,IAAI,OAAO,WAClBA,EAAW,KAAK,IAAI,OAAO,SAAS,IAAIX,GAAM,IAAIF,EAAK,KAAK,KAAME,CAAE,CAAC,GAEvE,QAAWY,KAAO,KAAK,WACrB,GAAIC,EAAQD,EAAK,gBAAgB,EAC/B,OAAOP,EAAYO,EAAK,iBAAkB,KAAMD,CAAQ,EAG5D,OAAOA,CACT,CAEA,IAAI,YAAqB,CACvB,GAAI,KAAK,MAAO,OAAO,KAAK,MAAM,WAClC,QAAWC,KAAO,KAAK,WACrB,GAAIC,EAAQD,EAAK,gBAAgB,EAC/B,OAAOP,EAAYO,EAAK,iBAAkB,KAAM,IAAI,EAAE,OAG1D,OAAK,KAAK,IAAI,OAAO,SACd,KAAK,IAAI,OAAO,SAAS,OADM,CAExC,CAEA,SAASE,EAAa,CACpB,GAAI,KAAK,MAAO,CACd,KAAK,MAAM,SAASA,CAAI,EACxB,MACF,CACA,KAAK,IAAI,OAAO,SAAS,KAAKA,EAAK,EAAE,EACrC,KAAK,QAAQ,CACf,CAEA,YAAYA,EAAa,CACvB,GAAI,KAAK,MAAO,CACd,KAAK,MAAM,YAAYA,CAAI,EAC3B,MACF,CACA,IAAMH,EAAW,KAAK,IAAI,OAAO,SAAS,OAAOX,GAAMA,IAAOc,EAAK,EAAE,EACrE,KAAK,IAAI,OAAO,SAAWH,EAC3B,KAAK,QAAQ,CACf,CAGA,IAAI,YAAsB,CACxB,OAAK,KAAK,IAAI,OAAO,WACd,KAAK,IAAI,OAAO,WAAW,IAAIX,GAAM,IAAIF,EAAK,KAAK,KAAME,CAAE,CAAC,EAD3B,CAAC,CAE3C,CAEA,IAAI,gBAAyB,CAC3B,OAAK,KAAK,IAAI,OAAO,WACd,KAAK,IAAI,OAAO,WAAW,OADM,CAE1C,CAEA,aAAae,EAAU,CACrB,IAAMD,EAAO,KAAK,IAAI,KAAKE,EAAcD,CAAG,EAAGA,CAAG,EAClDD,EAAK,IAAI,OAAS,KAAK,GACvBA,EAAK,IAAI,IAAM,aACf,KAAK,IAAI,OAAO,WAAW,KAAKA,EAAK,EAAE,EACvCT,EAAYS,EAAM,WAAYA,CAAI,EAClC,KAAK,QAAQ,CACf,CAEA,gBAAgBG,EAAW,CACzB,IAAMC,EAAO,KAAK,WAAW,OAAO,GAAK,EAAE,OAASF,EAAcC,CAAI,CAAC,EACnEC,EAAK,OAAS,GAChBA,EAAK,CAAC,EAAE,QAAQ,EAElB,KAAK,QAAQ,CACf,CAEA,aAAaD,EAAoB,CAE/B,OADa,KAAK,WAAW,OAAO,GAAK,EAAE,OAASD,EAAcC,CAAI,CAAC,EAC9D,OAAS,CAIpB,CAEA,aAAaA,EAAqB,CAChC,IAAMC,EAAO,KAAK,WAAW,OAAO,GAAK,EAAE,OAASF,EAAcC,CAAI,CAAC,EACvE,OAAIC,EAAK,OAAS,EACTA,EAAK,CAAC,EAAE,MAEV,IACT,CAIA,UAAUZ,EAAsB,CAC9B,OAAK,KAAK,IAAI,OAAOA,CAAG,EACjB,KAAK,IAAI,OAAOA,CAAG,EAAE,IAAIN,GAAM,IAAIF,EAAK,KAAK,KAAME,CAAE,CAAC,EAD3B,CAAC,CAErC,CAEA,UAAUM,EAAaQ,EAAa,CAC7B,KAAK,IAAI,OAAOR,CAAG,IACtB,KAAK,IAAI,OAAOA,CAAG,EAAI,CAAC,GAE1BQ,EAAK,IAAI,IAAMR,EACf,KAAK,IAAI,OAAOA,CAAG,EAAE,KAAKQ,EAAK,EAAE,EACjC,KAAK,QAAQ,CACf,CAEA,aAAaR,EAAaQ,EAAa,CAChC,KAAK,IAAI,OAAOR,CAAG,IACtB,KAAK,IAAI,OAAOA,CAAG,EAAI,CAAC,GAE1B,IAAMa,EAAS,KAAK,IAAI,OAAOb,CAAG,EAAE,OAAON,GAAMA,IAAOc,EAAK,EAAE,EAC/D,KAAK,IAAI,OAAOR,CAAG,EAAIa,EACvB,KAAK,QAAQ,CACf,CAEA,WAAWb,EAAaQ,EAAaM,EAAa,CAC3C,KAAK,IAAI,OAAOd,CAAG,IACtB,KAAK,IAAI,OAAOA,CAAG,EAAI,CAAC,GAE1B,IAAMe,EAAS,KAAK,IAAI,OAAOf,CAAG,EAAE,UAAUN,GAAMA,IAAOc,EAAK,EAAE,EAClE,GAAIO,IAAW,GAAI,OACnB,IAAMF,EAAS,KAAK,IAAI,OAAOb,CAAG,EAClCa,EAAO,OAAOC,EAAK,EAAGD,EAAO,OAAOE,EAAQ,CAAC,EAAE,CAAC,CAAC,EACjD,KAAK,IAAI,OAAOf,CAAG,EAAIa,EACvB,KAAK,QAAQ,CACf,CAEA,QAAQG,EAAsB,CAC5B,OAAO,KAAK,IAAI,MAAMA,CAAI,GAAK,EACjC,CAEA,QAAQA,EAAcC,EAAe,CACnC,KAAK,IAAI,MAAMD,CAAI,EAAIC,EACvB,KAAK,QAAQ,CACf,CAEA,KAAKb,EAA0B,CAC7B,OAAO,KAAK,IAAI,KAAK,CAAC,KAAK,KAAMA,CAAI,EAAE,KAAK,GAAG,CAAC,CAClD,CAEA,KAAKc,EAAcC,EAA6B,CAK9C,GAJAA,EAAOA,GAAQ,CACb,WAAY,GACZ,kBAAmB,EACrB,EACID,EAAG,IAAI,EACT,MAAO,GAET,IAAIb,EAAW,KAAK,SACpB,GAAI,KAAK,OAASc,EAAK,WAAY,CACjC,GAAID,EAAG,KAAK,KAAK,EACf,MAAO,GAETb,EAAW,KAAK,MAAM,QACxB,CACA,QAAWe,KAASf,EAClB,GAAIe,EAAM,KAAKF,EAAIC,CAAI,EAAG,MAAO,GAEnC,GAAIA,EAAK,mBACP,QAAWb,KAAO,KAAK,WACrB,GAAIA,EAAI,KAAKY,EAAIC,CAAI,EAAG,MAAO,GAGnC,MAAO,EACT,CAEA,SAAU,CACR,GAAI,KAAK,YAAa,OACtB,GAAI,KAAK,MAAO,CACd,KAAK,KAAK,QAAQ,IAAI,EACtB,MACF,CACA,IAAME,EAAiB,CAAC,EACxB,KAAK,KAAMxB,IACTwB,EAAM,KAAKxB,CAAC,EACL,IACN,CACD,WAAY,GACZ,kBAAmB,EACrB,CAAC,EACDwB,EAAM,QAAQ,EAAE,QAAQxB,GAAK,KAAK,KAAK,QAAQA,CAAC,CAAC,CACnD,CAEA,SAAU,CACR,KAAK,KAAK,QAAQ,IAAI,CACxB,CAGF,EAvVayB,EAAA9B,EAAA,QCSN,IAAM+B,EAAN,KAAgB,CAOrB,YAAYC,EAAe,CACzB,KAAK,GAAKA,EACV,KAAK,IAAM,IAAWC,EACtB,KAAK,SAAW,CAAC,EAEjB,KAAK,cAAgBC,GAAS,MAAOC,EAAMC,IAAa,CACtD,GAAI,CACF,MAAM,KAAK,GAAG,UAAUD,EAAMC,CAAQ,EACtC,QAAQ,IAAI,kBAAkB,CAChC,OAASC,EAAP,CACA,QAAQ,MAAMA,CAAC,EACf,SAAS,cAAc,IAAI,YAAY,cAAc,CAAC,CACxD,CACF,CAAC,CACH,CAEA,IAAI,UAAsB,CACxB,OAAO,KAAK,IAAI,OAAO,CACzB,CAEA,QAAQC,EAAuB,CAC7B,KAAK,IAAI,QAAQA,CAAE,CACrB,CAEA,MAAO,CACL,KAAK,cAAc,iBAAkB,KAAK,UAAU,CAClD,QAAS,EACT,SAAU,KAAK,aACf,SAAU,KAAK,SACf,MAAO,KAAK,QACd,EAAG,KAAM,CAAC,CAAC,CACb,CAEA,MAAM,MAAO,CACX,IAAIC,EAAM,KAAK,MAAM,MAAM,KAAK,GAAG,SAAS,gBAAgB,GAAK,IAAI,EAWrE,GAVI,MAAM,QAAQA,CAAG,IACnBA,EAAM,CACJ,QAAS,EACT,MAAOA,CACT,GAEEA,EAAI,QACN,KAAK,IAAI,OAAOA,EAAI,KAAK,EACzB,QAAQ,IAAI,UAAUA,EAAI,MAAM,eAAe,GAE7CA,EAAI,SAGN,QAAWC,KAAKD,EAAI,SAClB,QAAWE,KAAKF,EAAI,SAASC,CAAC,EACxB,KAAK,IAAI,KAAKC,CAAC,IACZ,KAAK,SAASD,CAAC,IAAG,KAAK,SAASA,CAAC,EAAI,CAAC,GAC3C,KAAK,SAASA,CAAC,EAAEC,CAAC,EAAIF,EAAI,SAASC,CAAC,EAAEC,CAAC,GAK3CF,EAAI,WACN,KAAK,aAAeA,EAAI,SAG5B,CAEA,UAAiB,CACf,IAAIG,EAAO,KAAK,IAAI,KAAK,YAAY,EACrC,GAAI,CAACA,EAAM,CACT,QAAQ,KAAK,kCAAkC,EAC/C,IAAMC,EAAO,KAAK,IAAI,KAAK,OAAO,EAC5BC,EAAK,KAAK,IAAI,KAAK,YAAY,EACrCA,EAAG,KAAO,YACVA,EAAG,OAASD,EACZ,IAAME,EAAM,KAAK,IAAI,KAAK,WAAW,EACrCA,EAAI,KAAO,WACXA,EAAI,OAASD,EACb,IAAME,EAAO,KAAK,IAAI,KAAK,MAAM,EACjCA,EAAK,OAASF,EACdF,EAAOE,CACT,CACA,OAAOF,CACT,CAEA,KAAKP,EAA2B,CAC9B,OAAO,KAAK,IAAI,KAAKA,CAAI,CAC3B,CAEA,IAAIY,EAAcC,EAAmB,CACnC,OAAO,KAAK,IAAI,KAAKD,EAAMC,CAAK,CAClC,CAGA,YAAYC,EAAYT,EAAkB,CACnC,KAAK,SAASS,EAAK,EAAE,IACxB,KAAK,SAASA,EAAK,EAAE,EAAI,CAAC,GAE5B,IAAIC,EAAW,KAAK,SAASD,EAAK,EAAE,EAAET,EAAE,EAAE,EAC1C,OAAIU,IAAa,SACfA,EAAW,IAENA,CACT,CAGA,YAAYD,EAAYT,EAASW,EAAY,CAC3C,KAAK,SAASF,EAAK,EAAE,EAAET,EAAE,EAAE,EAAIW,EAC/B,KAAK,KAAK,CACZ,CAEA,UAAUhB,EAAyB,CACjC,GAAIA,EAAK,KAAK,KAAOA,EAAK,KAAK,GAC7B,OAAO,KAET,IAAMiB,EAAIjB,EAAK,MAAM,EACrBiB,EAAE,IAAI,EACN,IAAIC,EAAOlB,EAAK,KAAK,YACrB,GAAI,CAACkB,EAAM,CAET,IAAMC,EAAanB,EAAK,SAAS,UAAU,QAAQ,EAAE,OACrD,OAAIA,EAAK,KAAK,IAAI,MAAQ,UAAYmB,EAAa,EAC1CF,EAAE,OAAOjB,EAAK,SAAS,UAAU,QAAQ,EAAEmB,EAAa,CAAC,CAAC,EAG5DF,CACT,CACA,IAAMG,EAAoBC,EAACJ,GAAkB,CAE3C,GAAI,CADa,KAAK,YAAYjB,EAAK,KAAMiB,EAAE,IAAI,EAGjD,OAAOA,EAET,IAAME,EAAaF,EAAE,KAAK,UAAU,QAAQ,EAAE,OAC9C,GAAIA,EAAE,KAAK,aAAe,GAAKE,EAAa,EAAG,CAC7C,IAAMG,EAAYL,EAAE,KAAK,UAAU,QAAQ,EAAEE,EAAa,CAAC,EAE3D,OAAOC,EAAkBH,EAAE,OAAOK,CAAS,CAAC,CAC9C,CACA,IAAMC,EAAYN,EAAE,KAAK,SAASA,EAAE,KAAK,WAAa,CAAC,EAEvD,OAAOG,EAAkBH,EAAE,OAAOM,CAAS,CAAC,CAC9C,EAf0B,qBAiB1B,OAAOH,EAAkBH,EAAE,OAAOC,CAAI,CAAC,CACzC,CAEA,UAAUlB,EAAyB,CAEjC,IAAMiB,EAAIjB,EAAK,MAAM,EACrB,GAAI,KAAK,YAAYA,EAAK,KAAMA,EAAK,IAAI,GAAKA,EAAK,KAAK,UAAU,QAAQ,EAAE,OAAS,EAEnF,OAAOiB,EAAE,OAAOjB,EAAK,KAAK,UAAU,QAAQ,EAAE,CAAC,CAAC,EAElD,GAAI,KAAK,YAAYA,EAAK,KAAMA,EAAK,IAAI,GAAKA,EAAK,KAAK,WAAa,EAEnE,OAAOiB,EAAE,OAAOjB,EAAK,KAAK,SAAS,CAAC,CAAC,EAEvC,IAAMwB,EAAiCH,EAACJ,GAAyB,CAC/D,IAAMQ,EAAOR,EAAE,KAAK,YACpB,GAAIQ,EACF,OAAAR,EAAE,IAAI,EAECA,EAAE,OAAOQ,CAAI,EAEtB,IAAMC,EAAST,EAAE,SACjB,OAAKS,EAIDT,EAAE,KAAK,IAAI,MAAQ,UAAYS,EAAO,WAAa,GACrDT,EAAE,IAAI,EAECA,EAAE,OAAOS,EAAO,SAAS,CAAC,CAAC,IAEpCT,EAAE,IAAI,EAECO,EAA+BP,CAAC,GAT9B,IAUX,EApBuC,kCAsBvC,OAAOO,EAA+BP,CAAC,CACzC,CAEF,EA1LaI,EAAAzB,EAAA,aA6Lb,SAASG,GAAS4B,EAAMC,EAAU,IAAM,CACtC,IAAIC,EACJ,MAAO,IAAIC,IAAS,CAClB,aAAaD,CAAK,EAClBA,EAAQ,WAAW,IAAM,CAAEF,EAAK,MAAM,KAAMG,CAAI,CAAG,EAAGF,CAAO,CAC/D,CACF,CANSP,EAAAtB,GAAA,YCzMF,IAAMgC,GAAoB,CAC/B,KAAK,CAAC,MAAO,CAAC,UAAAC,EAAW,EAAAC,EAAG,EAAAC,EAAG,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,IAAAC,CAAG,CAAC,EAAG,CAC5D,IAAMC,EAAUC,EAAA,CAACC,EAAMC,IAASC,GAAM,CACpCA,EAAE,gBAAgB,EACd,CAAAF,EAAK,WAGLA,EAAK,SACPA,EAAK,QAAQ,EAEXC,GACFV,EAAU,eAAeU,EAAI,GAAIJ,CAAG,EAEtCN,EAAU,SAAS,EACrB,EAZgB,WAaZY,EAAW,CAAC,KAAM,GAAGX,KAAK,EAC9B,OAAIG,IAAU,UACZQ,EAAW,CAAC,MAAO,GAAGX,KAAK,GAGjC,EAAC,MAAG,MAAM,OAAO,MAAO,OAAO,OAAOW,EAAU,CAC9C,OAAQ,IACR,SAAU,WACV,IAAK,GAAGV,MACR,QAAS,cACX,CAAC,GACEC,EAAM,OAAOU,GAAK,CAACA,EAAE,MAAQA,EAAE,KAAK,CAAC,EAAE,IAAIA,GAAK,CAC/C,IAAIC,EAAQ,GACRC,EACAL,EACJ,OAAIG,EAAE,UACJH,EAAML,EAAS,KAAKW,GAAKA,EAAE,KAAOH,EAAE,OAAO,EAC3CE,EAAUf,EAAU,YAAY,WAAWU,EAAI,EAAE,EACjDI,EAAQJ,EAAI,OAEVG,EAAE,QACJC,EAAQD,EAAE,MAAM,GAGhB,EAAC,MAAG,QAASN,EAAQM,EAAGH,CAAG,EAAG,MAAQG,EAAE,SAAU,WAAW,GAAI,MAAO,CACtE,QAAS,MACX,GACE,EAAC,WAAKC,CAAM,EACXC,GAAW,EAAC,OAAI,MAAM,+BAA+BE,GAAeF,EAAQ,GAAG,EAAE,KAAK,GAAG,EAAE,YAAY,CAAE,CAC5G,CAEJ,CAAC,CACH,CAEE,CACF,ECnDO,IAAMG,GAA8B,CACzC,SAAS,CAAE,MAAAC,EAAO,IAAAC,CAAI,EAAG,CACvB,IAAMC,EAAWD,EAAI,cAAc,WAAW,EAAE,SAC5CD,EAAM,WAAa,QAAaE,EAAS,OAAS,GACpDA,EAASF,EAAM,QAAQ,EAAE,eAAe,CAAE,MAAO,SAAU,CAAC,CAEhE,EAEA,SAAS,CAAE,MAAAA,EAAO,IAAAC,CAAI,EAAG,CACvBA,EAAI,cAAc,OAAO,EAAE,MAAM,EAC7BD,EAAM,WAAa,SACrBA,EAAM,SAAW,EAErB,EAEA,KAAK,CAAE,MAAAG,EAAO,MAAAH,CAAM,EAAG,CACrB,IAAMI,EAAYD,EAAM,UACxBH,EAAM,OAAUA,EAAM,SAAW,OAAa,GAAKA,EAAM,OAEzD,IAAMK,EADO,OAAO,OAAOD,EAAU,SAAS,QAAQ,EAChC,OAAOE,IACbA,EAAI,OAASA,EAAI,IAClB,YAAY,EAAE,WAAWN,EAAM,OAAO,YAAY,CAAC,CACjE,EACKO,EAAYC,EAACC,GAAM,CACvB,IAAMC,EAAMF,EAAA,CAACG,EAAGC,KAAQD,EAAIC,EAAKA,GAAKA,EAA1B,OACZ,GAAIH,EAAE,MAAQ,YAAa,CACzB,GAAIT,EAAM,WAAa,OAAW,CAChCA,EAAM,SAAW,EACjB,MACF,CACA,OAAAA,EAAM,SAAWU,EAAIV,EAAM,SAAW,EAAGK,EAAS,MAAM,EACjD,EACT,CACA,GAAII,EAAE,MAAQ,UACZ,OAAIT,EAAM,WAAa,SACrBA,EAAM,SAAW,GAEnBA,EAAM,SAAWU,EAAIV,EAAM,SAAW,EAAGK,EAAS,MAAM,EACjD,GAET,GAAII,EAAE,MAAQ,QACZ,OAAIT,EAAM,WAAa,SACrBI,EAAU,SAAS,eAAeC,EAASL,EAAM,QAAQ,EAAE,GAAIG,EAAM,GAAG,EACxEC,EAAU,YAAY,GAEjB,EAEX,EAxBkB,aAyBZS,EAAUL,EAACF,GAAQ,CACvBF,EAAU,SAAS,eAAeE,EAAI,GAAIH,EAAM,GAAG,EACnDC,EAAU,YAAY,CACxB,EAHgB,WAIVU,EAAeN,EAACC,GAAM,CAC1BT,EAAM,OAASS,EAAE,OAAO,MACxBT,EAAM,SAAW,CACnB,EAHqB,gBAIrB,OACE,EAAC,OAAI,MAAM,UAAU,MAAO,CAC1B,SAAU,WACV,KAAM,GAAGG,EAAM,MACf,IAAK,GAAGA,EAAM,KAChB,GACE,EAAC,WAAI,EAAC,SAAM,MAAO,CAAE,MAAO,MAAO,QAAS,IAAK,OAAQ,GAAI,EAAG,KAAK,OAAO,UAAWI,EAAW,QAASO,EAAc,YAAY,mBAAmB,CAAE,EAC1J,EAAC,OAAI,MAAM,WAAW,MAAO,CAC3B,UAAW,SACX,SAAU,UACZ,GACGT,EAAS,IAAI,CAACC,EAAKS,IAAQ,EAAC,OAAI,MAAQf,EAAM,WAAae,EAAO,WAAa,GAAI,QAAS,IAAMF,EAAQP,CAAG,GAAIA,EAAI,OAASA,EAAI,EAAG,CAAM,CAC9I,CACF,CAEJ,CACF,ECvEO,IAAMU,EAA0B,CACrC,KAAM,CAAC,MAAO,CAAC,UAAAC,EAAW,KAAAC,EAAM,UAAAC,EAAW,cAAAC,EAAe,UAAAC,CAAS,EAAG,MAAAC,CAAK,EAAG,CAC5E,IAAMC,EAAOL,EAAK,KACdM,EAAQH,EAAa,QAAU,OAE7BI,EAAUC,EAAA,IACVF,IAAS,OACJG,EAAUJ,EAAM,aAAa,EAAIK,EAAWL,EAAM,cAAeA,CAAI,EAAIA,EAAK,KAEhFA,EAAKC,CAAI,GAAK,GAJP,WAMVK,EAAUH,EAAA,IAAM,CACpBJ,EAAM,aAAeC,EAAKC,CAAI,EAC9BP,EAAU,QAAQ,KAAOM,EACzBN,EAAU,QAAQ,KAAOC,CAC3B,EAJgB,WAKVY,EAASJ,EAAA,IACNH,EAAKC,CAAI,EADH,UAGTO,EAASL,EAAA,CAACM,EAAGC,IAAa,CACzBV,EAAK,cACJH,GAAiBY,EAAE,SAAW,EAChCT,EAAKC,CAAI,EAAIF,EAAM,aAEnBC,EAAKC,CAAI,EAAIQ,GAGbC,IACFhB,EAAU,QAAQ,KAAO,KAE7B,EAXe,UAaXiB,EACAX,EAAK,IAAI,MAAQ,WACnBW,EAAeb,EAAa,QAAU,SAGxC,IAAIc,EAAK,SAASjB,EAAK,MAAMK,EAAK,KAClC,OAAIC,IAAS,UACXW,EAAKA,EAAG,UAEH,EAAEC,GAAY,CAAC,GAAAD,EAAI,OAAAL,EAAQ,OAAAC,EAAQ,QAAAN,EAAS,UAAAN,EAAW,QAAAU,EAAS,YAAAK,CAAW,CAAC,CACrF,CACF,EAmBaE,GAAwC,CACnD,SAAS,CAAC,IAAAC,EAAI,MAAAC,CAAK,EAAG,CACpB,IAAMC,EAAWF,EAAI,cAAc,UAAU,EACvCG,EAAgBD,EAAS,aACzBE,EAAOJ,EAAI,cAAc,MAAM,EACrC,KAAK,aAAe,IAAM,CACxBI,EAAK,MAAM,MAAQ,GAAG,KAAK,IAAIF,EAAS,YAAa,GAAG,MACxDE,EAAK,UAAYF,EAAS,MAAM,QAAQ;AAAA,EAAM,OAAO,EACrDA,EAAS,MAAM,OAAUE,EAAK,aAAe,EAAK,GAAGA,EAAK,iBAAmB,GAAGD,KAClF,EACAD,EAAS,iBAAiB,QAAS,IAAM,KAAK,aAAa,CAAC,EAC5DA,EAAS,iBAAiB,OAAQ,IAAME,EAAK,UAAY,EAAE,EAC3D,WAAW,IAAM,KAAK,aAAa,EAAG,EAAE,EACpCH,EAAM,SAASA,EAAM,QAAQC,CAAQ,CAC3C,EACA,UAAW,CACT,KAAK,aAAa,CACpB,EACA,KAAM,CAAC,MAAO,CAAC,GAAAJ,EAAI,UAAAhB,EAAW,QAAAU,EAAS,OAAAa,EAAQ,OAAAZ,EAAQ,OAAAC,EAAQ,QAAAN,EAAS,YAAAS,CAAW,EAAG,MAAAZ,CAAK,EAAG,CAC5F,IAAMqB,EAASrB,EAAM,QACjBA,EAAM,OACLG,EAAWA,EAAQ,EAAIK,EAAO,EA+BnC,OACE,EAAC,OAAI,MAAM,kBACT,EAAC,YACC,GAAIK,EACJ,KAAK,IACL,QA5BYT,EAACkB,GAAM,CACnBf,GAASA,EAAQe,CAAC,EACtBtB,EAAM,QAAU,GAChBA,EAAM,OAASQ,EAAO,CACxB,EAJkB,aA6BZ,OAxBaJ,EAACkB,GAAM,CAKpBtB,EAAM,UACRA,EAAM,QAAU,GAChBS,EAAOT,EAAM,OAAQ,EAAI,EACzBA,EAAM,OAAS,QAEboB,GAAQA,EAAOE,CAAC,CACtB,EAXmB,cAyBb,QAbOlB,EAACkB,GAAM,CAClBtB,EAAM,OAASsB,EAAE,OAAO,MACxBb,EAAOT,EAAM,OAAQ,EAAK,CAC5B,EAHa,QAcP,YAAaY,EACb,UAAWf,GAtCMO,EAACkB,GAAM,CACxBA,EAAE,MAAQ,UACZA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAEtB,EALuB,kBAuCjB,MAAOD,GAAQA,CAAM,EACvB,EAAC,QAAK,MAAO,CAAC,WAAY,SAAU,SAAU,OAAO,EAAG,CAC1D,CAEJ,CACF,EChIA,IAAOE,GAAQ,CACb,KAAK,CAAC,MAAO,CAAC,KAAAC,EAAM,UAAAC,EAAW,MAAAC,CAAK,CAAC,EAAG,CACtC,OACE,EAAC,OAAI,MAAM,aACX,CAEJ,CACF,ECTO,IAAMC,GAAU,CACrB,KAAK,CAAC,MAAO,CAAC,UAAAC,EAAW,KAAAC,CAAI,CAAC,EAAG,CAc/B,OACE,EAAC,OAAI,MAAM,uCACT,EAAC,OAAI,MAAM,6BAA6B,KAAK,OAAO,QAAQ,aAC1D,EAAC,UAAO,GAAG,IAAI,GAAG,IAAI,EAAE,IAAI,EAC5B,EAAC,QAAK,MAAO,CAAC,UAAW,sBAAsB,EAAG,EAAE,wGAAuG,CAC7J,EACA,EAAC,OAAI,MAAM,aACT,EAAC,SAAM,MAAM,OACX,KAAK,OACL,QAtBSC,EAACC,GAAM,CACtBH,EAAU,eAAe,eAAgB,CAAC,KAAMC,EAAK,KAAM,KAAAA,CAAI,EAAGE,EAAE,OAAO,KAAK,CAClF,EAFiB,YAuBT,UApBOD,EAACC,GAAM,CACpB,GAAIA,EAAE,MAAQ,QACZA,EAAE,gBAAgB,EAClBA,EAAE,eAAe,EACb,KAAK,WAAa,GAAG,CACvB,IAAMC,EAAYH,EAAK,KAAK,SAASA,EAAK,KAAK,WAAW,CAAC,EAC3DD,EAAU,eAAe,eAAgB,CAAC,KAAMI,EAAW,KAAAH,CAAI,CAAC,CAClE,CAEJ,EATe,UAqBP,MAAO,GACT,CACF,CACF,CAEJ,CACF,EC9BA,IAAOI,GAAQ,CACb,KAAK,CAAC,MAAO,CAAC,UAAAC,EAAW,KAAAC,CAAI,CAAC,EAAG,CAC/B,IAAIC,EAAOD,EAAK,KAChB,OAAIA,EAAK,KAAK,QACZC,EAAOD,EAAK,KAAK,OAGjB,EAAC,OAAI,MAAM,aACT,EAAC,OAAI,MAAM,UACPC,EAAK,UAAU,QAAQ,EAAE,OAAS,GAClCA,EAAK,UAAU,QAAQ,EAAE,IAAI,GAAK,EAACC,EAAA,CAAY,IAAK,EAAE,GAAI,UAAWH,EAAW,KAAMC,EAAK,OAAO,CAAC,EAAG,CAAE,CAE5G,EACA,EAAC,OAAI,MAAM,YACPC,EAAK,WAAa,EACjBA,EAAK,SAAS,IAAI,GAAK,EAACC,EAAA,CAAY,IAAK,EAAE,GAAI,UAAWH,EAAW,KAAMC,EAAK,OAAO,CAAC,EAAG,CAAE,EAC7F,EAACG,GAAA,CAAQ,UAAWJ,EAAW,KAAMC,EAAM,CAEhD,CACF,CAEJ,CACF,ECtBA,IAAOI,GAAQ,CACb,KAAK,CAAC,MAAO,CAAC,UAAAC,EAAW,KAAAC,CAAI,EAAG,MAAAC,CAAK,EAAG,CACtC,IAAMC,EAAOF,EAAK,KAClBC,EAAM,OAAUA,EAAM,SAAW,OAAa,IAAI,IAAQA,EAAM,OAChEC,EAAK,SAAS,QAAQC,GAAK,CACzBA,EAAE,UAAU,QAAQ,EAAE,QAAQC,GAAKH,EAAM,OAAO,IAAIG,EAAE,IAAI,CAAC,CAC7D,CAAC,EACD,IAAMC,EAAiBC,EAAA,CAACJ,EAAMK,IAAU,CACtC,IAAMC,EAASN,EAAK,UAAU,QAAQ,EAAE,OAAOE,GAAKA,EAAE,OAASG,CAAK,EACpE,OAAIC,EAAO,SAAW,EAAU,GACzB,EAACC,EAAA,CAAW,UAAW,GAAM,UAAWV,EAAW,KAAMC,EAAK,OAAOQ,EAAO,CAAC,CAAC,EAAG,CAC1F,EAJuB,kBAKvB,OACE,EAAC,SAAM,MAAM,aAAa,MAAO,CAAC,oBAAqB,UAAUP,EAAM,OAAO,KAAK,SAAS,GAC1F,EAAC,aACC,EAAC,UACC,EAAC,SAAG,EACH,CAAC,GAAGA,EAAM,MAAM,EAAE,IAAIG,GAAK,EAAC,UAAIA,CAAE,CAAK,CAC1C,CACF,EACA,EAAC,aACEF,EAAK,SAAS,IAAIC,GACjB,EAAC,UACC,EAAC,UAAG,EAACO,EAAA,CAAY,IAAKP,EAAE,GAAI,UAAWJ,EAAW,KAAMC,EAAK,OAAOG,CAAC,EAAG,CAAE,EACzE,CAAC,GAAGF,EAAM,MAAM,EAAE,IAAIG,GAAK,EAAC,UAAIC,EAAeF,EAAGC,CAAC,CAAE,CAAK,CAC7D,CACD,CACH,CACF,CAEJ,CACF,EC9BO,IAAMO,GAAQ,CACnB,KAAAC,GACA,MAAAC,EACF,EAEO,SAASC,GAAQC,EAAM,CAC5B,OAAOJ,GAAMI,CAAI,GAAKC,EACxB,CAFgBC,EAAAH,GAAA,WAIhB,OAAO,aAAe,CAACC,EAAMG,IAAS,CACpCP,GAAMI,CAAI,EAAIG,EACd,UAAU,SAAS,gBAAgB,CACjC,GAAI,QAAQH,IACZ,MAAO,WAAWI,GAAYJ,CAAI,IAClC,OAASK,GAAiB,CACnBA,EAAI,MACTA,EAAI,KAAK,QAAQ,OAAQL,CAAI,CAC/B,CACF,CAAC,CACH,EAEA,SAASI,GAAYE,EAAK,CACxB,OAAOA,EAAI,QACT,SACA,SAASC,EAAK,CACZ,OAAOA,EAAI,OAAO,CAAC,EAAE,YAAY,EAAIA,EAAI,OAAO,CAAC,EAAE,YAAY,CACjE,CACF,CACF,CAPSL,EAAAE,GAAA,eCJF,IAAMI,EAAoC,CAC/C,KAAM,CAAC,MAAO,CAAC,UAAAC,EAAW,KAAAC,CAAI,CAAC,EAAG,CAChC,OAAO,EAAEC,GAAQD,EAAK,KAAK,QAAQ,MAAM,GAAG,MAAM,EAAG,CAAC,UAAAD,EAAW,KAAAC,CAAI,CAAC,CACxE,CACF,EAGaE,EAAyC,CACpD,KAAM,CAAC,MAAAC,EAAO,MAAAC,EAAO,SAAAC,CAAQ,EAAG,CAC9B,GAAI,CAAC,KAAAL,EAAM,UAAAD,CAAS,EAAII,EACpBG,EAAON,EAAK,KAEZO,EAAQ,GACRC,EAAaF,EACbA,EAAK,QACPC,EAAQ,GACRD,EAAOE,EAAW,OAGpB,IAAMC,EAAWV,EAAU,UAAU,YAAYC,EAAK,KAAMQ,CAAU,EAEhEE,EAAQC,EAACC,GAAM,CACnBR,EAAM,MAAQ,GACdQ,EAAE,gBAAgB,CACpB,EAHc,SAKRC,EAAUF,EAACC,GAAM,CACrBR,EAAM,MAAQ,GACdQ,EAAE,gBAAgB,CACpB,EAHgB,WAKVE,EAASH,EAACC,GAAM,CAChBH,EACFV,EAAU,eAAe,WAAY,CAAC,KAAMS,EAAY,KAAAR,CAAI,CAAC,EAE7DD,EAAU,eAAe,SAAU,CAAC,KAAMS,EAAY,KAAAR,CAAI,CAAC,EAE7DY,EAAE,gBAAgB,CACpB,EAPe,UASTG,EAAgBJ,EAACC,GAAM,CAC3B,IAAMI,EAAeJ,EAAE,UAAYA,EAAE,SAAWA,EAAE,QAAUA,EAAE,QAC9D,OAAQA,EAAE,IAAK,CACf,IAAK,UACCA,EAAE,OAAO,iBAAmB,GAAK,CAACI,GACpCJ,EAAE,gBAAgB,EAEpB,MACF,IAAK,YACCA,EAAE,OAAO,iBAAmBA,EAAE,OAAO,MAAM,QAAUA,EAAE,OAAO,iBAAmB,GAAK,CAACI,GACzFJ,EAAE,gBAAgB,EAEpB,MACF,IAAK,YAEH,GAAIA,EAAE,OAAO,QAAU,GAAI,CAGzB,GAFAA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EACdN,EAAK,WAAa,EACpB,OAEFP,EAAU,eAAe,SAAU,CAAC,KAAAO,EAAM,KAAAN,EAAM,MAAOY,CAAC,CAAC,EACzD,MACF,CAEA,GAAIA,EAAE,OAAO,QAAU,IAAMA,EAAE,OAAO,iBAAmB,GAAKA,EAAE,OAAO,eAAiB,EAAG,CACzFA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAGlB,IAAMK,EAAQlB,EAAU,UAAU,UAAUC,CAAI,EAChD,GAAI,CAACiB,EACH,OAEF,IAAMC,EAAUD,EAAM,KAAK,KAC3BA,EAAM,KAAK,KAAOC,EAAQN,EAAE,OAAO,MACnCN,EAAK,QAAQ,EACb,EAAE,OAAO,KAAK,EACdP,EAAU,MAAMkB,EAAOC,EAAQ,MAAM,EAErC,MACF,CACA,MACF,IAAK,QAEH,GADAN,EAAE,eAAe,EACbA,EAAE,SAAWA,EAAE,UAAYA,EAAE,SAAWA,EAAE,OAAQ,OAEtD,GAAIA,EAAE,OAAO,iBAAmBA,EAAE,OAAO,MAAM,OAAQ,CACjDN,EAAK,WAAa,GAAKP,EAAU,UAAU,YAAYC,EAAK,KAAMM,CAAI,EACxEP,EAAU,eAAe,eAAgB,CAAC,KAAAO,EAAM,KAAAN,CAAI,EAAG,GAAI,CAAC,EAE5DD,EAAU,eAAe,SAAU,CAAC,KAAAO,EAAM,KAAAN,CAAI,CAAC,EAEjDY,EAAE,gBAAgB,EAClB,MACF,CAEA,GAAIA,EAAE,OAAO,iBAAmB,EAAG,CACjCb,EAAU,eAAe,gBAAiB,CAAC,KAAAO,EAAM,KAAAN,CAAI,CAAC,EACtDY,EAAE,gBAAgB,EAClB,MACF,CAEA,GAAIA,EAAE,OAAO,eAAiB,GAAKA,EAAE,OAAO,eAAiBA,EAAE,OAAO,MAAM,OAAQ,CAClFb,EAAU,eAAe,SAAU,CAAC,KAAAO,EAAM,KAAAN,CAAI,EAAGY,EAAE,OAAO,MAAM,MAAMA,EAAE,OAAO,cAAc,CAAC,EAAE,KAAK,IAAM,CACzGN,EAAK,KAAOM,EAAE,OAAO,MAAM,MAAM,EAAGA,EAAE,OAAO,cAAc,CAC7D,CAAC,EACDA,EAAE,gBAAgB,EAClB,MACF,CACA,KACF,CACF,EAxEsB,iBA0EhBO,EAAOR,EAACC,GAAM,CAClBA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAElBb,EAAU,eAAe,OAAQ,CAAC,KAAAO,EAAM,KAAAN,CAAI,CAAC,EAGzC,SAAS,WAAa,SAAS,UAAU,MAC3C,SAAS,UAAU,MAAM,EAChB,OAAO,cAChB,OAAO,aAAa,EAAE,gBAAgB,CAE1C,EAZa,QAcPoB,EAAWT,EAACU,GACTA,EAAE,WAAaA,EAAE,UAAU,QAAQ,EAAE,OAD7B,YAIXC,EAAaX,EAAA,IACbL,EAAK,KAAOP,EAAU,SAAS,MAAM,IAAMK,EAAM,MAC5C,GAEFE,EAAK,KAAK,OAAS,EAJT,cAOnB,OACE,EAAC,OAAI,YAAaI,EAAO,WAAYG,GACnC,EAAC,OAAI,MAAM,oDACT,EAAC,OAAI,MAAM,qBAAqB,MAAM,6BAClC,QAAUD,GAAMb,EAAU,SAASa,EAAG,CAAC,KAAMJ,EAAY,KAAAR,CAAI,CAAC,EAC9D,cAAgBY,GAAMb,EAAU,SAASa,EAAG,CAAC,KAAMJ,EAAY,KAAAR,CAAI,CAAC,EACpE,YAAU,OACV,QAAQ,aACTI,EAAM,OAAS,EAAC,QAAK,MAAO,CAAC,UAAW,kBAAkB,EAAG,YAAU,UAAU,EAAE,uLAAuL,CAC7Q,EACA,EAAC,OAAI,MAAM,uBAAuB,QAASU,EAAQ,WAAYK,EAAM,cAAgBP,GAAMb,EAAU,SAASa,EAAG,CAAC,KAAMJ,EAAY,KAAAR,CAAI,CAAC,EAAG,YAAU,OAAO,MAAO,CAAE,QAASsB,EAAW,EAAI,QAAU,MAAO,GAC3MC,EAAUjB,EAAM,YAAY,EAC1BkB,EAAWlB,EAAM,YAAY,EAC7B,EAAC,OAAI,MAAM,cAAc,QAAQ,YAAY,MAAM,8BACjDc,EAASd,CAAI,EAAI,GAAK,CAACG,EAAU,EAAC,UAAO,GAAG,wBAAwB,GAAG,IAAI,GAAG,IAAI,EAAE,IAAI,EAAG,KAC7F,EAAC,UAAO,GAAG,IAAI,GAAG,IAAI,EAAE,IAAI,KAAK,eAAe,EAAE,IAChDF,EAAO,EAAC,UAAO,GAAG,wBAAwB,GAAG,IAAI,GAAG,IAAI,EAAE,IAAI,KAAK,OAAO,eAAa,IAAI,OAAO,eAAe,mBAAiB,MAAM,EAAG,IAC/I,CAEJ,EACED,EAAK,IAAI,MAAQ,SACf,EAAC,OAAI,MAAM,kCACT,EAAC,WACC,EAACmB,EAAA,CAAW,UAAW1B,EAAW,KAAMC,EAAM,UAAWe,EAAe,CAC1E,EACA,EAACU,EAAA,CAAW,UAAW,GAAM,UAAW1B,EAAW,KAAMC,EAAM,UAAWe,EAAe,CAC3F,EACA,EAAC,OAAI,MAAM,kCACRQ,EAAUjB,EAAM,cAAc,GAAK,EAAEkB,EAAWlB,EAAM,cAAc,EAAG,CAAC,KAAAA,CAAI,CAAC,EAC9E,EAACmB,EAAA,CAAW,UAAW1B,EAAW,KAAMC,EAAM,UAAWe,EAAe,EACvEQ,EAAUjB,EAAM,aAAa,GAAK,EAAEkB,EAAWlB,EAAM,aAAa,EAAG,CAAC,KAAAA,CAAI,CAAC,CAC9E,CAEN,EACCiB,EAAUjB,EAAM,aAAa,GAAK,EAAEkB,EAAWlB,EAAM,aAAa,EAAG,CAAC,KAAAA,CAAI,CAAC,EAC1EG,IAAa,IACb,EAAC,OAAI,MAAM,+BACT,EAAC,OAAI,MAAM,cAAc,QAASK,EAAQ,EAC1C,EAAC,OAAI,MAAM,aACR,EAAEb,GAAQK,EAAK,QAAQ,MAAM,GAAG,MAAM,EAAG,CAAC,UAAAP,EAAW,KAAAC,CAAI,CAAC,CAC7D,CACF,CAEJ,CAEJ,CACF,EC1MO,IAAM0B,EAAN,KAAW,CAGhB,aAAc,CACZ,KAAK,SAAW,EAClB,CACF,EANaC,EAAAD,EAAA,QAAAA,EAANE,EAAA,CADPC,GACaH,GCAN,IAAMI,GAAQ,CACnB,KAAK,CAAE,MAAAC,CAAM,EAAG,CACd,IAAMC,EAAOD,EAAM,KACbE,EAAYF,EAAM,UAClBG,EAAOF,EAAK,KAEZG,EAAQC,EAACC,GAAM,CACnBJ,EAAU,eAAe,cAAe,CAAC,EAAGD,CAAI,CAClD,EAFc,SAGRM,EAASF,EAACC,GAAM,CACpBL,EAAK,IAAI,CACX,EAFe,UAGTO,EAAWH,EAACC,GAAM,CAEtBJ,EAAU,OAAS,CAACD,CAAI,EACxBC,EAAU,QAAQ,KAAOD,CAC3B,EAJiB,YAKXQ,EAAeJ,EAACC,GAAM,CAC1BH,EAAK,aAAaO,CAAI,EAAE,SAAWJ,EAAE,OAAO,MAC5CH,EAAK,QAAQ,CACf,EAHqB,gBAIrB,SAASQ,EAAWC,EAAQ,GAAI,CAI9B,MADgB,KAFUA,EAAM,MAAM,KAAK,GAAK,CAAC,GAAG,OAEV,EAE5C,CALS,OAAAP,EAAAM,EAAA,cAMF,EAAC,OAAI,MAAM,4BAChB,EAAC,OAAI,MAAM,YACPV,EAAK,OAAS,EACd,EAAC,OAAI,MAAM,aAAa,MAAO,CAAE,aAAc,gBAAiB,GAC9D,EAAC,OAAI,QAASM,EAAQ,MAAM,6BAA6B,MAAM,KAAK,OAAO,KAAK,KAAK,eAAe,QAAQ,aAC1G,EAAC,QAAK,YAAU,UAAU,EAAE,gJAAgJ,CAC9K,CACF,EACE,KAEJ,EAAC,OAAI,MAAM,0BACPJ,EAAK,QAAUA,EAAK,OAAO,KAAO,QAAW,EAAC,QAAK,MAAO,CAAE,OAAQ,SAAU,EAAG,QAAS,IAAMD,EAAU,KAAKC,EAAK,MAAM,GAAIA,EAAK,OAAO,IAAK,EAAU,EAAC,YAAK,MAAM,CACzK,EAEED,EAAU,OAAO,OAAS,EAC1B,EAAC,OAAI,MAAM,iCACT,EAAC,OAAI,QAASM,EAAU,MAAO,CAAE,OAAQ,SAAU,EAAG,MAAM,6BAA6B,MAAM,KAAK,OAAO,KAAK,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,MAAM,iBAAe,QAAQ,kBAAgB,QAAQ,MAAM,8BAA6B,EAAC,YAAS,OAAO,iBAAiB,EAAW,EAAC,YAAS,OAAO,iBAAiB,EAAW,EAAC,QAAK,GAAG,KAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,EAAO,EAAC,QAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,CAAO,EAC7b,EAAC,OAAI,QAASJ,EAAO,MAAO,CAAE,OAAQ,SAAU,EAAG,MAAM,6BAA6B,MAAM,KAAK,OAAO,KAAK,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,QAAQ,MAAM,qBAAoB,EAAC,QAAK,GAAG,KAAK,GAAG,IAAI,GAAG,IAAI,GAAG,KAAK,EAAO,EAAC,QAAK,GAAG,IAAI,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,CAAO,CACrV,EACE,IACN,EAEA,EAAC,OAAI,MAAM,sBACT,EAAC,OAAI,MAAM,aAAa,cAAgBE,GAAMJ,EAAU,SAASI,EAAG,CAAE,KAAAH,EAAM,KAAAF,CAAK,CAAC,EAAG,YAAU,QAC7F,EAACY,EAAA,CAAW,UAAWX,EAAW,KAAMD,EAAM,cAAe,GAAM,CACrE,EACEE,EAAK,aAAaO,CAAI,EACtB,EAAC,YAAS,QAASD,EACjB,MAAON,EAAK,aAAaO,CAAI,EAAE,SAC/B,YAAY,2BACZ,MAAO,CACL,WAAY,iBACZ,QAAS,iBACT,QAAS,IACT,OAAQ,GAAGC,EAAWR,EAAK,aAAaO,CAAI,EAAE,QAAQ,MACtD,OAAQ,GACV,GACCP,EAAK,aAAaO,CAAI,EAAE,QAC3B,EACE,KACJ,EAACI,EAAA,CAAc,UAAWZ,EAAW,KAAMD,EAAK,IAAI,EAAG,CACzD,CACF,CACF,CACF,ECxEO,IAAMc,GAAW,CACtB,KAAK,CAAC,MAAO,CAAC,UAAAC,CAAS,CAAC,EAAG,CACzB,IAAMC,EAAO,IAAIC,EAAKF,EAAU,SAAU,UAAU,EACpD,OACE,EAAC,OAAI,MAAO,CACV,SAAU,WACV,KAAM,IACN,MAAO,IACP,IAAK,IACL,OAAQ,GACV,GAEE,EAAC,OAAI,QAAS,IAAMA,EAAU,cAAc,EAAG,MAAO,CACpD,SAAU,WACV,WAAY,QACZ,QAAS,MACT,MAAO,OACP,OAAQ,MACV,EAAG,EAEH,EAAC,OAAI,MAAM,SAAS,MAAO,CACzB,SAAU,WACV,WAAY,OACZ,YAAa,OACb,UAAW,MACb,GACE,EAAC,UAAG,WAAS,EACb,EAACG,EAAA,CAAc,UAAWH,EAAW,KAAMC,EAAM,EACjD,EAAC,OAAI,MAAM,cACT,EAAC,UAAO,MAAM,UAAU,QAAS,IAAM,CACrCD,EAAU,eAAe,EACzBA,EAAU,cAAc,CAC1B,GAAG,cAAY,CAEjB,CACF,CACF,CAEJ,CACF,ECzCO,IAAMI,GAAsB,CACjC,SAAS,CAAC,MAAAC,EAAM,IAAAC,CAAG,EAAG,CACpB,IAAMC,EAAUD,EAAI,cAAc,UAAU,EACxCC,GAAWF,EAAM,WAAa,QAAaE,EAAQ,SAAS,OAAS,GACvEA,EAAQ,SAASF,EAAM,QAAQ,EAAE,eAAe,CAAC,MAAO,SAAS,CAAC,CAEtE,EAEA,KAAK,CAAC,MAAO,CAAC,UAAAG,CAAS,EAAG,MAAAH,CAAK,EAAG,CAEhCA,EAAM,MAASA,EAAM,QAAU,OAAa,GAAKA,EAAM,MACvDA,EAAM,QAAWA,EAAM,UAAY,OAAa,CAAC,EAAIA,EAAM,QAE3D,IAAMI,EAAQC,EAAA,IAAM,CAClBL,EAAM,MAAQ,GACdA,EAAM,QAAU,CAAC,EACjBG,EAAU,QAAU,IACtB,EAJc,SAMRG,EAAOD,EAACE,GAAS,CACrBJ,EAAU,KAAKI,CAAI,EACnBH,EAAM,CACR,EAHa,QAKPI,EAAYH,EAACI,GAAM,CACvB,IAAMC,EAAML,EAAA,CAACM,EAAEC,KAAQD,EAAIC,EAAKA,GAAKA,EAAzB,OACZ,GAAIH,EAAE,MAAQ,YAAa,CACzB,GAAIT,EAAM,WAAa,OAAW,CAChCA,EAAM,SAAW,EACjB,MACF,CACA,OAAAA,EAAM,SAAWU,EAAIV,EAAM,SAAS,EAAGA,EAAM,QAAQ,MAAM,EACpD,EACT,CACA,GAAIS,EAAE,MAAQ,UACZ,OAAIT,EAAM,WAAa,SACrBA,EAAM,SAAW,GAEnBA,EAAM,SAAWU,EAAIV,EAAM,SAAS,EAAGA,EAAM,QAAQ,MAAM,EACpD,GAET,GAAIS,EAAE,MAAQ,QACZ,OAAIT,EAAM,WAAa,QACrBM,EAAKN,EAAM,QAAQA,EAAM,QAAQ,CAAC,EAE7B,GAELS,EAAE,MAAQ,UACZL,EAAM,CAEV,EA1BkB,aA4BZS,EAAeR,EAACI,GAAM,CAI1B,GAHAT,EAAM,MAAQS,EAAE,OAAO,MACvBT,EAAM,SAAW,EAEbA,EAAM,MAAO,CACf,IAAIc,EAAad,EAAM,MAAM,MAAM,MAAM,EACrCe,EAAYD,EAAW,OAAOE,GAAQ,CAACA,EAAK,SAAS,GAAG,CAAC,EAAE,KAAK,GAAG,EACnEC,EAAa,OAAO,YAAYH,EAAW,OAAOE,GAAQA,EAAK,SAAS,GAAG,CAAC,EAAE,IAAIA,GAAQA,EAAK,YAAY,EAAE,MAAM,GAAG,CAAC,CAAC,EACxH,CAACD,GAAa,OAAO,KAAKE,CAAU,EAAE,OAAS,IAGjDF,EAAY,OAAO,KAAKE,CAAU,EAAE,CAAC,GAEvCjB,EAAM,QAAUG,EAAU,QAAQ,MAAM,OAAOY,CAAS,EAAE,IAAIG,GAAM,CAClE,IAAIX,EAAOJ,EAAU,UAAU,KAAKe,CAAE,EACtC,GAAKX,GAID,EAAAA,EAAK,QACPA,EAAOA,EAAK,OAER,CAACA,EAAK,MAGZ,IAAI,OAAO,KAAKU,CAAU,EAAE,OAAS,EAAG,CACtC,IAAME,EAAS,CAAC,EAChB,QAAWC,KAAKb,EAAK,UAAU,QAAQ,EACrCY,EAAOC,EAAE,KAAK,YAAY,CAAC,EAAIA,EAAE,MAAM,YAAY,EAErD,QAAWA,KAAKH,EACd,GAAI,CAACE,EAAOC,CAAC,GAAKD,EAAOC,CAAC,IAAMH,EAAWG,CAAC,EAC1C,MAGN,CACA,OAAOb,EACT,CAAC,EAAE,OAAOc,GAAKA,IAAM,MAAS,CAChC,MACErB,EAAM,QAAU,CAAC,EAGfA,EAAM,OAASA,EAAM,QAAQ,OAAS,EACxCG,EAAU,QAAU,CAClB,QAAS,GACT,QAAS,IAAMC,EAAM,CACvB,EAEAD,EAAU,QAAU,IAGxB,EAnDqB,gBAuDrB,OACE,EAAC,OAAI,MAAQH,EAAM,QAAQ,OAAS,EAAG,0BAA0B,oBAC/D,EAAC,WACC,EAAC,OAAI,MAAM,OAAO,MAAO,CAAC,OAASA,EAAM,QAAQ,OAAS,EAAG,IAAI,KAAK,GACpE,EAAC,OAAI,MAAM,6BAA6B,MAAM,KAAK,OAAO,KAAK,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,QAAQ,MAAM,mCAAkC,EAAC,UAAO,GAAG,KAAK,GAAG,KAAK,EAAE,IAAI,EAAS,EAAC,QAAK,GAAG,KAAK,GAAG,KAAK,GAAG,QAAQ,GAAG,QAAQ,CAAO,EACvT,EAAC,SAAM,KAAK,OAAO,YAAY,SAAS,MAAOA,EAAM,MAAO,UAAWQ,EAAW,QAASK,EAAc,MAAO,CAC9G,OAAQ,IACR,QAAS,IACT,WAAY,cACZ,WAAY,KAAK,EAAG,CACxB,EACEb,EAAM,QAAQ,OAAS,EACvB,EAAC,OAAI,MAAM,UAAU,MAAO,CAC1B,UAAW,SACX,UAAW,OACX,UAAW,OACb,GACGA,EAAM,QAAQ,IAAI,CAACsB,EAAQC,IAAQ,EAAC,OAAI,QAAS,IAAMjB,EAAKgB,CAAM,EAAG,MAAQtB,EAAM,WAAWuB,EAAK,WAAW,IAAKD,EAAO,IAAK,CAAM,CACxI,EACD,IACH,CACF,CAEJ,CACF,ECnIO,IAAME,GAAoB,CAC/B,KAAK,CAAC,MAAO,CAAC,UAAAC,EAAW,SAAAC,CAAQ,CAAC,EAAG,CACnC,OACE,EAAC,WACC,EAAC,UAAG,gCAA8B,EAClC,EAAC,SAAE,kGAEH,EACA,EAAC,OAAI,MAAM,cACT,EAAC,UAAO,MAAM,UAAU,QAAS,IAAM,CACrCA,EAAS,CACX,GAAG,aAAW,CAEhB,CACF,CAEJ,CACF,EAEaC,GAAmB,CAC9B,KAAK,CAAC,MAAO,CAAC,UAAAF,CAAS,CAAC,EAAG,CACzB,OACE,EAAC,WACC,EAAC,UAAG,uCAAqC,EACzC,EAAC,SAAE,gFAA8E,EACjF,EAAC,SAAE,6CACC,EAAC,OAAI,MAAM,6BAA6B,MAAO,CAAC,QAAS,SAAU,WAAY,UAAW,YAAa,SAAS,EAAG,MAAM,KAAK,OAAO,KAAK,KAAK,eAAe,QAAQ,aACtK,EAAC,QAAK,EAAE,iqBAAgqB,CAC1qB,EAAM,oBACR,EACA,EAAC,SAAE,gEAEC,EAAC,OAAI,MAAM,6BAA6B,MAAO,CAAC,QAAS,SAAU,WAAY,UAAW,YAAa,SAAS,EAAG,MAAM,KAAK,OAAO,KAAK,KAAK,eAAe,QAAQ,aACtK,EAAC,QAAK,EAAE,iqBAAgqB,CAC1qB,EAAM,kBACR,EACA,EAAC,OAAI,MAAM,cACT,EAAC,UAAO,MAAM,UAAU,QAAS,IAAM,CACrC,aAAa,QAAQ,YAAa,GAAG,EACrCA,EAAU,WAAW,CACvB,GAAG,QAAM,CAEX,CACF,CAEJ,CACF,EAEaG,GAAgB,CAC3B,KAAK,CAAC,MAAO,CAAC,UAAAH,EAAW,SAAAC,CAAQ,CAAC,EAAG,CACnC,OACE,EAAC,WACC,EAAC,UAAG,mBAAiB,EACrB,EAAC,SAAE,6DAA2D,EAC9D,EAAC,SAAE,qEAAkE,EAAC,OAAI,MAAO,CAAC,QAAS,QAAQ,GAAG,yBAA6B,EAAM,qGAAmG,EAC5O,EAAC,SAAE,yBACD,EAAC,OAAI,MAAM,6BAA6B,MAAO,CAAC,QAAS,SAAU,WAAY,SAAU,YAAa,QAAQ,EAAG,MAAM,KAAK,OAAO,KAAK,KAAK,eAAe,QAAQ,aAClK,EAAC,QAAK,EAAE,iqBAAgqB,CAC1qB,EAAM,8DAER,EACA,EAAC,OAAI,MAAM,cACT,EAAC,UAAO,QAAS,IAAM,CACrBD,EAAU,WAAW,CACvB,GAAG,QAAM,EACT,EAAC,UAAO,MAAM,UAAU,QAAS,IAAM,CACnCA,EAAU,WAAW,EACrB,aAAa,QAAQ,SAAU,GAAG,EAClCC,EAAS,CACX,GAAG,oBAAkB,CACzB,CACF,CAEJ,CACF,EAEaG,GAAS,CACpB,KAAK,CAAC,MAAO,CAAC,UAAAJ,EAAW,QAAAK,EAAS,SAAAJ,CAAQ,CAAC,EAAG,CAC5C,OACE,EAAC,OAAI,MAAO,CACV,SAAU,WACV,KAAM,IACN,MAAO,IACP,IAAK,IACL,OAAQ,GACV,GAEE,EAAC,OAAI,MAAO,CACV,SAAU,WACV,WAAY,QACZ,QAAS,MACT,MAAO,OACP,OAAQ,MACV,EAAG,EAEH,EAAC,OAAI,MAAM,SAAS,MAAO,CACzB,SAAU,WACV,WAAY,OACZ,YAAa,OACb,OAAQ,iCACR,UAAW,MACb,GACG,EAAE,CACD,UAAaC,GACb,OAAUC,GACV,WAAcJ,EAChB,EAAEM,CAAO,EAAG,CAAC,UAAAL,EAAW,SAAAC,CAAQ,CAAC,CACnC,CACF,CAEJ,CACF,ECzGO,IAAMK,GAAmB,CAC9B,KAAM,CAAC,MAAO,CAAC,UAAAC,CAAS,EAAG,MAAAC,CAAK,EAAG,CACjCA,EAAM,KAAQA,EAAM,OAAS,OAAa,GAAOA,EAAM,KACvD,IAAMC,EAASC,EAACC,GAAM,CAChBH,EAAM,KACRA,EAAM,KAAO,GAEbA,EAAM,KAAO,EAEjB,EANe,UAOf,OACE,EAAC,QAAK,MAAM,+CAA+C,MAAO,CAAC,SAAU,MAAM,GACjF,EAAC,OAAI,MAAM,wBAAwB,MAAO,CAAC,MAAQA,EAAM,KAAM,QAAQ,MAAM,GAC3E,EAAC,OAAI,MAAM,qBAAqB,MAAO,CAAC,OAAQ,MAAM,GACpD,EAAC,OAAI,MAAM,OAAO,IAAI,wBAAwB,MAAO,CAAC,MAAO,OAAQ,OAAQ,MAAM,EAAG,CACxF,EACA,EAAC,OAAI,MAAM,4BACRA,EAAM,MAAQD,EAAU,UAAU,IAAI,KAAK,EAAE,SAAS,IAAIK,GAAQ,EAACC,GAAA,CAAQ,KAAMD,EAAM,SAAU,GAAM,MAAO,EAAG,UAAWL,EAAW,CAAE,CAC5I,EACA,EAAC,OAAI,MAAM,yBACT,EAAC,OAAI,QAASE,EAAQ,MAAM,6BAA6B,MAAM,KAAK,OAAO,KAAK,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,MAAM,iBAAe,QAAQ,kBAAgB,QAAQ,MAAM,2BAA0B,EAAC,QAAK,EAAE,IAAI,EAAE,IAAI,MAAM,KAAK,OAAO,KAAK,GAAG,IAAI,GAAG,IAAI,EAAO,EAAC,QAAK,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,KAAK,CAAO,CAClV,CACF,EACA,EAAC,OAAI,MAAM,2BACT,EAAC,OAAI,MAAM,eACT,EAAC,OAAI,MAAM,cAAc,QAAS,IAAMF,EAAU,UAAU,EAAG,MAAO,CAAC,OAAQ,UAAW,WAAY,iBAAkB,YAAa,iBAAkB,QAAS,OAAQ,WAAY,QAAQ,GAC1L,EAAC,OAAI,MAAM,6BAA6B,MAAM,KAAK,OAAO,KAAK,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,QAAQ,MAAM,4BACzL,EAAC,QAAK,EAAE,IAAI,EAAE,IAAI,MAAM,KAAK,OAAO,KAAK,GAAG,IAAI,GAAG,IAAI,EAAO,EAAC,QAAK,GAAG,KAAK,GAAG,IAAI,GAAG,KAAK,GAAG,IAAI,EAAO,EAAC,QAAK,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,EAAO,EAAC,QAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,CAEzL,EACA,EAAC,WAAI,OAAK,CACZ,EACA,EAAC,OAAI,MAAM,cAAc,QAAS,IAAMA,EAAU,aAAa,EAAG,MAAO,CAAC,OAAQ,UAAW,WAAY,iBAAkB,YAAa,iBAAkB,QAAS,OAAQ,WAAY,QAAQ,GAC7L,EAAC,OAAI,MAAO,CAAC,YAAa,UAAU,EAAG,MAAM,6BAA6B,MAAM,KAAK,OAAO,KAAK,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,QAAQ,MAAM,+BAA8B,EAAC,UAAO,GAAG,KAAK,GAAG,KAAK,EAAE,KAAK,EAAS,EAAC,QAAK,GAAG,KAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,EAAO,EAAC,QAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,CAAO,EAC3X,EAAC,WAAI,WAAS,CAChB,EAEA,EAACO,GAAA,CAAO,UAAWP,EAAW,EAE9B,EAAC,OAAI,QAAUI,GAAMJ,EAAU,SAASI,CAAC,EAAG,YAAU,WAAW,aAAW,QAAQ,MAAO,CAAC,OAAQ,UAAW,WAAY,iBAAkB,YAAa,gBAAgB,GACxK,EAAC,OAAK,MAAM,6BAA6B,MAAM,KAAK,OAAO,KAAK,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,QAAQ,MAAM,wBAAuB,EAAC,QAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,EAAO,EAAC,QAAK,GAAG,IAAI,GAAG,IAAI,GAAG,KAAK,GAAG,IAAI,EAAO,EAAC,QAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,CAAO,CACvV,CACF,EACA,EAAC,OAAI,MAAM,uBAAuB,MAAO,CAAC,SAAU,WAAY,SAAU,QAAQ,GAC/EJ,EAAU,OAAO,IAAIQ,GAAQ,EAAC,OAAI,MAAO,CACtC,KAAM,WACN,UAAW,MACb,GAAG,EAACC,GAAA,CAAe,UAAWT,EAAW,KAAMQ,EAAM,CAAE,CAAM,CACjE,CACF,EAECR,EAAU,SACT,EAAC,OAAI,QAASA,EAAU,QAAQ,QAAS,MAAO,CAC9C,OAAQ,KACR,SAAU,WACV,WAAY,QACZ,QAAUA,EAAU,QAAQ,QAAS,MAAM,KAC3C,MAAO,OACP,OAAQ,MACV,EAAG,EACJA,EAAU,MAAQ,EAACU,GAAA,CAAK,UAAWV,EAAY,GAAGA,EAAU,KAAM,EAClEA,EAAU,SAAW,EAACW,GAAA,CAAe,UAAWX,EAAY,GAAGA,EAAU,QAAS,EAClFA,EAAU,UAAY,EAACY,GAAA,CAAS,UAAWZ,EAAW,EACtDA,EAAU,QAAU,EAACa,GAAA,CAAO,UAAWb,EAAY,GAAGA,EAAU,OAAQ,CAC3E,CAEJ,CACF,EAEMM,GAAuB,CAC3B,KAAM,CAAC,MAAO,CAAC,KAAAD,EAAM,UAAAL,EAAW,SAAAc,EAAU,MAAAC,CAAK,EAAG,MAAAd,CAAK,EAAG,CACxDA,EAAM,SAAYA,EAAM,WAAa,OAAaa,EAAWb,EAAM,SACnE,IAAMe,EAAcX,EAAK,WAAa,GAAKU,EAAQ,EAC7Cb,EAASC,EAACC,GAAM,CACfY,IACDf,EAAM,SACRA,EAAM,SAAW,GAEjBA,EAAM,SAAW,GAEnBG,EAAE,gBAAgB,EACpB,EARe,UASTa,EAAOd,EAACC,GAAM,CAClBJ,EAAU,KAAKK,CAAI,CACrB,EAFa,QAGb,OACE,EAAC,WACC,EAAC,OAAI,MAAO,CAAC,QAAS,OAAQ,cAAe,UAAW,GACtD,EAAC,OAAI,QAASH,EAAQ,MAAO,CAAC,OAAQ,UAAW,WAAY,IAAK,WAAY,MAAO,YAAa,UAAU,EAAG,MAAM,gCAAgC,MAAM,KAAK,OAAO,KAAK,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,MAAM,iBAAe,QAAQ,kBAAgB,QAAQ,MAAM,8BACtSc,EACIf,EAAM,SACJ,EAAC,YAAS,OAAO,iBAAiB,EAClC,EAAC,YAAS,OAAO,iBAAiB,EACvC,IACL,EAEA,EAAC,OAAI,QAASgB,EAAM,MAAO,CAAC,OAAQ,UAAW,WAAY,OAAQ,SAAU,WAAY,SAAU,IAAK,SAAU,OAAQ,SAAU,SAAU,aAAc,WAAY,WAAY,QAAQ,GACzLZ,EAAK,IACR,CACF,EACCJ,EAAM,UACL,EAAC,OAAI,MAAO,CAAC,WAAY,QAAQ,GAC9BI,EAAK,SAAS,OAAOa,GAAKA,EAAE,OAAS,EAAE,EAAE,IAAIA,GAAK,EAACZ,GAAA,CAAQ,UAAWN,EAAW,KAAMkB,EAAG,MAAOH,EAAM,EAAG,CAAE,CAC/G,CAEJ,CAEJ,CACF,EC/GA,SAASI,GAASC,EAAMC,EAAU,IAAK,CACrC,IAAIC,EACJ,MAAO,IAAIC,IAAS,CAClB,aAAaD,CAAK,EAClBA,EAAQ,WAAW,IAAM,CAAEF,EAAK,MAAM,KAAMG,CAAI,CAAG,EAAGF,CAAO,CAC/D,CACF,CANSG,EAAAL,GAAA,YASF,IAAMM,EAAN,KAAiB,CAStB,aAAc,CACZ,KAAK,MAAQ,OAAO,UAAU,QAAQ,MACtC,KAAK,eAAiBN,GAAS,KAAK,OAAO,KAAK,IAAI,CAAC,CACvD,CAEA,YAAkB,CAChB,OAAO,EAAC,OAAI,MAAM,6BAA6B,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,SAAQ,EAAC,UAAO,GAAG,KAAK,GAAG,KAAK,EAAE,IAAI,EAAS,EAAC,QAAK,GAAG,KAAK,GAAG,KAAK,GAAG,QAAQ,GAAG,QAAQ,CAAO,CACjQ,CAEA,YAAYO,EAAiB,CAC3B,MAAO,eAAeA,EAAK,OAC7B,CAEA,SAASA,EAAY,CACnB,KAAK,UAAYA,EACjB,KAAK,OAASA,EAAK,OACnBA,EAAK,IAAI,QAASC,GAAY,CACvBD,EAAK,aACR,KAAK,eAAe,CAExB,CAAC,CACH,CAEA,QAAS,CAEP,GADA,QAAQ,IAAI,UAAU,EAClB,CAAC,KAAK,OAAQ,OAElB,IAAIE,EAAQ,KAAK,OAAO,KACpBC,EAAaD,EAAM,MAAM,MAAM,EAC/BE,EAAYD,EAAW,OAAOE,GAAQ,CAACA,EAAK,SAAS,GAAG,CAAC,EAAE,KAAK,GAAG,EACnEC,EAAa,OAAO,YAAYH,EAAW,OAAOE,GAAQA,EAAK,SAAS,GAAG,CAAC,EAAE,IAAIA,GAAQA,EAAK,YAAY,EAAE,MAAM,GAAG,CAAC,CAAC,EACxH,CAACD,GAAa,OAAO,KAAKE,CAAU,EAAE,OAAS,IAGjDF,EAAY,OAAO,KAAKE,CAAU,EAAE,CAAC,GAEvC,IAAMC,EAAU,KAAK,MAAM,OAAOH,CAAS,EACxC,IAAII,GAAM,CACT,IAAIR,EAAO,OAAO,UAAU,UAAU,KAAKQ,CAAE,EAC7C,GAAKR,GAID,EAAAA,EAAK,QACPA,EAAOA,EAAK,OAER,CAACA,EAAK,MAGZ,IAAI,OAAO,KAAKM,CAAU,EAAE,OAAS,EAAG,CACtC,IAAMG,EAAS,CAAC,EAChB,QAAWC,KAAKV,EAAK,UAAU,QAAQ,EACrCS,EAAOC,EAAE,KAAK,YAAY,CAAC,EAAIA,EAAE,MAAM,YAAY,EAErD,QAAWA,KAAKJ,EACd,GAAI,CAACG,EAAOC,CAAC,GAAKD,EAAOC,CAAC,IAAMJ,EAAWI,CAAC,EAC1C,MAGN,CACA,OAAOV,EACT,CAAC,EACA,OAAOC,GAAKA,IAAM,MAAS,EAC3B,OAAOA,GAAKA,EAAE,KAAO,KAAK,OAAO,IAAMA,EAAE,KAAO,KAAK,UAAU,EAAE,GAChEM,EAAQ,SAAW,KAAK,iBAAmBL,IAAU,KAAK,aACxD,KAAK,SAEP,KAAK,QAAQ,QAASD,GAAMA,EAAE,QAAQ,CAAC,EAEzC,KAAK,QAAUM,EAAQ,IAAIN,GAAK,CAC9B,IAAMU,EAAM,KAAK,OAAO,IAAI,KAAK,EAAE,EACnC,OAAAA,EAAI,IAAI,OAAS,OACjBA,EAAI,MAAQV,EACLU,CACT,CAAC,EACD,KAAK,UAAYT,EACjB,KAAK,gBAAkBK,EAAQ,OAEnC,CAEA,eAAeP,EAAYY,EAA0B,CACnD,OAAK,KAAK,SAAS,KAAK,OAAO,EACxB,KAAK,OACd,CAEA,OAAOC,EAAkB,CACvB,MAAO,CAAC,CACV,CAEA,SAASC,EAAU,CAEnB,CACF,EArGahB,EAAAC,EAAA,cAAAA,EAANgB,EAAA,CADPC,GACajB,GCTN,IAAMkB,EAAN,KAAe,CAGpB,aAAc,CACZ,KAAK,QAAU,EACjB,CAEA,cAAe,CACb,OAAOC,EACT,CACF,EAVaC,EAAAF,EAAA,YAAAA,EAANG,EAAA,CADPC,GACaJ,GAYb,IAAMC,GAAiB,CACrB,KAAK,CAAC,MAAO,CAAC,KAAAI,CAAI,CAAC,EAAG,CAMpB,OAAO,EAAC,SAAM,KAAK,WAAW,MAAO,CAAC,UAAW,SAAU,YAAa,QAAQ,EAAG,QAL5DH,EAACI,GAAM,CAC5B,IAAMC,EAAWF,EAAK,aAAaL,CAAQ,EAC3CO,EAAS,QAAU,CAACA,EAAS,QAC7BF,EAAK,QAAQ,CACf,EAJuB,kBAKqF,QAASA,EAAK,aAAaL,CAAQ,EAAE,QAAS,CAC5J,CACF,ECrBO,IAAMQ,EAAN,KAAgB,CACrB,aAAc,CAEd,CAEA,YAAkB,CAChB,OAAO,EAAC,OAAI,MAAM,6BAA6B,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,SAAQ,EAAC,YAAS,OAAO,oBAAoB,EAAW,EAAC,QAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,EAAO,EAAC,QAAK,GAAG,KAAK,GAAG,IAAI,GAAG,KAAK,GAAG,KAAK,CAAO,CAC/S,CACF,EARaC,EAAAD,EAAA,aAAAA,EAANE,EAAA,CADPC,GACaH,GCCN,IAAMI,EAAN,KAAY,CAQjB,aAAc,CACZ,KAAK,IAAM,CAAC,EACZ,KAAK,QAAU,EACjB,CAEA,SAASC,EAAY,CACnB,KAAK,UAAYA,EACjB,KAAK,OAASA,EAAK,MACrB,CAGA,SAASC,EAAU,CACbA,EAAI,YACN,KAAK,UAAY,IAAI,KAAKA,EAAI,SAAS,GAEzC,KAAK,KAAOA,EAAI,KAAK,CAAC,GAAG,IAAIC,GAAS,CAAC,IAAI,KAAKA,EAAM,CAAC,CAAC,EAAG,IAAI,KAAKA,EAAM,CAAC,CAAC,CAAC,CAAC,EAC9E,KAAK,QAAUD,EAAI,OACrB,CAEA,OAAOE,EAAkB,CACvB,MAAO,CACL,UAAW,KAAK,UAChB,IAAK,KAAK,IACV,QAAS,KAAK,OAChB,CACF,CAEA,YAAqB,CACnB,OAAO,KAAK,IAAI,IAAI,KAAK,aAAa,EAAE,OAAO,CAACC,EAAKC,IAAQD,EAAIC,EAAK,CAAC,CACzE,CAEA,YAAqB,CACnB,IAAIC,EAAQ,KAAK,WAAW,EAC5B,OAAI,KAAK,QACP,KAAK,OAAO,SAAS,QAAQC,GAAS,CAChCA,EAAM,aAAaR,CAAK,IAC1BO,GAASC,EAAM,aAAaR,CAAK,EAAE,WAAW,EAElD,CAAC,EAEIO,CACT,CAEA,OAAQ,CACF,KAAK,YACT,KAAK,UAAY,IAAI,KACvB,CAEA,MAAO,CACL,GAAI,CAAC,KAAK,UAAW,OACrB,IAAIE,EAAM,IAAI,MACHA,EAAI,QAAQ,EAAI,KAAK,UAAU,QAAQ,GACzC,KAAQ,IAEf,KAAK,IAAI,KAAK,CAAC,KAAK,UAAWA,CAAG,CAAC,EAErC,KAAK,UAAY,MACnB,CAEA,YAAYN,EAAuB,CACjC,OAAIA,EAAM,SAAW,EAAU,GACxB,GAAG,KAAK,WAAWA,EAAM,CAAC,CAAC,OAAO,IAAI,KAAK,eAAe,KAAM,CACrE,UAAW,OACb,CAAC,EAAE,OAAOA,EAAM,CAAC,CAAC,GACpB,CAGA,cAAcA,EAAuB,CACnC,IAAMO,EAAIP,EAAM,CAAC,EAEjB,QADUA,EAAM,CAAC,GAAK,IAAI,MAChB,QAAQ,EAAIO,EAAE,QAAQ,GAAK,GACvC,CAEA,WAAWC,EAAkB,CAC3B,OAAKA,EAGE,IAAI,KAAK,eAAe,KAAM,CACnC,UAAW,QACX,UAAW,OACb,CAAC,EAAE,OAAOA,CAAC,EALF,EAMX,CAEA,eAAeC,EAAyB,CACtC,IAAIC,EAAMD,EAAU,GAChBE,EAAM,KAAK,MAAMD,EAAM,EAAE,EAC7B,OAAAA,EAAMA,EAAM,GAEL,GADG,KAAK,MAAMA,EAAM,EAAE,KACZC,EAAI,eAAe,QAAS,CAAC,qBAAsB,EAAG,YAAa,EAAK,CAAC,GAC5F,CAEA,aAAc,CACZ,OAAOC,EACT,CAEA,aAAc,CACZ,OAAOC,EACT,CAEA,OAAO,WAAWC,EAAsB,CAEtCA,EAAU,SAAS,gBAAgB,CACjC,GAAI,aACJ,MAAO,aACP,OAASC,GAAiB,CACxB,GAAKA,EAAI,KACT,IAAI,CAACA,EAAI,KAAK,aAAalB,CAAK,EAAG,CACjC,IAAMmB,EAAQ,IAAInB,EAClBkB,EAAI,KAAK,aAAaC,CAAK,CAC7B,CACAD,EAAI,KAAK,aAAalB,CAAK,EAAE,KAAK,EAClCkB,EAAI,KAAK,QAAQ,EACnB,CACF,CAAC,EACDD,EAAU,YAAY,gBAAgB,CAAC,QAAS,aAAc,IAAK,QAAS,CAAC,EAC7EA,EAAU,SAAS,gBAAgB,CACjC,GAAI,cACJ,MAAO,cACP,OAASC,GAAiB,CACxB,GAAKA,EAAI,KACT,IAAI,CAACA,EAAI,KAAK,aAAalB,CAAK,EAAG,CACjC,IAAMmB,EAAQ,IAAInB,EAClBkB,EAAI,KAAK,aAAaC,CAAK,CAC7B,CACAD,EAAI,KAAK,aAAalB,CAAK,EAAE,MAAM,EACnCkB,EAAI,KAAK,QAAQ,EACnB,CACF,CAAC,EACDD,EAAU,YAAY,gBAAgB,CAAC,QAAS,cAAe,IAAK,QAAS,CAAC,EAC9EA,EAAU,SAAS,gBAAgB,CACjC,GAAI,eACJ,MAAO,eACP,OAASC,GAAiB,CACnBA,EAAI,MACTA,EAAI,KAAK,gBAAgBlB,CAAK,CAChC,CACF,CAAC,CACH,CACF,EAlJaoB,EAAApB,EAAA,SAAAA,EAANqB,EAAA,CADPC,GACatB,GAoJb,IAAMe,GAAa,CACjB,KAAK,CAAC,MAAO,CAAC,KAAAd,CAAI,CAAC,EAAG,CACpB,IAAMkB,EAAQlB,EAAK,aAAaD,CAAK,EAC/BuB,EAAYH,EAAA,IAAM,CACtBD,EAAM,QAAU,CAACA,EAAM,QACvBlB,EAAK,QAAQ,CACf,EAHkB,aAIlB,MAAI,CAACkB,EAAM,SAAWA,EAAM,UAExB,EAAC,OAAI,QAASI,EAAW,MAAM,6BAA6B,MAAO,CAAC,WAAY,QAAS,WAAY,0BAA2B,YAAa,UAAW,aAAc,UAAW,aAAc,MAAO,MAAO,OAAO,GAClN,EAAC,OAAI,MAAM,QAAQ,MAAO,CAAC,MAAO,OAAQ,OAAQ,OAAQ,YAAa,SAAS,EAAG,MAAM,6BAA6B,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,SAAQ,EAAC,UAAO,GAAG,KAAK,GAAG,KAAK,EAAE,KAAK,EAAS,EAAC,YAAS,OAAO,mBAAmB,CAAW,EACnU,EAAC,WAAKJ,EAAM,eAAeA,EAAM,cAAc,CAACA,EAAM,SAAS,CAAC,CAAC,CAAE,CACrE,EAIF,EAAC,OAAI,QAASI,EAAW,MAAM,6BAA6B,MAAO,CAAC,WAAY,OAAQ,WAAY,0BAA2B,YAAa,UAAW,aAAc,UAAW,aAAc,MAAO,MAAO,OAAO,GACjN,EAAC,OAAI,MAAO,CAAC,MAAO,OAAQ,OAAQ,OAAQ,YAAa,SAAS,EAAG,MAAM,6BAA6B,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,SAAQ,EAAC,UAAO,GAAG,KAAK,GAAG,KAAK,EAAE,KAAK,EAAS,EAAC,YAAS,OAAO,mBAAmB,CAAW,EACrT,EAAC,WAAKJ,EAAM,eAAeA,EAAM,WAAW,CAAC,CAAE,CACjD,CAEJ,CACF,EAEMH,GAAW,CACf,KAAK,CAAC,MAAO,CAAC,KAAAf,CAAI,CAAC,EAAG,CACpB,IAAMkB,EAAQlB,EAAK,aAAaD,CAAK,EACrC,GAAKmB,EAAM,QACX,OACE,EAAC,OAAI,MAAM,+BACT,EAAC,OAAI,MAAM,cAAc,EACzB,EAAC,OAAI,MAAM,QACRA,EAAM,WACL,EAAC,OAAI,MAAM,gBAAgB,MAAO,CAAC,aAAc,KAAK,GACpD,EAAC,OAAI,MAAM,QAAQA,EAAM,WAAWA,EAAM,SAAS,EAAE,QAAM,EAC3D,EAAC,OAAI,MAAM,6BAA6B,MAAO,CAAC,WAAY,QAAS,WAAY,0BAA2B,YAAa,UAAW,aAAc,UAAW,aAAc,MAAO,MAAO,OAAO,GAC9L,EAAC,OAAI,MAAM,QAAQ,MAAO,CAAC,MAAO,OAAQ,OAAQ,OAAQ,YAAa,SAAS,EAAG,MAAM,6BAA6B,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,SAAQ,EAAC,UAAO,GAAG,KAAK,GAAG,KAAK,EAAE,KAAK,EAAS,EAAC,YAAS,OAAO,mBAAmB,CAAW,EACnU,EAAC,WAAKA,EAAM,eAAeA,EAAM,cAAc,CAACA,EAAM,SAAS,CAAC,CAAC,CAAE,CACrE,CACF,EAEDA,EAAM,IAAI,WAAW,EAAE,IAAIhB,GAC1B,EAAC,OAAI,MAAM,gBAAgB,MAAO,CAAC,aAAc,KAAK,GACpD,EAAC,OAAI,MAAM,QAAQgB,EAAM,YAAYhB,CAAK,CAAE,EAC5C,EAAC,OAAI,MAAM,6BAA6B,MAAO,CAAC,WAAY,OAAQ,WAAY,0BAA2B,YAAa,UAAW,aAAc,UAAW,aAAc,MAAO,MAAO,OAAO,GAC7L,EAAC,OAAI,MAAO,CAAC,MAAO,OAAQ,OAAQ,OAAQ,YAAa,SAAS,EAAG,MAAM,6BAA6B,QAAQ,YAAY,KAAK,OAAO,OAAO,eAAe,eAAa,IAAI,iBAAe,QAAQ,kBAAgB,SAAQ,EAAC,UAAO,GAAG,KAAK,GAAG,KAAK,EAAE,KAAK,EAAS,EAAC,YAAS,OAAO,mBAAmB,CAAW,EACrT,EAAC,WAAKgB,EAAM,eAAeA,EAAM,cAAchB,CAAK,CAAC,CAAE,CACzD,CACF,CACD,CACH,CACF,CAEJ,CACF,EC5MO,IAAMqB,EAAN,KAAqB,CAK1B,aAAc,CACZ,KAAK,KAAO,KACZ,KAAK,MAAQ,IAAIC,GACb,OAAO,WACT,KAAK,MAAQ,IAAIC,EAEjB,KAAK,MAAQ,IAAIC,CAErB,CACF,EAdaC,EAAAJ,EAAA,kBAgBN,IAAME,EAAN,KAA6B,CAGlC,aAAc,CACZ,KAAK,QAAU,IAAI,WAAW,CAC5B,QAAS,KACT,OAAQ,CAAC,KAAM,OAAQ,QAAS,gBAAgB,EAChD,YAAa,CAAC,IAAI,EAClB,aAAc,CAACG,EAAUC,IAChBA,EAAU,MAAM,GAAG,EAAE,OAAO,CAACC,EAAKC,IAAQD,GAAOA,EAAIC,CAAG,EAAGH,CAAQ,CAE9E,CAAC,CACH,CAEA,MAAMI,EAAe,CACf,KAAK,QAAQ,IAAIA,EAAK,EAAE,EAC1B,KAAK,QAAQ,QAAQA,CAAI,EAEzB,KAAK,QAAQ,IAAIA,CAAI,CAEzB,CAEA,OAAOC,EAAY,CACjB,GAAI,CACF,KAAK,QAAQ,QAAQA,CAAE,CACzB,MAAE,CAAO,CACX,CAEA,OAAOC,EAAyB,CAC9B,IAAMC,EAAY,KAAK,QAAQ,YAAYD,CAAK,EAChD,OAAIC,EAAU,SAAW,EAAU,CAAC,EAC7B,KAAK,QAAQ,OAAOA,EAAU,CAAC,EAAE,WAAY,CAAC,OAAQ,EAAI,CAAC,EAAE,IAAIL,GAAOA,EAAI,EAAE,CACvF,CACF,EAjCaH,EAAAF,EAAA,0BAoCN,IAAMC,EAAN,KAAuB,CAG5B,aAAc,CACZ,KAAK,MAAQ,CAAC,CAChB,CAEA,MAAMM,EAAe,CACnB,KAAK,MAAMA,EAAK,EAAE,EAAIA,EAAK,IAC7B,CAEA,OAAOC,EAAY,CACjB,OAAO,KAAK,MAAMA,CAAE,CACtB,CAEA,OAAOC,EAAyB,CAC9B,IAAME,EAAoB,CAAC,EAC3B,QAAWH,KAAM,KAAK,MAChB,KAAK,MAAMA,CAAE,EAAE,SAASC,CAAK,GAC/BE,EAAQ,KAAKH,CAAE,EAGnB,OAAOG,CACT,CACF,EAxBaT,EAAAD,EAAA,oBA4BN,IAAMF,GAAN,KAAgB,CACrB,MAAM,SAASa,EAA2B,CACxC,OAAO,aAAa,QAAQ,aAAaA,GAAM,CACjD,CAEA,MAAM,UAAUA,EAAcC,EAAkB,CAC9C,aAAa,QAAQ,aAAaD,IAAQC,CAAQ,CACpD,CACF,EARaX,EAAAH,GAAA,aChFb,OAAS,UAAAe,GAAQ,UAAAC,OAAc,0DAQxB,IAAMC,GAAN,KAAoB,CAczB,YAAYC,EAAkBC,EAAcC,EAAgB,CAC1D,KAAK,SAAWF,EAChB,KAAK,cAAgBC,EACrB,KAAK,KAAO,KACZ,KAAK,KAAO,CAAC,EAEb,KAAK,KAAO,OAAO,OAAO,CACxB,OAAQ,eACR,YAAa,EACf,EAAGC,GAAQ,CAAC,CAAC,EAEb,IAAMC,EAAe,IAAIC,EACzB,KAAK,MAAQD,EAAa,MAC1B,KAAK,MAAQA,EAAa,KAG5B,CAEA,IAAI,MAAe,CACjB,MAAO,GAAG,KAAK,MAAM,OAAO,KAAK,KAAK,KAAK,QAC7C,CAEA,MAAM,YAAa,CAEjB,IAAME,EAAO,IAAI,IAAI,SAAS,IAAI,EAAE,aAAa,IAAI,MAAM,EAC3D,GAAIA,EACF,GAAI,CAEF,IAAMC,EAAc,SAAS,OAAO,QAAQ,aAAc,EAAE,EAAE,QAAQ,MAAO,EAAE,EAC/E,QAAQ,UAAU,CAAC,EAAG,GAAI,GAAG,SAAS,WAAWA,GAAa,EAS9D,IAAMC,EAAS,MAPE,MAAM,MAAM,KAAK,SAAU,CAC1C,OAAQ,OACR,KAAM,OACN,QAAS,CAAC,eAAgB,kBAAkB,EAC5C,KAAM,KAAK,UAAU,CAAE,KAAAF,CAAK,CAAC,CAC/B,CAAC,GAE6B,KAAK,EACnC,GAAIE,EAAO,MACT,MAAMA,EAAO,MAGf,aAAa,QAAQ,qBAAsBA,EAAO,KAAK,CAEzD,OAASC,EAAP,CACA,KAAK,MAAM,EACX,QAAQ,MAAMA,CAAC,EACf,MACF,CAIF,IAAMC,EAAQ,IAAI,IAAI,SAAS,IAAI,EAAE,aAAa,IAAI,cAAc,EACpE,GAAIA,EACF,GAAI,CAEF,IAAMH,EAAc,SAAS,OAAO,QAAQ,qBAAsB,EAAE,EAAE,QAAQ,MAAO,EAAE,EACvF,QAAQ,UAAU,CAAC,EAAG,GAAI,GAAG,SAAS,WAAWA,GAAa,EAE9D,aAAa,QAAQ,qBAAsBG,CAAK,CAClD,OAASD,EAAP,CACA,KAAK,MAAM,EACX,QAAQ,MAAMA,CAAC,EACf,MACF,CAGF,GAAI,CAEF,GADA,MAAM,KAAK,aAAa,EACpB,CAAC,KAAK,KACR,KAAM,uBAEV,OAASA,EAAP,CACA,QAAQ,MAAMA,CAAC,EACX,KAAK,KAAK,kBACZ,SAAS,KAAO,KAAK,KAAK,iBAE5B,MACF,CAGA,GAAI,KAAK,KAAK,aAAe,KAAK,OAAS,SAAS,SAAU,CAC5D,SAAS,SAAW,KAAK,KACzB,MACF,CAGA,GAAI,CACF,MAAM,KAAK,OAAO,KAAK,MAAM,IAAI,CAC/B,MAAO,KAAK,KAAK,OAAO,EACxB,KAAM,KAAK,IACb,CAAC,CACH,OAASA,EAAP,CACA,GAAIA,EAAE,UAAY,YAChB,MAAMA,EAGR,QAAQ,IAAI,wBAAwB,EACpC,IAAME,EAAO,MAAM,KAAK,OAAO,KAAK,MAAM,2BAA2B,CAAC,KAAM,KAAK,IAAI,CAAC,EACtF,GAAIA,EAAK,SAAW,IAAK,CACvB,QAAQ,MAAMA,CAAI,EAClB,MACF,CACF,CAGA,GAAI,CACF,MAAM,KAAK,OAAO,KAAK,MAAM,WAAW,CACtC,MAAO,KAAK,KAAK,OAAO,EACxB,KAAM,KAAK,KACX,KAAM,gBACR,CAAC,CACH,OAASF,EAAP,CACA,GAAIA,EAAE,OAAS,YACb,MAAMA,EAGR,QAAQ,IAAI,4BAA4B,EACxC,IAAME,EAAO,MAAM,KAAK,OAAO,KAAK,MAAM,2BAA2B,CACnE,MAAO,KAAK,KAAK,OAAO,EACxB,KAAM,KAAK,KACX,KAAM,iBACN,QAAS,iBACT,QAAS,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC,CAClC,CAAC,EACD,GAAIA,EAAK,SAAW,IAAK,CACvB,QAAQ,MAAMA,CAAI,EAClB,MACF,CACF,CAEA,KAAK,MAAQ,KAIb,IAAMC,EAASC,GAAS,EACxB,MAAM,KAAK,SAAS,gBAAgB,EACpC,MAAM,KAAK,UAAU,iBAAkBD,CAAM,EAC7C,IAAME,EAAY,YAAY,SAAY,CACvB,MAAM,KAAK,SAAS,gBAAgB,IACpCF,IACf,cAAcE,CAAS,EACvB,SAAS,cAAc,IAAI,YAAY,cAAc,CAAC,EACtD,QAAQ,KAAK,cAAc,EAE/B,EAAG,GAAI,CACT,CAEA,MAAM,gBAAiB,CACrB,GAAI,CAOF,IANiB,MAAM,KAAK,OAAO,KAAK,MAAM,WAAW,CACvD,MAAO,KAAK,MAAM,OAAO,EACzB,KAAM,KAAK,KACX,KAAM,GACN,OAAQ,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,CAChD,CAAC,GACY,KAAK,KAAKC,GAAKA,EAAE,OAAS,OAASA,EAAE,OAAS,KAAK,EAAG,CACjE,IAAMC,EAAU,MAAM,KAAK,OAAO,KAAK,MAAM,WAAW,CACtD,MAAO,KAAK,MAAM,OAAO,EACzB,KAAM,KAAK,KACX,KAAM,MACN,OAAQ,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,CAChD,CAAC,EACD,QAAWC,KAAQD,EAAQ,KACzB,GAAIC,EAAK,KAAK,SAAS,MAAM,EAAG,CAE9B,IAAMN,EAAO,MAAM,KAAK,OAAO,KAAK,MAAM,WAAW,CACnD,MAAO,KAAK,MAAM,OAAO,EACzB,KAAM,KAAK,KACX,KAAMM,EAAK,KACX,OAAQ,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,CAChD,CAAC,EACKC,EAAM,SAAS,cAAc,MAAM,EACzCA,EAAI,aAAa,OAAQ,sCAAsCP,EAAK,KAAK,SAAS,EAClFO,EAAI,aAAa,MAAO,YAAY,EACpCA,EAAI,aAAa,OAAQ,UAAU,EACnC,SAAS,KAAK,YAAYA,CAAG,CAC/B,SAAWD,EAAK,KAAK,SAAS,KAAK,EAAG,CAEpC,IAAMN,EAAO,MAAM,KAAK,OAAO,KAAK,MAAM,WAAW,CACnD,MAAO,KAAK,MAAM,OAAO,EACzB,KAAM,KAAK,KACX,KAAMM,EAAK,KACX,OAAQ,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,CAChD,CAAC,EACKE,EAAK,SAAS,cAAc,QAAQ,EAC1CA,EAAG,aAAa,OAAQ,QAAQ,EAChCA,EAAG,aAAa,MAAO,6CAA6CR,EAAK,KAAK,SAAS,EACvF,SAAS,KAAK,YAAYQ,CAAE,CAC9B,CAEJ,CAEF,MAAE,CAAkB,CAEtB,CAEA,MAAM,cAAe,CACnB,IAAMT,EAAQ,aAAa,QAAQ,oBAAoB,EACvD,GAAI,CAACA,EACH,OAGF,KAAK,OAAS,IAAI,KAAK,cAAc,CAAC,KAAMA,CAAK,CAAC,EAClD,IAAMC,EAAO,MAAM,KAAK,OAAO,KAAK,MAAM,iBAAiB,EACvD,CAACA,GAAQA,EAAK,QAGlB,KAAK,KAAO,IAAIS,GAAKT,EAAK,IAAI,EAE3B,GAAE,EAAE,OAAO,EAChB,CAEA,aAAyB,CACvB,OAAO,KAAK,IACd,CAEA,OAAQ,CACN,SAAS,OAAO,KAAK,QAAQ,CAC/B,CAEA,OAAQ,CACN,aAAa,WAAW,oBAAoB,EAC5C,KAAK,KAAO,KAET,GAAE,EAAE,OAAO,CAChB,CAEA,QAAS,CACP,KAAK,MAAM,EACX,SAAS,OAAO,CAClB,CAGA,MAAM,SAASU,EAA2B,CACxC,GAAI,CACF,IAAMV,EAAO,MAAM,KAAK,OAAO,KAAK,MAAM,WAAW,CACnD,MAAO,KAAK,MAAM,OAAO,EACzB,KAAM,KAAK,KACX,KAAMU,EACN,OAAQ,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,CAChD,CAAC,EACD,YAAK,KAAKA,CAAI,EAAIV,EAAK,KAAK,IACrBW,GAAOX,EAAK,KAAK,OAAO,CACjC,OAASF,EAAP,CACA,OAAIA,EAAE,OAAS,aACb,QAAQ,MAAMA,CAAC,EAEV,IACT,CACF,CAEA,MAAM,UAAUY,EAAcE,EAAkB,CAC9C,IAAMZ,EAAO,MAAM,KAAK,OAAO,KAAK,MAAM,2BAA2B,CACnE,MAAO,KAAK,MAAM,OAAO,EACzB,KAAM,KAAK,KACX,KAAMU,EACN,QAAS,WACT,QAASG,GAAOD,CAAQ,EACxB,IAAK,KAAK,KAAKF,CAAI,CACrB,CAAC,EACD,KAAK,KAAKA,CAAI,EAAIV,EAAK,KAAK,QAAQ,GACtC,CACF,EAtRac,EAAAzB,GAAA,iBAwRN,IAAMoB,GAAN,KAAW,CAGhB,YAAYM,EAAW,CACrB,KAAK,KAAOA,CACd,CAEA,QAAiB,CACf,OAAO,KAAK,KAAK,KACnB,CAEA,aAAsB,CACpB,OAAO,KAAK,KAAK,IACnB,CAEA,WAAoB,CAClB,OAAO,KAAK,KAAK,UACnB,CACF,EAlBaD,EAAAL,GAAA,QAoBb,SAASP,IAAW,CAClB,IAAMc,EAAa,KAAK,IAAI,EAAE,SAAS,EAAE,EACnCC,EAAa,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,EACzD,OAAOD,EAAaC,CACtB,CAJSH,EAAAZ,GAAA,YChRT,eAAsBgB,GAAMC,EAAoBC,EAAqBC,EAAkB,CACjFA,EAAQ,YACV,MAAMA,EAAQ,WAAW,EAG3B,IAAMC,EAAY,IAAIC,EAAUF,CAAO,EACvC,OAAO,UAAYC,EAEnB,MAAMA,EAAU,WAAW,EAG3B,CACEE,EACAC,EACAC,EACAC,CACF,EAAE,QAAQC,GAAO,CACXA,EAAI,YACNA,EAAI,WAAWN,CAAS,CAE5B,CAAC,EAIDH,EAAS,iBAAiB,eAAgB,IAAM,CAC9CG,EAAU,WAAW,aAAc,IAAM,CACvC,SAAS,OAAO,CAClB,CAAC,CACH,CAAC,EAEDA,EAAU,SAAS,gBAAgB,CACjC,GAAI,gBACJ,MAAO,qBACP,OAASO,GAAiB,CACxB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMC,EAAS,IAAIC,EACnBF,EAAI,KAAK,aAAaC,CAAM,EAC5BR,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMA,EAAI,KAAM,EAAI,CAC/D,CACF,CAAC,EAGDP,EAAU,SAAS,gBAAgB,CACjC,GAAI,YACJ,MAAO,eACP,OAASO,GAAiB,CACnBA,EAAI,MACTA,EAAI,KAAK,QAAQ,OAAQ,MAAM,CACjC,CACF,CAAC,EAEDP,EAAU,SAAS,gBAAgB,CACjC,GAAI,aACJ,MAAO,gBACP,OAASO,GAAiB,CACnBA,EAAI,MACTA,EAAI,KAAK,QAAQ,OAAQ,OAAO,CAClC,CACF,CAAC,EAGDP,EAAU,SAAS,gBAAgB,CACjC,GAAI,WACJ,MAAO,WACP,OAASO,GAAiB,CACxB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMG,EAAO,IAAIN,EACjBG,EAAI,KAAK,aAAaG,CAAI,CAC5B,CACF,CAAC,EAEDV,EAAU,SAAS,gBAAgB,CACjC,GAAI,cACJ,MAAO,cACP,OAASO,GAAiB,CACnBA,EAAI,MACTA,EAAI,KAAK,gBAAgBH,CAAI,CAC/B,CACF,CAAC,EAEDJ,EAAU,SAAS,gBAAgB,CACjC,GAAI,eACJ,MAAO,eACP,OAASO,GAAiB,CACxB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMI,EAAW,IAAIN,EACrBE,EAAI,KAAK,aAAaI,CAAQ,CAChC,CACF,CAAC,EAEDX,EAAU,SAAS,gBAAgB,CACjC,GAAI,kBACJ,MAAO,kBACP,OAASO,GAAiB,CACnBA,EAAI,MACTA,EAAI,KAAK,gBAAgBF,CAAQ,CACnC,CACF,CAAC,EAEDL,EAAU,SAAS,gBAAgB,CACjC,GAAI,eACJ,MAAO,eACP,OAASO,GAAiB,CAGxB,GAFI,CAACA,EAAI,MACLA,EAAI,KAAK,WAAa,GACtBA,EAAI,KAAK,eAAiB,EAAG,OACjC,IAAMK,EAAOL,EAAI,KAAK,MAAM,EAC5BK,EAAK,IAAI,EACT,IAAMC,EAAQb,EAAU,UAAU,IAAIO,EAAI,KAAK,KAAM,EAAE,EACvDM,EAAM,IAAI,OAASN,EAAI,KAAK,OAAO,GACnC,IAAMO,EAAO,IAAIX,EACjBU,EAAM,aAAaC,CAAI,EACvBP,EAAI,KAAK,OAAO,UAAU,SAAUM,CAAK,EACzCD,EAAK,KAAKC,CAAK,EACfN,EAAI,KAAK,QAAQ,EACjB,EAAE,OAAO,KAAK,EACdP,EAAU,MAAMY,CAAI,CACtB,CACF,CAAC,EAEDZ,EAAU,SAAS,gBAAgB,CACjC,GAAI,YACJ,MAAO,YACP,OAASO,GAAiB,CACxB,GAAKA,EAAI,KACT,GAAIA,EAAI,KAAK,aAAaF,CAAQ,EAAG,CACnC,IAAMM,EAAWJ,EAAI,KAAK,aAAaF,CAAQ,EAC1CM,EAAS,QAIZJ,EAAI,KAAK,gBAAgBF,CAAQ,GAHjCM,EAAS,QAAU,GACnBJ,EAAI,KAAK,QAAQ,EAIrB,KAAO,CACL,IAAMI,EAAW,IAAIN,EACrBE,EAAI,KAAK,aAAaI,CAAQ,CAChC,CACF,CACF,CAAC,EACDX,EAAU,YAAY,gBAAgB,CAAE,QAAS,YAAa,IAAK,YAAa,CAAC,EAIjFA,EAAU,SAAS,gBAAgB,CACjC,GAAI,SACJ,MAAO,SACP,OAASO,GAAiB,CACnBA,EAAI,OACTP,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMA,EAAI,KAAM,EAAI,EAC7D,EAAE,OAAO,EACX,CACF,CAAC,EACDP,EAAU,YAAY,gBAAgB,CAAE,QAAS,SAAU,IAAK,gBAAiB,CAAC,EAClFA,EAAU,SAAS,gBAAgB,CACjC,GAAI,WACJ,MAAO,WACP,OAASO,GAAiB,CACnBA,EAAI,OACTP,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMA,EAAI,KAAM,EAAK,EAC9D,EAAE,OAAO,EACX,CACF,CAAC,EACDP,EAAU,YAAY,gBAAgB,CAAE,QAAS,WAAY,IAAK,cAAe,CAAC,EAClFA,EAAU,SAAS,gBAAgB,CACjC,GAAI,SACJ,MAAO,SACP,OAASO,GAAiB,CAExB,GADI,CAACA,EAAI,MACLA,EAAI,KAAK,IAAI,MAAQ,SAAU,OACnC,IAAMQ,EAAOR,EAAI,KACXK,EAAOL,EAAI,KAAK,MAAM,EACtBS,EAAOD,EAAK,YACdC,IAAS,OACXJ,EAAK,IAAI,EACTA,EAAK,KAAKI,CAAI,EACdD,EAAK,OAASC,EACdJ,EAAK,KAAKG,CAAI,EACdf,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMS,EAAM,EAAI,EACzD,EAAE,OAAO,KAAK,EACdhB,EAAU,MAAMY,CAAI,EAExB,CACF,CAAC,EACDZ,EAAU,YAAY,gBAAgB,CAAE,QAAS,SAAU,IAAK,KAAM,CAAC,EACvEA,EAAU,SAAS,gBAAgB,CACjC,GAAI,UACJ,MAAO,UACP,OAASO,GAAiB,CAExB,GADI,CAACA,EAAI,MACLA,EAAI,KAAK,IAAI,MAAQ,SAAU,OACnC,IAAMQ,EAAOR,EAAI,KACXU,EAASV,EAAI,KAAK,SAClBK,EAAOL,EAAI,KAAK,MAAM,EACxBU,IAAW,MAAQA,EAAO,KAAO,UACnCL,EAAK,IAAI,EACTA,EAAK,IAAI,EACTG,EAAK,OAASE,EAAO,OACrBL,EAAK,KAAKG,CAAI,EACdA,EAAK,aAAeE,EAAO,aAAe,EACtCA,EAAO,aAAe,GACxBjB,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMU,EAAQ,EAAK,EAE9D,EAAE,OAAO,KAAK,EACdjB,EAAU,MAAMY,CAAI,EAExB,CACF,CAAC,EACDZ,EAAU,YAAY,gBAAgB,CAAE,QAAS,UAAW,IAAK,WAAY,CAAC,EAC9EA,EAAU,SAAS,gBAAgB,CACjC,GAAI,UACJ,MAAO,UACP,OAASO,GAAiB,CACxB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMQ,EAAOR,EAAI,KACXU,EAASF,EAAK,OACpB,GAAIE,IAAW,MAAQA,EAAO,KAAO,QAAS,CAC5C,IAAMC,EAAWD,EAAO,WACxB,GAAIF,EAAK,eAAiB,EAAG,CAC3B,GAAI,CAACE,EAAO,YACV,OAEF,IAAME,EAAIZ,EAAI,KAAK,MAAM,EACzBY,EAAE,IAAI,EACNA,EAAE,IAAI,EACN,IAAMC,EAAYH,EAAO,YACzBE,EAAE,KAAKC,CAAS,EAChBD,EAAE,KAAKJ,CAAI,EACXA,EAAK,OAASK,EACdL,EAAK,aAAeK,EAAU,WAAa,EAC3CpB,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMa,EAAW,EAAI,EAC9D,EAAE,OAAO,KAAK,EACdpB,EAAU,MAAMmB,CAAC,CACnB,KAAO,CACL,GAAID,IAAa,EACf,OAEFH,EAAK,aAAeA,EAAK,aAAe,EACxC,EAAE,OAAO,KAAK,CAChB,CACF,CACF,CACF,CAAC,EACDf,EAAU,YAAY,gBAAgB,CAAE,QAAS,UAAW,IAAK,oBAAqB,CAAC,EACvFA,EAAU,SAAS,gBAAgB,CACjC,GAAI,YACJ,MAAO,YACP,OAASO,GAAiB,CACxB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMQ,EAAOR,EAAI,KACXU,EAASF,EAAK,OACpB,GAAIE,IAAW,MAAQA,EAAO,KAAO,QAAS,CAC5C,IAAMC,EAAWD,EAAO,WAExB,GAAIF,EAAK,eAAiBG,EAAW,EAAG,CACtC,GAAI,CAACD,EAAO,YACV,OAEF,IAAME,EAAIZ,EAAI,KAAK,MAAM,EACzBY,EAAE,IAAI,EACNA,EAAE,IAAI,EACN,IAAMC,EAAYH,EAAO,YACzBE,EAAE,KAAKC,CAAS,EAChBD,EAAE,KAAKJ,CAAI,EACXA,EAAK,OAASK,EACdL,EAAK,aAAe,EACpBf,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMa,EAAW,EAAI,EAC9D,EAAE,OAAO,KAAK,EACdpB,EAAU,MAAMmB,CAAC,CACnB,KAAO,CACL,GAAID,IAAa,EACf,OAEFH,EAAK,aAAeA,EAAK,aAAe,EACxC,EAAE,OAAO,KAAK,CAChB,CACF,CACF,CACF,CAAC,EACDf,EAAU,YAAY,gBAAgB,CAAE,QAAS,YAAa,IAAK,sBAAuB,CAAC,EAC3FA,EAAU,SAAS,gBAAgB,CACjC,GAAI,eACJ,MAAO,eACP,OAAQ,CAACO,EAAcc,EAAe,GAAIC,IAA0B,CAClE,GAAI,CAACf,EAAI,KAAM,OACf,IAAMQ,EAAOf,EAAU,UAAU,IAAIqB,CAAI,EACzCN,EAAK,OAASR,EAAI,KACde,IAAiB,SACnBP,EAAK,aAAeO,GAEtBtB,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMA,EAAI,KAAM,EAAI,EAC7D,EAAE,OAAO,KAAK,EACdP,EAAU,MAAMO,EAAI,KAAK,OAAOQ,CAAI,EAAGM,EAAK,MAAM,CACpD,CACF,CAAC,EACDrB,EAAU,SAAS,gBAAgB,CACjC,GAAI,gBACJ,MAAO,gBACP,OAASO,GAAiB,CACxB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMQ,EAAOf,EAAU,UAAU,IAAI,EAAE,EACvCe,EAAK,OAASR,EAAI,KAAK,OACvBQ,EAAK,aAAeR,EAAI,KAAK,aAC7B,EAAE,OAAO,KAAK,EACd,IAAMY,EAAIZ,EAAI,KAAK,MAAM,EACzBY,EAAE,IAAI,EACNnB,EAAU,MAAMmB,EAAE,OAAOJ,CAAI,CAAC,CAChC,CACF,CAAC,EACDf,EAAU,SAAS,gBAAgB,CACjC,GAAI,SACJ,MAAO,cACP,OAAQ,CAACO,EAAcc,EAAe,KAAO,CAC3C,GAAI,CAACd,EAAI,KAAM,OACf,IAAMQ,EAAOf,EAAU,UAAU,IAAIqB,CAAI,EACzCN,EAAK,OAASR,EAAI,KAAK,OACvBQ,EAAK,aAAeR,EAAI,KAAK,aAAe,EAC5C,EAAE,OAAO,KAAK,EACd,IAAMY,EAAIZ,EAAI,KAAK,MAAM,EACzBY,EAAE,IAAI,EACNnB,EAAU,MAAMmB,EAAE,OAAOJ,CAAI,CAAC,CAChC,CACF,CAAC,EACDf,EAAU,YAAY,gBAAgB,CAAE,QAAS,SAAU,IAAK,aAAc,CAAC,EAC/EA,EAAU,SAAS,gBAAgB,CACjC,GAAI,mBACJ,MAAO,mBACP,OAASO,GAAiB,CAExB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMQ,EAAOf,EAAU,UAAU,IAAI,EAAE,EACvCe,EAAK,OAASR,EAAI,KAAK,OACvBQ,EAAK,aAAeR,EAAI,KAAK,aAAe,EAC5CQ,EAAK,MAAQR,EAAI,KACjB,EAAE,OAAO,KAAK,EACd,IAAMY,EAAIZ,EAAI,KAAK,MAAM,EACzBY,EAAE,IAAI,EACNnB,EAAU,MAAMmB,EAAE,OAAOJ,CAAI,CAAC,CAChC,CACF,CAAC,EACDf,EAAU,SAAS,gBAAgB,CACjC,GAAI,SACJ,MAAO,cACP,OAASO,GAAiB,CAExB,GADI,CAACA,EAAI,MACLA,EAAI,KAAK,GAAG,WAAW,GAAG,EAAG,OACjC,IAAMgB,EAAQvB,EAAU,UAAU,UAAUO,EAAI,IAAI,EAGpD,GAFAA,EAAI,KAAK,QAAQ,EACjB,EAAE,OAAO,KAAK,EACVgB,EAAO,CACT,IAAIC,EAAM,EACNjB,EAAI,OAASA,EAAI,MAAM,MAAQ,cACjCiB,EAAMD,EAAM,KAAK,KAAK,QAEpBA,EAAM,KAAK,aAAe,GAE5BvB,EAAU,UAAU,YAAYO,EAAI,KAAK,KAAMgB,EAAM,KAAM,EAAK,EAElEvB,EAAU,MAAMuB,EAAOC,CAAG,CAC5B,CACF,CACF,CAAC,EACDxB,EAAU,YAAY,gBAAgB,CAAE,QAAS,SAAU,IAAK,sBAAuB,CAAC,EACxFA,EAAU,SAAS,gBAAgB,CACjC,GAAI,OACJ,OAASO,GAAiB,CACxB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMgB,EAAQvB,EAAU,UAAU,UAAUO,EAAI,IAAI,EAChDgB,GACFvB,EAAU,MAAMuB,CAAK,CAEzB,CACF,CAAC,EACDvB,EAAU,YAAY,gBAAgB,CAAE,QAAS,OAAQ,IAAK,SAAU,CAAC,EACzEA,EAAU,SAAS,gBAAgB,CACjC,GAAI,OACJ,OAASO,GAAiB,CACxB,GAAI,CAACA,EAAI,KAAM,OACf,IAAMkB,EAAQzB,EAAU,UAAU,UAAUO,EAAI,IAAI,EAChDkB,GACFzB,EAAU,MAAMyB,CAAK,CAEzB,CACF,CAAC,EACDzB,EAAU,YAAY,gBAAgB,CAAE,QAAS,OAAQ,IAAK,WAAY,CAAC,EAC3EA,EAAU,SAAS,gBAAgB,CACjC,GAAI,eACJ,OAASO,GAAiB,CACxB,IAAIQ,EAAOR,EAAI,KACXK,EAAOL,EAAI,KACXmB,EAAW,GACVX,IACHA,EAAOR,EAAI,KAAK,KAChBK,EAAO,IAAIe,EAAKpB,EAAI,KAAK,KAAMA,EAAI,KAAK,IAAI,EAC5CmB,EAAW,IAEb,IAAME,EAAU5B,EAAU,SAASY,CAAI,EACjCiB,EAAOD,EAAQ,sBAAsB,EACvCE,EAAIjC,EAAS,KAAK,WAAagC,EAAK,EAAKD,EAAQ,eAAiB,GAAM,GACxEG,EAAIlC,EAAS,KAAK,UAAYgC,EAAK,EAAI,EACvCH,IACFI,EAAIjC,EAAS,KAAK,WAAagC,EAAK,EACpCE,EAAIlC,EAAS,KAAK,UAAYgC,EAAK,EAAIA,EAAK,QAE9C7B,EAAU,YAAY8B,EAAGC,EAAG/B,EAAU,WAAW,CAAE,KAAAe,CAAK,CAAC,CAAC,CAC5D,CACF,CAAC,EACDf,EAAU,YAAY,gBAAgB,CAAE,QAAS,eAAgB,IAAK,QAAS,CAAC,EAChFA,EAAU,SAAS,gBAAgB,CACjC,GAAI,YACJ,MAAO,oBACP,OAASO,GAAiB,CACnBA,EAAI,OACTP,EAAU,aAAaO,EAAI,IAAI,EAC/B,EAAE,OAAO,EACX,CACF,CAAC,EACDP,EAAU,SAAS,gBAAgB,CACjC,GAAI,cACJ,MAAO,cACP,OAAQ,CAACO,EAAcyB,IAAiB,CACtChC,EAAU,WAAWgC,GAASzB,EAAI,IAAI,EACtCP,EAAU,QAAQ,KAAOA,EAAU,UACnC,EAAE,OAAO,CACX,CACF,CAAC,EACDA,EAAU,SAAS,gBAAgB,CACjC,GAAI,OACJ,MAAO,OACP,OAASO,GAAiB,CACxBP,EAAU,UAAU,aAAeO,EAAI,KAAK,GAC5CP,EAAU,UAAU,KAAK,EACzBA,EAAU,QAAQ,KAAOO,EAAI,KAAK,OAAOA,EAAI,IAAI,EACjDP,EAAU,OAAO,CAAC,EAAIA,EAAU,QAAQ,KACxC,EAAE,OAAO,CACX,CACF,CAAC,EACDA,EAAU,SAAS,gBAAgB,CACjC,GAAI,kBACJ,MAAO,2BACP,OAASO,GAAiB,CACnBA,EAAI,MACT,CAAC,GAAG,MAAM,GAAG,CAAC,EAAE,QAAQ,IAAM,CAC5B,IAAMQ,EAAOf,EAAU,UAAU,IAAIiC,GAAa,CAAC,CAAC,EACpDlB,EAAK,OAASR,EAAI,IACpB,CAAC,CACH,CACF,CAAC,EAGDP,EAAU,MAAM,aAAa,OAAQ,CACnC,CAAE,QAAS,MAAO,EAClB,CAAE,QAAS,WAAY,EACvB,CAAE,QAAS,QAAS,EACpB,CAAE,QAAS,SAAU,EACrB,CAAE,QAAS,SAAU,EACrB,CAAE,QAAS,WAAY,EACvB,CAAE,QAAS,QAAS,CAQtB,CAAC,EAEDA,EAAU,MAAM,aAAa,WAAY,CACvC,CAAE,MAAO,IAAM,GAAGA,EAAU,QAAQ,MAAM,YAAY,GAAG,OAAO,aAAc,SAAU,GAAM,KAAM,IAAMA,EAAU,cAAc,CAAE,EACpI,CACE,MAAO,IAAM,oBAAqB,KAAM,IAAM,CAACA,EAAU,cAAc,EAAG,QAAS,IAAM,CAClF,aAAa,QAAQ,QAAQ,EAKhCA,EAAU,QAAQ,KAAK,MAAM,EAJ7BA,EAAU,WAAW,SAAU,IAAM,CACnCA,EAAU,QAAQ,KAAK,MAAM,CAC/B,CAAC,CAIL,CACF,EACA,CACE,MAAO,IAAM,aAAc,KAAM,IAAM,CAACA,EAAU,cAAc,EAAG,QAAS,IAAM,CAChF,aAAa,MAAM,EACnB,SAAS,OAAO,CAClB,CACF,EACA,CAAE,MAAO,IAAM,eAAgB,QAAS,IAAM,OAAO,KAAK,mDAAoD,QAAQ,CAAE,EACxH,CAAE,MAAO,IAAM,SAAU,KAAM,IAAMA,EAAU,cAAc,EAAG,QAAS,IAAMA,EAAU,QAAQ,KAAK,OAAO,CAAE,CACjH,CAAC,EAEDH,EAAS,iBAAiB,UAAYqC,GAAM,CAC1C,IAAMC,EAAUnC,EAAU,YAAY,cAAckC,CAAC,EACrD,GAAIC,EAAS,CACXnC,EAAU,eAAemC,EAAQ,QAASnC,EAAU,OAAO,EAC3DkC,EAAE,gBAAgB,EAClBA,EAAE,eAAe,EACjB,MACF,CAGIA,EAAE,MAAQ,UACRlC,EAAU,SAAWA,EAAU,QAAQ,SACzCA,EAAU,QAAQ,QAAQkC,CAAC,CAGjC,CAAC,EAGD,EAAE,MAAMpC,EAAQ,CAAE,KAAM,IAAM,EAAEsC,GAAK,CAAE,UAAApC,CAAU,CAAC,CAAE,CAAC,CACvD,CA5fsBqC,EAAAzC,GAAA,SAggBtB,SAASqC,GAAaK,EAAS,GAAI,CACjC,IAAMC,EAASF,EAAA,CAACG,EAAUC,IACjB,KAAK,MAAM,KAAK,OAAO,GAAKA,EAAMD,GAAOA,CAAG,EADtC,UAGTE,EAAOL,EAAA,IAAM,CACjB,IAAMM,EAAQ,CACZ,MACA,UACA,OACA,SACA,QACA,OACA,QACA,QACA,UACA,SACA,UACA,SACA,SACA,SACA,UACA,OACA,OACA,SACA,UACA,WACF,EACA,OAAOA,EAAMJ,EAAO,EAAGI,EAAM,OAAS,CAAC,CAAC,CAC1C,EAxBa,QA+Bb,OANcN,EAACC,GACb,CAAC,GAAG,MAAMA,CAAM,CAAC,EACd,IAAI,CAACM,EAAGC,IAAMH,EAAK,CAAC,EACpB,KAAK,GAAG,EACR,KAAK,EAJI,SAMDH,EAAO,EAAGD,CAAM,CAAC,CAChC,CApCSD,EAAAJ,GAAA",
  "names": ["isMac", "bindingSymbols", "key", "symbols", "filterKeyForNonMacMeta", "k", "__name", "KeyBindings", "binding", "commandId", "b", "event", "bindings", "modifiers", "checkMod", "hasMod", "modState", "CommandRegistry", "cmd", "id", "rest", "resolve", "ret", "__name", "MenuRegistry", "id", "items", "__name", "Workbench", "backend", "CommandRegistry", "KeyBindings", "MenuRegistry", "Workspace", "n", "com", "node", "today", "dayNode", "weekNode", "getWeekOfYear", "todayPath", "todayNode", "p", "Path", "panel", "path", "pos", "input", "id", "ctx", "rest", "event", "trigger", "rect", "align", "x", "y", "items", "cmds", "i", "message", "finished", "__name", "date", "d", "dayNum", "yearStart", "SHA1", "msg", "rotate_left", "n", "s", "t4", "__name", "lsb_hex", "val", "str", "i", "vh", "vl", "cvt_hex", "v", "Utf8Encode", "string", "utftext", "c", "blockstart", "j", "W", "H0", "H1", "H2", "H3", "H4", "A", "B", "C", "D", "E", "temp", "msg_len", "word_array", "Path", "head", "name", "node", "p", "SHA1", "n", "__name", "registry", "component", "target", "componentName", "__name", "getComponent", "com", "inflateToComponent", "obj", "o", "hasHook", "node", "hook", "__name", "triggerHook", "args", "objectHas", "obj", "com", "objectCall", "Bus", "n", "cb", "nodes", "getComponent", "inflateToComponent", "node", "triggerHook", "name", "value", "parent", "parts", "i", "child", "id", "uniqueId", "Node", "p", "rel", "root", "path", "byId", "cur", "findChild", "__name", "fn", "opts", "dateString", "randomness", "Node", "bus", "id", "raw", "val", "n", "p", "triggerHook", "rel", "i", "anc", "cur", "path", "children", "com", "hasHook", "node", "obj", "componentName", "type", "coms", "linked", "idx", "oldIdx", "name", "value", "fn", "opts", "child", "nodes", "__name", "Workspace", "fs", "Bus", "debounce", "path", "contents", "e", "fn", "doc", "n", "i", "main", "root", "ws", "cal", "home", "name", "value", "head", "expanded", "b", "p", "prev", "fieldCount", "lastSubIfExpanded", "__name", "lastField", "lastChild", "nextSiblingOrParentNextSibling", "next", "parent", "func", "timeout", "timer", "args", "Menu", "workbench", "x", "y", "items", "align", "commands", "ctx", "onclick", "__name", "item", "cmd", "e", "posStyle", "i", "title", "binding", "c", "bindingSymbols", "CommandPalette", "state", "dom", "children", "attrs", "workbench", "filtered", "cmd", "onkeydown", "__name", "e", "mod", "a", "b", "onclick", "autocomplete", "idx", "NodeEditor", "workbench", "path", "onkeydown", "disallowEmpty", "editValue", "state", "node", "prop", "display", "__name", "objectHas", "objectCall", "onfocus", "getter", "setter", "v", "finished", "placeholder", "id", "TextEditor", "dom", "attrs", "textarea", "initialHeight", "span", "onblur", "value", "e", "empty_default", "node", "workbench", "panel", "NewNode", "workbench", "path", "__name", "e", "lastchild", "list_default", "workbench", "path", "node", "OutlineNode", "NewNode", "table_default", "workbench", "path", "state", "node", "n", "f", "getFieldEditor", "__name", "field", "fields", "NodeEditor", "OutlineNode", "views", "list_default", "table_default", "getView", "name", "empty_default", "__name", "view", "toTitleCase", "ctx", "str", "txt", "OutlineEditor", "workbench", "path", "getView", "OutlineNode", "attrs", "state", "children", "node", "isRef", "handleNode", "expanded", "hover", "__name", "e", "unhover", "toggle", "checkCommands", "anyModifiers", "above", "oldName", "open", "subCount", "n", "showHandle", "objectHas", "objectCall", "NodeEditor", "Page", "__name", "__decorateClass", "component", "Panel", "attrs", "path", "workbench", "node", "close", "__name", "e", "goBack", "maximize", "editMarkdown", "Page", "calcHeight", "value", "NodeEditor", "OutlineEditor", "QuickAdd", "workbench", "path", "Path", "OutlineEditor", "Search", "state", "dom", "results", "workbench", "clear", "__name", "open", "node", "onkeydown", "e", "mod", "a", "b", "autocomplete", "splitQuery", "textQuery", "term", "fieldQuery", "id", "fields", "f", "n", "result", "idx", "LockStolenMessage", "workbench", "finished", "FirstTimeMessage", "GitHubMessage", "Notice", "message", "App", "workbench", "state", "toggle", "__name", "e", "node", "NavNode", "Search", "path", "Panel", "Menu", "CommandPalette", "QuickAdd", "Notice", "expanded", "level", "expandable", "open", "n", "debounce", "func", "timeout", "timer", "args", "__name", "SearchNode", "node", "n", "query", "splitQuery", "textQuery", "term", "fieldQuery", "results", "id", "fields", "f", "ref", "children", "key", "obj", "__decorateClass", "component", "Checkbox", "CheckboxEditor", "__name", "__decorateClass", "component", "node", "e", "checkbox", "TextField", "__name", "__decorateClass", "component", "Clock", "node", "obj", "entry", "key", "acc", "val", "total", "child", "now", "a", "d", "seconds", "dur", "min", "ClockBadge", "ClockLog", "workbench", "ctx", "clock", "__name", "__decorateClass", "component", "toggleLog", "BrowserBackend", "FileStore", "SearchIndex_MiniSearch", "SearchIndex_Dumb", "__name", "document", "fieldName", "doc", "key", "node", "id", "query", "suggested", "results", "path", "contents", "encode", "decode", "GitHubBackend", "loginURL", "octokit", "opts", "localbackend", "BrowserBackend", "code", "querystring", "result", "e", "token", "resp", "sessID", "uniqueID", "lockCheck", "o", "dirList", "file", "css", "js", "User", "path", "decode", "contents", "encode", "__name", "user", "dateString", "randomness", "setup", "document", "target", "backend", "workbench", "Workbench", "Clock", "TextField", "Page", "Checkbox", "com", "ctx", "search", "SearchNode", "page", "checkbox", "path", "field", "text", "node", "prev", "parent", "children", "p", "parentSib", "name", "siblingIndex", "above", "pos", "below", "posBelow", "Path", "trigger", "rect", "x", "y", "panel", "generateName", "e", "binding", "App", "__name", "length", "random", "min", "max", "word", "words", "_", "i"]
}
